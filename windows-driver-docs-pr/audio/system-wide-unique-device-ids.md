---
title: システム全体にわたる一意のデバイス ID
description: システム全体にわたる一意のデバイス ID
ms.assetid: 628577b6-05fe-4b63-929f-6d63e93c9266
keywords:
- オーディオアダプター WDK、一意のデバイス Id
- アダプタードライバー WDK オーディオ、一意のデバイス Id
- ポートクラスオーディオアダプター WDK、一意のデバイス Id
- MF bus ドライバー WDK オーディオ
- システムで提供されている多機能デバイス WDK オーディオ
- 多機能オーディオデバイス WDK、オーディオアダプター
- 一意のデバイス Id WDK オーディオ
- デバイス Id WDK オーディオ
- デバイス Id の識別
- サブデバイス WDK オーディオ
- 専用バスドライバー WDK オーディオ
- デバイス ID 文字列 WDK オーディオ
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 41e0280dfb5cc3ec587081565820c08189875b61
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72832331"
---
# <a name="system-wide-unique-device-ids"></a>システム全体にわたる一意のデバイス ID


## <span id="system_wide_unique_device_ids"></span><span id="SYSTEM_WIDE_UNIQUE_DEVICE_IDS"></span>


一般的なオーディオアダプターのドライバーは、システム内の同じオーディオアダプターカードの複数のインスタンスを簡単にサポートできるようにする必要があります。 ドライバーが保持するほとんどすべてのデータ構造は、デバイス拡張バッファーに格納されます ([**デバイス\_オブジェクト**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_device_object)構造の**deviceextension**フィールドの説明を参照してください)。 ただし、ドライバーの複数のインスタンスがグローバルデータを共有している場合は、それらのインスタンスがこのデータへのアクセスを同期する必要があります。

追加の要件の1つとして、アダプターカードの特定のインスタンス上の各サブデバイスに、システム内の同じアダプターカードのすべてのインスタンスでサブデバイスを一意に識別する[デバイス ID 文字列](https://docs.microsoft.com/windows-hardware/drivers/install/device-identification-strings)を含める必要があります。

これを実現する最も簡単な方法は、アダプターカードの各サブデバイスを論理的に独立したデバイスとしてプラグアンドプレイマネージャーに公開することです。 これは、[多機能オーディオデバイス](multifunction-audio-devices.md)にオプション (1) として表示されます。

2つ目の方法は、システムによって提供される多機能バスドライバーを使用して、アダプターカード上のサブデバイスを管理する方法です。 メインフレームのバスドライバーは、システム全体で一意であることが保証されているデバイス ID を各サブデバイスに割り当てます。これは、システムに同じアダプターカードの複数のインスタンスが含まれている場合でも同様です。 MF bus ドライバーは、サブデバイスが構成レジスタの共通セットを共有する設計に対応していますが、各サブデバイスは独自の PCI ベースアドレスレジスタセットを持っています。 サブデバイスは相互に非表示の依存関係を持たず、相互に干渉することなく、またはシステム内の他のデバイスと同時に操作できる必要があります。 これは、[多機能オーディオデバイス](multifunction-audio-devices.md)でのオプション (2) です。

3番目の方法は、独自のバスドライバーを使用してアダプターカード上のサブデバイスを管理する方法です。 これは、サブデバイスの相互依存関係が集中管理されている必要がある場合に、頻繁に必要となります。 このような依存関係は、いくつかの方法で発生する可能性があります。

-   サブデバイスは、一部のカード内リソースを共有する場合があります。 たとえば、サブデバイスがデジタル信号プロセッサ (DSP) を共有している場合、バスドライバーは、最初のサブデバイスを起動する前に、DSP で実行されている独自のオペレーティングシステムをダウンロードする必要がある場合があります。

-   設計に欠陥があると、サブデバイス間で依存関係が発生する可能性があります。 たとえば、設計上の欠陥により、特定のシーケンスでサブデバイスの電源をオンまたはオフにすることが必要になる場合があります。

いずれかの種類の依存関係が存在する場合、独自のバスドライバーは、サブデバイスを直接プラグアンドプレイマネージャーに提示し、依存関係を非表示にするよりも、ほとんどの場合、より優れたソリューションです。

アダプターカードに独自のバスドライバーを指定する場合は、バスドライバーによって割り当てられるデバイス Id がシステム全体で一意であることを確認する必要があります。

バスドライバーは、プラグアンドプレイマネージャーからの[**IRP\_の\_クエリ\_ID**](https://docs.microsoft.com/windows-hardware/drivers/kernel/irp-mn-query-id)クエリに応答して、そのいずれかの子にデバイス ID を提供します。 この ID は、次の2つの方法のいずれかで指定できます。バスドライバーは、[**デバイス\_機能**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_device_capabilities)構造の**UniqueID**フィールドをに設定することによって、 [**IRP\_\_クエリ\_機能**](https://docs.microsoft.com/windows-hardware/drivers/kernel/irp-mn-query-capabilities)のクエリに応答していることを示します。**TRUE**または**FALSE**:

-   **UniqueID** = **TRUE**

    これは、子の名前がシステム全体で一意であることが保証されることを意味します。 デバイス id 文字列には、デバイス ID とインスタンス ID が含まれます。これは、ハードウェアインスタンスを一意に識別するシリアル番号です。

-   **UniqueID** = **FALSE**

    これは、子の名前が親に対してのみ一意であることを意味します。 ほとんどのデバイスでは、この識別方法を使用します。 この場合、プラグアンドプレイ manager は、受信するデバイス ID 文字列を拡張して、システムを通じて一意にすることができます。 拡張文字列は、親デバイスの一意の ID の関数です。

すべてのオーディオバスドライバーで、子の**UniqueID** = **FALSE**に設定する必要があります。 これにより、プラグアンドプレイ manager は、デバイスの親に関する情報を追加してコンピューター上で一意の ID を作成することによって、子のデバイス ID 文字列を拡張します。

 

 




