---
title: アーキテクチャの概要
description: このトピックでは、結合されたハードウェア/ソフトウェア オーディオ エンジンのサポートを提供する、Windows 8 で導入されたオーディオのアーキテクチャの概要を示します。
ms.assetid: B8D71C86-E2FF-48F1-8DC1-F232399F324D
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 37b455a1880e696212edbc50d8cf88eb2e3700ae
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63331595"
---
# <a name="architectural-overview"></a>アーキテクチャの概要


このトピックでは、結合されたハードウェア/ソフトウェア オーディオ エンジンのサポートを提供する、Windows 8 で導入されたオーディオのアーキテクチャの概要を示します。

## <a name="span-idthesoftwareaudioenginespanspan-idthesoftwareaudioenginespanspan-idthesoftwareaudioenginespanthe-software-audio-engine"></a><span id="The_software_audio_engine"></span><span id="the_software_audio_engine"></span><span id="THE_SOFTWARE_AUDIO_ENGINE"></span>ソフトウェアのオーディオ エンジン


Windows 7 と以前のバージョンの Windows では、オーディオ エンジンには、サード パーティの開発者ソフトウェア デコーダー、エンコーダー、およびその他のジェネリックのオーディオ効果の処理パイプラインで特定の時点で接続を許可されているソフトウェアのオーディオ エンジンがサポートされています。

次の図は、Windows 8 ソフトウェア オーディオ エンジンを示します。

![pcm またはその他のエンコードされたオーディオ データは、ストリームがスピーカーに送信される前に、ローカルとグローバルの処理の効果を適用するオーディオ エンジンに wasapi レイヤーを通じて、アプリケーション層を使用してストリームとしてフローします。](images/audio-engine1.png)

上の図に示すように、Windows 音声セッションの API (WASAPI) 層からおよび Media Foundation などのより高度な API を使用して、ソフトウェアのオーディオ エンジンでのオーディオ ストリームが到着します。 ソフトウェア オーディオ エンジン ローカル (LFX)、効果のボリュームと同様にコントロールとミュートに適用されます、ストリームごとに個別のストリームが、混在し、利用可能なグローバル効果 (GFX) を通じて渡され、スピーカーに送信される前に。

## <a name="span-idthehardwareaudioenginespanspan-idthehardwareaudioenginespanspan-idthehardwareaudioenginespanthe-hardware-audio-engine"></a><span id="The_hardware_audio_engine"></span><span id="the_hardware_audio_engine"></span><span id="THE_HARDWARE_AUDIO_ENGINE"></span>ハードウェアのオーディオ エンジン


ハードウェア オーディオ エンジンは、オーディオのアダプターに実装され、主ソフトウェア オーディオ エンジンの機能を反映します。 Windows 8 では、によるハードウェア オフロードされたオーディオ処理はサポートして、特定のオーディオ アダプターに対してオーディオ ドライバーも、次の図に示すトポロジを使用して、オーディオ ハードウェアの基になる機能を公開する責任を負います。

![ハードウェアの auido エンジンは、有限数のオフロードされたストリームとソフトウェアのオーディオ エンジンの出力であるホストのストリームを受け入れるように設計されています。 ハードウェアのオーディオ エンジンは、スピーカーに接続することも、最終処理ステージからのフィードバック (ループバック) ストリームを提供します。](images/audio-engine3.png)

図に示すように、ハードウェアのオーディオ エンジンは 1 つのホスト プロセスのストリームを受け入れる必要があり、n までストリームをオフロードします。 これらのオフロードされたストリームは、ハードウェアで処理するアプリケーション層から直接ルーティングされます。 つまり、オフロードされたストリームは、ソフトウェアのオーディオ エンジンを介しては渡されません。 図には、最大 3 つのオフロードされたストリームを処理するように設計された実装を示します。 ホスト プロセスのストリームでは、ソフトウェアのオーディオ エンジンで処理されたすべてのストリームのソフトウェア ミキサーの最終的な出力を示します。 各ハードウェア オーディオ エンジンは、ハードウェア ミキサーを含めることも必要があります。

ソフトウェアのオーディオ エンジンと WASAPI インターフェイスによるパリティを維持するためには、ハードウェアのオーディオ エンジン ループバック ストリームの形式で、オーディオ スタックに最後のオーディオ出力ストリームを提供するために必要なは。 これは、アプリケーションとアコースティック エコー キャンセルでは、エコーをキャンセルし、フィードバックを回避するには、最終的な出力ストリームの知識が必要に依存するシナリオで特に重要です。

ストリームのループバック パスを実装するために、オーディオ ドライバーはループバック暗証番号 (pin) を公開する責任を負います。 この pin が PCM 形式にデータがエンコードされている場合は、出力、最終的なオーディオ エンジンからオーディオ データを返します。 それ以外の場合、後 (場合によっては事前エンコードですが) 結果の混在が返されます。 これは、ハードウェア非 PCM 形式にエンコード GFX で処理されるオーディオのデータの場合は、ループバック ストリームは取得されるハードウェア ミキサーのすぐ後に、ハードウェアのオーディオ エンジンで GFX ステージの前にことを意味します。 ハードウェアのオーディオ エンジンを表す新しい KS フィルター トポロジについては、次を参照してください。[実装の概要](implementation-overview.md)します。

## <a name="span-idtheoverallarchitecturespanspan-idtheoverallarchitecturespanspan-idtheoverallarchitecturespanthe-overall-architecture"></a><span id="The_overall_architecture"></span><span id="the_overall_architecture"></span><span id="THE_OVERALL_ARCHITECTURE"></span>全体的なアーキテクチャ


次の図は、ハードウェア オーディオ エンジンが Windows 8 ソフトウェア オーディオ エンジンと連携して動作しているときに、最終的なアーキテクチャの概要を示します。

![ソフトウェアとハードウェア オーディオ エンジン、wasapi レイヤーに戻るまで、ハードウェアのエンジンからループバック ストリームを示す統合のアーキテクチャです。](images/audio-engine2.png)

つまり、最初の n、オーディオの処理をオフロード オーディオ ドライバーのサポートが示されているシナリオでは (この場合は、次の 3 つ)、ハードウェアのオーディオ エンジンに初期化されるストリーム WASAPI レイヤーから直接ルーティングされますをバイパスして、ソフトウェアのオーディオ エンジン。 ハードウェアのオーディオ エンジンでサポートされている n 後、新しいオーディオ ストリームは、処理のためのソフトウェアのオーディオ エンジンを介してルーティングされます。 ソフトウェアのオーディオ エンジンから生成されるストリームは、ホスト プロセスのストリームとして、ハードウェアのオーディオ エンジンに送信されます。 ホスト プロセスのストリームは、最初の n ストリームの混在、GFX 処理を適用すると、およびスピーカーに結果のストリームが送信されます。

**注**  ボリューム調整前に、GFX 処理を一般に、適用します。 GFX を PCM 以外の形式にエンコードされる場合、例外がありますが、ここで GFX 処理を行う前に、ボリューム コントロールが圧縮されていないデータに適用できるようには、GFX/ボリューム コントロールの順序が逆にします。 Windows 7 ソフトウェア オーディオ エンジンでは、同じモデルに従います。

 

 

 




