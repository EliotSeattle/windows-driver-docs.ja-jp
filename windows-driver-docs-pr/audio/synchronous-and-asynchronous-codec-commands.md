---
title: 同期および非同期のコーデック コマンド
description: 同期および非同期のコーデック コマンド
ms.assetid: c37cc94d-37eb-4a3e-b7ae-63fed8827d21
keywords:
- TransferCodecVerbs
- コーデックのコマンドの WDK オーディオ
- HD オーディオ コーデック コマンド
- Hd オーディオ (HD オーディオ)、コーデック コマンド
- コーデックの同期コマンドの WDK オーディオ
- コーデックの非同期コマンドの WDK オーディオ
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: f4ffc6bd8794693f6aced59ce86dbb3566ca56ad
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56535833"
---
# <a name="synchronous-and-asynchronous-codec-commands"></a>同期および非同期のコーデック コマンド


[ **TransferCodecVerbs** ](https://msdn.microsoft.com/library/windows/hardware/ff538596)ルーチンは、HD オーディオ コント ローラーに接続されているオーディオとモデムのコーデックにコマンドを送信する関数のドライバーを許可します。 コーデックのコマンドは、同期または非同期に実行できます。

-   呼び出し[ **TransferCodecVerbs** ](https://msdn.microsoft.com/library/windows/hardware/ff538596)コマンドの一覧は、コーデックの後にのみ、ルーチンを返します。 では同期的に、処理またはコーデックでは、すべてのコマンドが処理を送信します。

-   呼び出し[ **TransferCodecVerbs** ](https://msdn.microsoft.com/library/windows/hardware/ff538596)ルーチンを返します、HD オーディオ バス ドライバー コマンドを追加します、その内部コマンド キューにないとすぐに非同期で処理されるコマンドの一覧を送信します。コーデックまたはコーデックのコマンドを待機しています。 コマンドの処理が、コーデック、バス ドライバー コールバック ルーチンを呼び出すことによって機能ドライバーに通知します。

、送信するコーデック コマンドの性質によっては、関数のドライバーは、コーデックから応答を取得するのに、次の手法の 1 つ以上を使用します。

-   関数のドライバーに追加の処理を行う前に、コーデックからの応答にすることがあります、同期のモードを使用します。

-   コーデックの応答を参照してください、非同期モードを使用して、コマンドが完了するとを把握する (には、コーデック コマンドの記憶域を解放) を除く、コールバック ルーチンを無視関数ドライバーが、コーデックのコマンドを完了するまで待つ必要がない場合、および破棄またはコーデック コマンドへの応答を無視します。

-   関数ドライバー コーデックが完了すると、コマンドが、応答を確認する必要はありませんかを認識する必要がある場合に、非同期モードを使用および通知のコールバック ルーチンに依存しています。 ただし、破棄したり、コーデック コマンドへの応答を無視します。 コールバック ルーチンを使用して、[カーネル (KS) イベントをストリーミング](https://msdn.microsoft.com/library/windows/hardware/ff567643)ドライバーの主な部分に、通知を送信します。

-   コーデックのコマンドを完了し、どのような応答が、コマンドを完了するを待つのではなく、すぐに処理を再開する必要があるときに、関数のドライバーで両方を知る必要がある場合、非同期モードを使用し、まで、応答の読み取りを回避できます。コールバック ルーチンを受け取ります。 コールバック ルーチンまたはドライバーのメイン部分のいずれかが、応答を検査できます。

[*TransferCodecVerbs* ](https://msdn.microsoft.com/library/windows/hardware/ff538596)ステータスを返します\_バス ドライバーの内部コマンド キューへのコマンドの一覧の追加に成功すると、成功します。 呼び出しが成功した場合でも、応答できない可能性がありますが無効です。 関数のドライバーでは、それらが有効かどうかを判断するコーデック応答のステータス ビットを確認する必要があります。 このルールは、同期および非同期の両方のモードに適用されます。

無効な応答の原因は、次のいずれかをする可能性があります。

-   コマンドは、コーデックに届いていません。

-   コーデックが応答したが、応答が失われたとき、先入れ先出し (FIFO) オーバーランは、RIRB でが発生しました。 します。

後者の問題では、RIRB FIFO がサイズが不十分であることを示します。

各コーデック応答に含まれる、 **IsValid**をし、応答が有効かどうかを示すフラグを**HasFifoOverrun** RIRB FIFO オーバーランが発生したかどうかを示すフラグ。 場合**IsValid** = 0 の場合、応答が有効であることを示す、 **HasFifoOverrun**フラグは、エラーの原因を特定するのに役立ちます。

-   場合**HasFifoOverrun** = 0、コーデックが必要な時間間隔内に応答できませんでした。 考えられる原因は、コマンドにコーデックに到達しません。

-   場合**HasFifoOverrun** = 1 のコマンドでは、コーデック、おそらくに達するが、応答がオーバーラン FIFO により失われました。

呼び出し中に*TransferCodecCommands*、呼び出し元の配列へのポインターを提供する[ **HDAUDIO\_コーデック\_転送**](https://msdn.microsoft.com/library/windows/hardware/ff536424)構造体。 各構造体は、コマンドが含まれていて、応答の領域を提供します。 常に、バス ドライバーは、応答を起動したコマンドを含む構造体に各応答を書き込みます。

呼び出しごとに*TransferCodecCommands*コマンドが処理される順序は、配列内のコマンドの順序によって決まります。 処理が 2 番目のコマンドを開始する前に、配列の最初のコマンドを常に処理を完了します。

さらに、クライアントが非同期の呼び出しを行った場合*TransferCodecCommands*号餧ェヒェマル*TransferCodecCommands*を 2 回目の最初の呼び出しでは、コールバック ルーチンを待つことがなく、2 つの呼び出しからのコマンドは、2 つのグループが処理される相対順序は、コマンドの 2 つのグループに、クライアントが送信される順序によって定義されます。 したがって、バス ドライバーは処理 2 番目の呼び出しからのコマンドの処理を開始する前にすべてのコマンドの最初の呼び出しです。

ただし、2 つの異なる関数ドライバーのインスタンスから送信されたコマンドの相対順序は定義されません。 (各インスタンスは、独自の物理デバイス オブジェクトを持ちます)。たとえば、インスタンス 1 を呼び出す*TransferCodecCommands*順序 A、B、C で A、B、および C のコマンドを送信し、2 つの呼び出しをインスタンス化する*TransferCodecCommands* X、Y、Z の順序で X、Y、および Z のコマンドを送信する、バス ドライバーは、A-X-Y-B-Z-C の順序でコマンドを実行する可能性があります。

ときに別の関数ドライバー スレッドでは、ハードウェア リソースの同じセットへのアクセスが共有コマンドが別のドライバーのスレッドからの相対順序は重要になる可能性があります。 場合は、関数のドライバーは、スレッド間でリソースの共有の同期を担当します。

たとえば、一連のデータのインデックス レジスタのコーデックをバイトから構成され、8 ビットのデータを書き込むためのハードウェア インターフェイスを登録します。 最初に、関数ドライバーは、開始インデックスをインデックス レジスタに読み込むコーデック コマンドを送信します。 次に、ドライバーは、データ レジスタにデータの最初のバイトを書き込むコマンドを送信します。 次のデータに連続する各書き込みインデックス レジスタ インクリメントは、転送が完了するまでに登録します。 ただし、正しくインデックスとデータ レジスタのアクセスを同期する 2 つのドライバーのスレッドが失敗した場合、2 つのスレッドによる個々 の登録のアクセスの相対順序が定義されていないと、可能性の高い結果がデータの破損または、無効なハードウェア構成します。

[ *TransferCodecVerbs* ](https://msdn.microsoft.com/library/windows/hardware/ff538596)ルーチンは、HD オーディオ DDI の両方のバージョンで使用できます。

 

 




