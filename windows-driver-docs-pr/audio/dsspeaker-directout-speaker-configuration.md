---
title: DSSPEAKER_DIRECTOUT スピーカー構成
description: DSSPEAKER_DIRECTOUT スピーカー構成
ms.assetid: a4198fb7-157f-40e3-8cca-5a9e392087d2
keywords:
- DSSPEAKER_DIRECTOUT スピーカー構成 WDK オーディオ
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 096dfcfbd3f8f0bf9f525c688802381daaab09eb
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63333719"
---
# <a name="dsspeakerdirectout-speaker-configuration"></a>DSSPEAKER\_DIRECTOUT スピーカーの構成


## <span id="dsspeaker_directout_speaker_configuration"></span><span id="DSSPEAKER_DIRECTOUT_SPEAKER_CONFIGURATION"></span>


**注**  この情報は、Windows XP およびそれ以前のオペレーティング システムに適用されます。 以降、Windows Vista で**IDirectSound::GetSpeakerConfig**と**IDirectSound::SetSpeakerConfig**非推奨とされました。

 

アプリケーション プログラムは呼び出すことで直接アウト モードに、DirectSound のスピーカーの構成を変更することができます、 **IDirectSound::SetSpeakerConfig** DSSPEAKER にスピーカー構成パラメーターを持つメソッドが設定\_DIRECTOUT (Microsoft Windows SDK のドキュメントを参照してください)。 これをアプリケーションから再生ストリーム内のチャネルのスピーカー位置として解釈されることがなく出力オーディオのアダプターに直接は speakerless 構成を指定します。 ただし、入力ストリームはサンプル レートの変換、減衰、フィルター、およびその他の種類の処理をチャネルにスピーカーの割り当てに関する前提条件が必要としないによって変更できます。

有効、DSSPEAKER 後\_DIRECTOUT スピーカー構成設定はグローバルであり、オーディオ デバイス全体に影響を与えます。 以降を実行しているすべてのオーディオ アプリケーションは、DirectSound の設定が変更されるまで、新しい設定の対象がもう一度です。

直接アウト モードでは、オーディオ デバイスは、デバイス上の最初の出力コネクタには、最初のチャネル、デバイス上の 2 番目の出力には、2 番目のチャネルをレンダリングします。 これにより、オーディオの外部のミキサーなどのデバイスまたはオーディオの記憶域デバイス (ハード_ディスクや ADAT、) に直接マルチ チャネル データを出力するアプリケーションを作成できます。 たとえば、次の表に示すように、48 チャネル ストリーム内のチャネルが割り当てられます。

チャネル番号のコンテンツを 0

ボーカル

1

ドラム

2

ギター

3

低音

...

47

ピアノ

 

この種類の生のオーディオ データでは、スピーカー位置が、入力に意味のないや割り当てのスピーカー位置または出力ストリーム望ましくない副作用が発生する可能性があります。 たとえば、KMixer などのコンポーネントは、3D 仮想化またはドルビー サラウンド Pro ロジックはストリームにエンコードなどのスピーカーに固有の効果を適用することで不適切な介入可能性があります。 生データ チャネルの数がチャネル マスクのビットの数によって制限しないことに注意してください。

でも、デバイスに設計されていないオーディオ編集専用が通常受け入れる必要があります、 [ **KSPROPERTY\_オーディオ\_チャネル\_CONFIG** ](https://msdn.microsoft.com/library/windows/hardware/ff537250)プロパティの設定KSAUDIO にスピーカー構成の変更要求\_スピーカー\_DIRECTOUT します。 一般に、デバイスでは、その出力がスピーカーに接続しているし、(たとえば、外部のミキサーへの入力) として、他の目的の外部で使用できません、何らかの方法で検証できる場合を除き、要求の失敗を避ける必要があります。

直接アウト モードを使用するアプリケーションは特定のハードウェア デバイスに通常書き込まれます。 これにより、データを直接出力チャネルとこれらのチャネル内のデータの解釈方法の数など、デバイスがサポートを書式設定、アプリケーションをあらかじめ知っておくできます。 アプリケーションを呼び出すために、この知識は必要な**IDirectSound::GetSpeakerConfig**ダイレクト アウト モードで構成されているデバイスでデバイスだけを確認しますこのモードであるは、提供する追加はありません直接アウト モードでサポートされている stream の形式でのチャネルの数に関する情報です。 (この情報がありますを取得、ただし、送信することによって、 [ **KSPROPERTY\_オーディオ\_混在\_レベル\_CAP** ](https://msdn.microsoft.com/library/windows/hardware/ff537291)プロパティの get 要求をデバイスのミキサー ピン; supermixer ノード参照してください[DirectSound ノード順序要件](directsound-node-ordering-requirements.md))。

ストリームのダイレクト アウト wave 形式を指定するときにアプリケーションを設定する必要があります、 **dwChannelMask**のメンバー、 [ **WAVEFORMATEXTENSIBLE** ](https://msdn.microsoft.com/library/windows/hardware/ff538802)値構造体KSAUDIO\_スピーカー\_DIRECTOUT は 0 です。 0 のチャネル マスクは、スピーカー位置が定義されていないことを示します。 ストリーム内のチャネルの数が指定されている、常に、 **Format.nChannels**メンバー。

ハードウェア ベンダーでは、自分のデバイスがダイレクト アウト モードで構成されている場合は、DirectSound ハードウェア アクセラレーションをサポートのオプションがあります。 DirectSound アプリケーションを再生できます、デバイスのミキシングの pin のいずれかで直接出力ストリームがある場合。 使用可能なハードウェア暗証番号 (pin) のすべてのインスタンスが終了している後の新しいストリームは代わりに KMixer を通過します。

デバイスのストリームを混在させると、ダイレクト アウト モードで構成された、KMixer に、アプリケーションからの入力ストリームのチャネルとチャネルの出力をミックス ストリーム間の一対一のマッピングがデバイスに適用されます。 つまり、アプリケーションでは、同じチャネルの数を持つ複数の直接アウト ストリームを生成する場合など、出力のミックスの各チャネル N は KMixer を入力します。 すべてのストリームのチャネル N の sum だけです。

含まれているチャネルの数が異なる複数の直接出力ストリームを混在させるとき、KMixer の混合アルゴリズムは少し複雑です。 ミックスの各チャネル N N のチャネルをチャネル N. を持つすべての入力ストリームの合計は、この場合、します。たとえば、クアッドとクアッド出力ミックスを形成する入力ストリームのステレオ KMixer をどのように、出力の組み合わせの 0 と 1 つのチャネルは 0 と 1 つのチャネルのそれぞれ、ステレオ入力とクアッド ストリームの合計は。 ステレオ入力ストリーム、ただしに貢献チャネル 2 および 3 のミックスのクアッド入力ストリームの最後の 2 つのチャネルからのみ取得されます。

次のいずれかを実行しようとするアプリケーションへの悪影響が予期しない動作。

-   直接アウト モードで構成されているデバイスを介して直接アウト形式でないストリームを再生します。

-   直接アウト モードで構成されていないデバイスを介して直接出力ストリームを再生します。

このような場合のいずれかの場合、単にストリームを開こうとして失敗した KMixer を回避できます。 代わりに、上記の「一対一マッピング アルゴリズムを使用して、見かけ上の非互換性を処理しようとします。 ユーザーにも、結果に満足できない場合があります。 その他のオーディオ コンポーネント KMixer と同じ方法でこのような場合を処理するためにすることはできません。 たとえば、直接アウト モードで構成されているデバイスのドライバーでは、ハードウェアのバッファーを直接アウト形式では、その逆ではない出力ストリームを開こうとするとは失敗します。

オーディオのアプリケーションを作成可能性があります必要、ユーザーが最初に混在するデータをリッスンできるようにするいくつかのチャネルの出力のストリームしますが、ストリームの残りのチャネルにまだ含まれている、生データを無視します。 KMixer の動作は、この簡単です。 たとえば、24 チャネルの再生ストリームに 2 ~ 23 のチャネルのチャネル 0 と 1 および生データでステレオ ミックスが含まれている場合、アプリケーションは、次の。

-   ターゲットのオーディオ デバイスを構成します (これは必ずしもアプリケーションがストリームの編集に使用するデバイス) を呼び出してステレオ モードで**SetSpeakerConfig** DSSPEAKER で\_ステレオします。

-   変更**dwChannelMask**で再生ストリームの[ **WAVEFORMATEXTENSIBLE** ](https://msdn.microsoft.com/library/windows/hardware/ff538802) KSAUDIO 構造\_スピーカー\_ステレオですが離れる**Format.nChannels**ストリーム内のチャネルの合計数は 24 に設定します。

KMixer は、ステレオのチャンネルだけ再生ストリーム チャネル マスクで説明するが混在し、生データを含めることが残りの 22 チャネルを破棄します。 DirectSound スピーカー構成設定に加えられた変更が DirectSound の現在のオブジェクトが破棄され、別が作成されるまで有効にする可能性が低いことに注意してください (を参照してください[スピーカー構成設定の適用](applying-speaker-configuration-settings.md))。

 

 




