---
title: スピーカー構成にストリーム形式をマップする
description: スピーカー構成にストリーム形式をマップする
ms.assetid: 6af4a3e3-e24b-449f-84ad-9e8bbc22fdde
keywords:
- データ形式の WDK オーディオ
- WDK のオーディオ、データを書式設定します。
- オーディオ データ形式 WDK
- WDK のオーディオ、マルチ チャネルを書式設定します。
- マルチ チャネルの形式の WDK オーディオ
- ホーム シアター システム WDK オーディオ
- スピーカーの WDK オーディオ、ホーム threater システム
- オーディオ ドライバー WDK、ホーム シアター システム
- WDM オーディオ ドライバー WDK、ホーム シアター システム
- ホーム シアターを 7.1 スピーカー WDK オーディオ
- 全体の構成を 7.1 スピーカー WDK オーディオ
- スピーカー WDK オーディオの全体の構成
- WAVEFORMATEXTENSIBLE
- 形式の WDK オーディオの録音
- 形式のマッピング
- システム ミキサー WDK オーディオ
- 5.1 サラウンド サウンド スピーカー WDK オーディオ
- WDK オーディオの位置
- オーディオ データ形式の WDM WDK
- データ形式の WDK オーディオ形式のマッピング
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 7a751f9c44cc38873bf48deac054e6f1bed30824
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63332378"
---
# <a name="mapping-stream-formats-to-speaker-configurations"></a>スピーカー構成にストリーム形式をマップする


スピーカーのオーディオ デバイスの構成に一致しないストリーム形式の再生を求められたら、オーディオ ドライバーはいくつかのオプションがあります。

-   ストリームの再生を拒否します。

-   スピーカーに個々 のチャネルの一対一のマッピングを実行することによって、ストリームを再生します。 チャネルが各スピーカーにマップされた後、そのチャネルが残さ、残っているチャネルを破棄します。 逆に、経由で任意のスピーカーに残っている場合すべてのチャネルのスピーカーに割り当てられている、残っているスピーカーからのサイレント状態の再生します。

-   正確にスピーカー構成に必要なチャネルの数を生成する元のストリーム内のチャネルを組み合わせることで、ストリームを再生します。 元のストリームでのスピーカーがより多くのチャネルがある場合は、このアプローチは単純に余分なチャネルを破棄することによって得られるコンテンツの損失を回避します。 混在と形式の変換は、ソフトウェアまたはハードウェアで実行できます。

3 番目のオプションに関する、ドライバーはソフトウェアの混在を直接実行を避ける必要があります。 代わりに、ハードウェア ベンダーは、オーディオ デバイスに到達する前に、ストリームを処理するグローバル効果 (GFX) ソフトウェア モジュールをインストールする必要があります。 Windows Vista では、グローバルの効果は GFX オーディオ処理オブジェクト (APOs) として実装されます。 Windows Server 2003 および Windows XP では、グローバル効果は GFX フィルターとして実装されました。 

### <a name="span-idplayinga51channelstreamona71speakerconfigurationspanspan-idplayinga51channelstreamona71speakerconfigurationspanplaying-a-51-channel-stream-on-a-71-speaker-configuration"></a><span id="playing_a_5_1_channel_stream_on_a_7_1_speaker_configuration"></span><span id="PLAYING_A_5_1_CHANNEL_STREAM_ON_A_7_1_SPEAKER_CONFIGURATION"></span>7.1 スピーカーの構成で 5.1 チャネル Stream の再生

次の図は、(左)、5.1 サラウンド サウンド スピーカー構成に記録されますが、(右) のホーム シアターを 7.1 スピーカーの構成を使用して再生がストリームを示します。

![7.1 スピーカーの構成で 5.1 のストリームを再生するかを示す図](images/spkrcfg5.png)

上記の図では、記録された 5.1 形式に 7.1 スピーカーの構成で BL および BR のスピーカー位置のチャネル情報は含まれません。 したがって、これら 2 つのスピーカーはサイレントです。 (代わりに、別が難しくなります BL と BR スピーカーの記録の元の 6 つのチャネルからコンテンツを組み合わせることで追加の 2 つのチャネルを合成するオーディオ デバイス。)

チャネル マスク ビットの定義に従って、前の図の左側に表示される 5.1 のストリームを記録するためのチャネル マスクに 0x60F、スピーカー位置を次に、6 つのチャネルに割り当てる必要があります。FL、FR、FC、LFE、SL、および SR. 氏 (これは、前に説明した側スピーカー、5.1 構成です)。実際に、5.1 のストリームのチャネル マスクは、上の理由から、前に説明したようになりましたが 0x60F 詳しく説明するのではなく、0x3F です。

以前のバージョンの Windows (Windows Server 2003、Windows XP SP1、Windows 2000、および Windows Me/98)、チャネル マスク 0x3F の解釈は次のスピーカー位置に 5.1 の形式で 6 つのチャネルが割り当てられますこと。FL、FR、FC、LFE、BL、および BR. (これは、戻るスピーカー 5.1 の構成です)。ただし、Windows Vista、Windows Server 2003 SP1、および Windows XP SP2 の解釈が異なります: を意味する規則により、チャネル マスク 0x3F 5.1 の形式が解釈されます、*側スピーカー* 5.1 の構成代わりに、*バック スピーカー* 5.1 構成します。

この方法でチャネル マスクを解釈する、5.1 の背面のスピーカー構成から側スピーカー 5.1 構成を区別するために 2 つ目の 5.1 チャネル フォーマット記述子を導入する必要があります。 これら 2 つの構成は、一般的なユーザーにそれらの間の識別が困難な可能性があることがこれに似ています。 ハードウェア ベンダー、BL と BR ではなく SL と SR スピーカー位置を 5 および 6 のチャネルが割り当てられていることを意味する 0x3F チャネル マスクを解釈する必要が 5.1 チャネルの単一の書式記述子だけを持つユーザーが混乱を回避、位置。 5.1 のストリームをチャネル マスクのこの特殊なケースの解釈を覚えなくても、ある代わりにベンダーれているユーザーとよく似ていますの 2 つの区別の難易度 5.1 チャネルの書式記述子。

ベンダーと信じている人を少なくともいくつか、ユーザーの側スピーカー 5.1 の構成を区別し、するバック スピーカー 5.1 の構成には、この目的のユーザー インターフェイス (UI) プログラムを提供することです。 Ui は、ユーザーは 4 と 5、5.1 チャネル ストリーム内のチャネルはホーム シアターを 7.1 スピーカー構成で側スピーカーではなく、バック スピーカーをとる必要があるかどうかを選択できます。

### <a name="span-idplayinga71channelstreamona51speakerconfigurationspanspan-idplayinga71channelstreamona51speakerconfigurationspanplaying-a-71-channel-stream-on-a-51-speaker-configuration"></a><span id="playing_a_7_1_channel_stream_on_a_5_1_speaker_configuration"></span><span id="PLAYING_A_7_1_CHANNEL_STREAM_ON_A_5_1_SPEAKER_CONFIGURATION"></span>5.1 スピーカーの構成で 7.1 チャネル Stream の再生

次の図 (右) の 5.1 サラウンド サウンドのスピーカーの構成を使用して再生の構成 (左側) されている 7.1 ホーム シアターのスピーカーにストリームが記録されます。 7.1 チャネル ストリームのチャネル マスクは、0x63F です。

![5.1 スピーカーの構成で 7.1 ストリームを再生するかを示す図](images/spkrcfg6.png)

この例では、6 および 7、7.1 の構成で側のスピーカー位置のデータが含まれているチャネルは、5.1 の構成で側のスピーカー位置を再生します。 オーディオ デバイスは、単に 4 と 5、5.1 の構成でストリームを再生したときのバックのスピーカー位置を 7.1 の構成でのデータを含むチャネルを破棄します。 前述のように、(前の図に示されていません) 別の方法としては 5.1 の構成で側スピーカーで再生する前にチャネル 6 および 7 を組み合わせることで 4 と 5 のチャネルでコンテンツを保持しようとするデバイス。

### <a name="span-idsystemmixerbehaviorspanspan-idsystemmixerbehaviorspansystem-mixer-behavior"></a><span id="system_mixer_behavior"></span><span id="SYSTEM_MIXER_BEHAVIOR"></span>システム Mixer 動作

Windows Server 2003、Windows XP、Windows 2000、および Windows Me 98、ソフトウェア システム ミキサー Kmixer.sys によって、オーディオ デバイスを再生するオーディオ ストリームをマルチ チャネルは生成される通常/。 ストリームの開始前に再生、ミキサーのシステムとオーディオ ドライバーはミキサーとドライバーの両方を処理できるストリーム形式をネゴシエートする必要があります。

スピーカーのオーディオ デバイスの構成に一致しない形式でマルチ チャネル ストリームの再生を求められたら、オーディオ ドライバーは、ケースのネゴシエーションが続行されます、要求を拒否できます。

システム ミキサー 5.1 チャネル入力からコンテンツを変換できますが、入力ストリームの品質を維持するには、このような変換を回避するためが優先されます (するオーディオ デバイス) 7.1 チャネルの出力ストリームに、その逆をストリーミングします。 したがって、システム ミキサーでは、システム ミキサーに最高品質の入力ストリームと同じ形式のストリームを受け入れるようにドライバーを要求することによって、ネゴシエーションが開始されます。 通常、つまり、システム ミキサーに 5.1 または 7.1 チャネル形式で入力ストリームがある場合、問われます、ドライバーを同じ形式でストリームを受け入れるようにします。 ドライバーは、この形式を拒否する場合は、その他のストリームの形式を処理できるかどうか、ドライバーを要求することによってネゴシエート システム ミキサーが続行されます。

たとえば、5.1 スピーカーの構成では、オーディオ デバイスのドライバーが 7.1 チャネル ストリームを再生するには、システム ミキサーから要求を拒否する場合システム ミキサーによって 5.1 チャネル ストリームに 7.1 チャネル ストリームを変換することにより、ネゴシエーションが続行されます。 このドライバーは、この形式は、システム ミキサーはドライバーのストリーム変換を実行します。

オーディオ ドライバーを設計するときに、ドライバー開発者は独自形式の変換を処理または変換を行うシステム ミキサーに依存するかどうかを決める必要があります。 ドライバーは、次の状況のいずれかで変換を処理する必要があります。

-   場合は、ドライバーでは、システム ミキサーで実行される変換とは異なる方法で実行する変換が必要です。

-   場合は、ドライバーは、システム ミキサーをバイパスするストリームを再生する必要があります。

2 番目の状況では、ストリームはオーディオ デバイスのハードウェアの混在の pin に直接 Microsoft DirectSound ハードウェア アクセラレータを使用したバッファーから再生されている場合にシステム ミキサーをバイパスできます。 また、"pro audio"の一部のアプリケーション ストリームに送信、オーディオ デバイスへの直接システム ミキサーの待機時間を回避するために、または混合のプロセスが元のオーディオ ストリーム内のデジタル サンプル値を変更することを防ぐためにします。

Windows Server 2003 SP1 および Windows XP SP2 では、システム ミキサー、5.1 チャネルの出力ストリームを生成する場合、ミキサー常に、ストリームのチャネル マスクに設定 0x3F。 システム ミキサーは 0x60F のチャネル マスクを持つ 5.1 チャネルの入力ストリームを受信した場合でもこの方法は動作します。 ありません、オーディオ ドライバーはこの動作で、ミキサーから 0x60F のチャネル マスクを持つ 5.1 チャネル ストリームを受信します。

システム ミキサー 0x63F のチャネル マスクを持つ 7.1 チャネルの入力ストリームを受信すると、(でチャネル マスクは 0x3F) 5.1 チャネルの出力ストリームを生成、ミキサーでは、入力ストリームでチャネル 6 および 7 を 4 と 5 を出力ストリーム内のチャネルにコピーします。 ミキサーは、4 および 5 (2 つのバック スピーカー) 7.1 チャネルの入力ストリームからチャネルを破棄します。 この動作により、5.1 スピーカーの構成で側スピーカーから 7.1 チャネル ストリームの 2 つの側面のスピーカーのコンテンツを含むチャネルを再生すること。

 

 




