---
title: USB デバイスへのコンテナー ID の割り当て方法
description: USB デバイスへのコンテナー ID の割り当て方法
ms.assetid: 769f9486-d179-44f0-9fd1-b3e737143ced
ms.date: 05/09/2018
ms.localizationpriority: medium
ms.openlocfilehash: a5298352c7941dba1511c0a5fe942b48cfde7992
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63386971"
---
# <a name="how-usb-devices-are-assigned-container-ids"></a>USB デバイスへのコンテナー ID の割り当て方法


ユニバーサル シリアル バス (USB) を通じてコンピューターに接続されているデバイスの場合、次のフローチャートは、USB デバイス ノードにコンテナー ID を割り当てるために使用するヒューリスティックを示しています (*devnode*)。

![usb devnode のコンテナーの id のヒューリスティックを示すフローチャート](images/containerid-6.png)

このヒューリスティックでは、複数のソースから情報を使用して、次のいずれかが USB devnode について true かどうかを判断します。

-   Devnode は、USB バスで新しいデバイスを表しますか。 これが true の場合、devnode を受け取る新しいコンテナー ID

-   既存のデバイスの子 devnode devnode ですか。 これが true の場合、devnode は親 devnode のコンテナーの ID を継承します。

USB デバイス用のコンテナー ID は、いくつかの方法で生成されます。 この決定は、デバイス内に含まれる情報に基づきます。 この情報は、ACPI 設定、USB バス ドライバーと USB ハブから取得されます。

このヒューリスティックでは、USB バスで各 devnode プラグ アンド プレイ (PnP) マネージャーを列挙するための次の手順に従います。

1.  USB バス ドライバーによって、照会されたとき、USB デバイスが Microsoft のオペレーティング システム (OS) のコンテナー ID を報告できます**ContainerID**記述子。

    Windows 7 以降のオペレーティング システムが Microsoft OS サポート**ContainerID**記述子。 この記述子を独立系ハードウェア ベンダー (IHV) は、デバイスのコンテナー ID を正確に指定できます。 そのため、デバイスのコンテナー ID が一意では変更されていないとすべてのコンピューターで、デバイスにインストールされます。 また、マイクロソフト OS を報告する場合**ContainerID**記述子、デバイスを示します、オペレーティング システムをすべて列挙 devnode 同じ物理デバイスの一部であること。

    Microsoft OS **ContainerID**記述子は、複数のシステム バスを使用して、デバイスの同時接続をサポートするデバイスで使用するためのものです。 たとえば、プリンターでは、プラグ アンド プレイ (PnP X) の拡張機能を使用して、USB と IP ネットワークの同時接続をサポートする可能性があります。 1 つの Microsoft OS を使用して**ContainerID**記述子、両方のトランスポートの ID が報告される同じコンテナー。 そのため、PnP マネージャーでは、各バスによって列挙 devnode 同じ物理デバイスの一部であることを決定します。

    Microsoft OS の詳細については**ContainerID**記述子を参照してください、 [Microsoft OS ディスクリプター](https://go.microsoft.com/fwlink/p/?linkid=142397)します。

2.  USB デバイスが Microsoft OS を報告していないかどうか**ContainerID**記述子、USB ハブのドライバー クエリ ACPI を外部に接続されたポートに、デバイスが接続されているかどうかを判断します。

    オペレーティング システムが、ACPI アドレスの検索を試みます (**_ADR**) デバイスが接続されている USB ポートのアドレスと一致するオブジェクト。 一致するアドレス オブジェクトが見つかった場合、オペレーティング システムは、次の手順を実行します。

    -   USB ポートの機能 (**_UPC**) オブジェクトを照会し、 **PortIsConnectable**値をチェックします。 場合**PortIsConnectable** 0 以外の値を持つ 0 xff の外部のデバイスに接続するポートを使用できます。 そのため、このポートに接続されているデバイスは、コンピューターの外部である必要があります。

    -   コンピューターが ACPI 3.0 を実装している場合、 **PortIsConnectable**バイトが 0 以外の場合、オペレーティング システムがさらに、物理的な場所の説明をクエリ (**_PLD**) オブジェクト。 オペレーティング システム チェックの場合、 **UserVisible**ビット (64 ビット) を設定、 **_PLD**オブジェクト。 これは、ポートが接続可能であり、ユーザーに外部から参照可能であることを確認する追加のチェックとして。

    ACPI から収集される情報は、デバイスが外部であることを示します、PnP マネージャーは、デバイスのコンテナー ID を生成します。 **ContainedID**値は、デバイスの USB シリアル番号のハッシュまたはランダムに生成された値のいずれか。 Devnode には、このコンテナー ID が割り当てられます。

    **注**  devnode が (この場合は)、コンピューター自体のコンテナーの ID である親 devnode のコンテナーの ID を継承した場合は、オペレーティング システム、デバイスがコンピューターに内部であります。

     

3.  ACPI が返されない場合、 **_ADR**デバイスが接続されている USB ポート アドレスと一致するオブジェクト、PnP マネージャー devnode のリムーバブル状態に基づいて、コンテナー ID が生成されます。

    USB ハブのドライバーが、USB をクエリ**RemoveAndPowerMask** hub、およびチェックから記述子かどうか、 **DeviceRemovable**デバイスが接続されているポートのビットが設定されます。 場合、 **DeviceRemovable**ビットが設定されており、ポートに接続されているデバイスはハブから削除します。 場合、 **DeviceRemovable**ビットが設定されていない、ポートに接続されているデバイスはハブから not-削除します。

    USB バス ドライバー、PnP マネージャーを生成するリムーバブル/not リムーバブル状態が報告、 **ContainerId** devnode 次の手順の。

    -   ハブは、指定されたポートに接続されたデバイスはハブから削除することを示します、PnP マネージャーはこのポートに接続されているデバイスがコンピューターに外部ことを決定します。 Devnode を生成しますコンテナー ID は、デバイスの USB シリアル番号のいずれかのハッシュまたはランダムに生成された値です。

    -   ハブは、指定されたポートに接続されたデバイスがハブからリムーバブルいないことを示している場合は、このポートに接続されているデバイスは、多機能端末のサブ関数である PnP マネージャーが決定します。 この場合、devnode は親 devnode のコンテナーの ID を継承します。

ACPI 3.0 インターフェイスの詳細については、次を参照してください。 [Advanced Configuration and Power インターフェイス仕様リビジョン 3.0b](https://go.microsoft.com/fwlink/p/?linkid=145427)します。

 

 





