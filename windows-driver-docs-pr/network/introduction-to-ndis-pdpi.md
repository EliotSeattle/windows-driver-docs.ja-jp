---
title: NDIS PacketDirect Provider インターフェイスの概要
description: このセクションでは、NDIS PacketDirect Provider インターフェイス (PDPI) の概要について説明します。
ms.assetid: E85ED51E-BDE5-43BE-93BA-19F214670B8F
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 1d02e7ca8d079f733af4ea6d6ff86da120dbb608
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72844163"
---
# <a name="introduction-to-the-ndis-packetdirect-provider-interface"></a>NDIS PacketDirect Provider インターフェイスの概要


PacketDirect Provider インターフェイス (PDPI) は、物理環境と仮想環境の両方について、高速 i/o モデルで NDIS を拡張します。これにより、1秒間に処理されるパケットの数を桁違いに増やすことができます。従来の NDIS i/o パスと比較します。

## <a name="background"></a>背景


Windows の従来の i/o モデルは、一般的な多目的 i/o プラットフォームとして実装されており、さまざまな特性を持つ複数のメディアの種類を使用することを目的としており、ネットワークはシステム全体の1つの側面に過ぎませんでした。 現在、ネットワークの仮想化はデータセンターで広く普及しているため、Windows Server OS の従来の NDIS i/o モデルは、より多くの一般的なワークロードになることが期待されるネットワーク集中型のワークロードに対応するだけでは不十分です。リソースをネットワーク i/o 処理専用にするための不適切なモデル。 データセンター環境では、通常はハードウェアアプライアンス用に予約された機能を実行する専用のコンピューターを1つだけ実装することは珍しくありません。 これらのネットワークアプライアンスの例としては、ソフトウェアロードバランサー、DDoS アプライアンス、転送ゲートウェイなどがあります。 問題を悪化させるために、他の OS には、仮想アプライアンスなどのネットワーク集中型アプリケーションを構築するための推奨プラットフォームとして、このような代替 OS を作成するためのメカニズムがあります。

PacketDirect (PD) は、現在の NDIS モデルを、パケット/秒 (pps) に最適化された高速ネットワーク i/o パスで拡張します。これは、従来の NDIS i/o モデルで見られたものよりもはるかに高い順序で行われます。 これを行うには、次の手順を実行します。

-   待機時間の短縮
-   サイクル/パケットの削減
-   追加のシステムリソースの使用による直線的な高速化

PacketDirect は、従来のモデルとサイドバイサイドで存在します。 新しい PD パスは、アプリケーションで優先され、それに対応するのに十分なハードウェアリソースがある場合に使用できます。 PD は従来の i/o モデルを置き換えることを意図していません。また、PD インターフェイスに書き込むクライアントは、システムトポロジに基づいて基になるリソースのパーティション分割要件を厳密に持つことを前提としています。 PD は新しい高速データパスとして使用することを意図しています。これは、従来はハードウェアで実行されてきた高度な pps ワークロードを Windows システムが置き換えるのに役立ちます。

## <a name="packetdirect-concepts"></a>PacketDirect の概念


Pd は、PD クライアントがネットワークアダプター (NIC) からネットワークトラフィックを明示的に管理できるようにすることで機能します。 PD は、パッケージダイレクトクライアントインターフェイス (PDCI) を使用して、NIC の高パフォーマンスの送受信機能を PD クライアントが制御できるようにします。 内部的には、PDCI の送信/受信関数は、PDCI に直接マップされます。 Pd 送信/受信関数は、pd 対応の Nic で PD クライアントによって作成された PD キューを操作します。 Pd クライアントは、pd クライアントのニーズに基づいて、特定の種類のトラフィックまたは非常に汎用的なトラフィックに対してカスタムフィルターを設定する機能を提供します。 これにより、PD クライアントは特定の受信パケットを PD キューに送ることができます。 PD モデルのパケット処理は、PD クライアントによって所有 (または制御/調整) される実行コンテキストで常に発生します。 PD 対応の NIC ドライバーは完全にパッシブです。つまり、DPC やワーカースレッドなどのドライバーによって所有されている実行コンテキストで、送信されたパケットの受信パケットまたは完了を示す入力候補が、PD クライアントに対してアクティブに転送されることはありません。

PD クライアントが、パケットを処理する方法や、ARP、LLDP、その他のプロトコルパケットなどのキューのいずれかで制御パケットを受信する方法を理解していない場合、PD クライアントはパケットを現在の i/o パスに再ルーティングして処理を行うことができます。 これにより、PD はコンテキストがあるパケットの処理を継続し、制御トラフィックの無駄なサイクルをなくすことができます。

**重要**  1 つの pd プロバイダーと、ネットワークアダプターごとに1つの pd クライアントを使用できます。 そのため、1つのシステムに複数の PD クライアントと PD プロバイダーを配置できます。

 

PD クライアントは、システム内の PD に割り当てられているリソースを制御します。 ネットワークトラフィックが多い場合、PD クライアントは、他のワークロードに応答できるように、ワークロードを最小限に抑える役割を担います。

Windows によって実装される PacketDirect プラットフォームは、クライアントインターフェイスをプロバイダーインターフェイスにマップします。 このプラットフォームは、現在の NDIS 受信パスに対して、PD 経由で受信したパケットを再挿入するバッファー管理と機能を制御します。 また、pd クライアントとの対話を処理し、NIC の無効化、低電力、システムシャットダウン、突然の削除などの NDIS 制御パスの要件を満たすことができます。この方法では、PD データパスのパフォーマンスが阻害されることはありません。

**PacketDirect Provider インターフェイス (PDPI)**

PDPI を使用すると、NIC ドライバーは高パフォーマンスの送信および受信機能を Windows OS に公開できます。 実装されている関数は、完全なミニポート機能のサブセットであり、PD を実装するすべての Nic に共通です。 PDPI のリファレンスドキュメントについては、「 [PacketDirect Provider Interface (pdpi) リファレンス](https://docs.microsoft.com/windows-hardware/drivers/ddi/_netvista/)」を参照してください。

**PacketDirect Client インターフェイス (PDCI)**

PDCI では、サードパーティの Windows サービス/アプリケーション (たとえば、ロードバランサー、NAT、VM スイッチなど) で、PD クライアントを使用して PacketDirect i/o モデルを利用することで、データパスを高速化できます。 このインターフェイスは、現在の NDIS 送信/受信インターフェイスと同様にレイヤー2インターフェイスです。 PDCI が提供する主な機能 (PDCI アクセスに加えて) は、PD パケットバッファー割り当て/管理です。これは、通常の NDIS 受信パスにパケットを挿入するためのバックチャネルであり、NDIS 電源/PnP イベントの処理です。

## <a name="related-topics"></a>関連トピック


[PacketDirect Provider インターフェイス (PDPI) リファレンス](https://docs.microsoft.com/windows-hardware/drivers/ddi/_netvista/)

 

 






