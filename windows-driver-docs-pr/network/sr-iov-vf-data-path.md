---
title: SR-IOV VF データ パス
description: SR-IOV VF データ パス
ms.assetid: 0DC2327E-3A58-46BC-A3D6-3AFD24ABC901
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 55582ede1f934862e1aca9890dc5c3d7561f166e
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63346042"
---
# <a name="sr-iov-vf-data-path"></a>SR-IOV VF データ パス


物理ネットワーク アダプターでは、シングル ルート I/O 仮想化 (SR-IOV) インターフェイスをサポートする場合、1 つまたは複数 PCI Express (PCIe) 仮想機能 (Vf) を有効にすることができます。 HYPER-V 子パーティションには、各 VF をアタッチすることができます。 この場合、仮想化スタックは、次の手順を実行します。

1.  VF 用のリソースが割り当てられると、仮想化スタックは、ゲスト オペレーティング システムで VF のネットワーク アダプターを公開します。 これにより、PCI VF ミニポート ドライバーを開始するゲスト オペレーティング システムで実行されています。 このドライバーは、SR-IOV ネットワーク アダプターの独立系ハードウェア ベンダー (IHV) によって提供されます。

    **注**VF 用のリソースするミニポート ドライバーによって PCIe 物理機能 (PF) の前に割り当てる必要 VF HYPER-V 子パーティションに接続できます。 VF リソースを含める VF NIC スイッチの仮想ポート (VPort) の割り当ています。 詳細については、次を参照してください。 [SR-IOV 仮想機能](sr-iov-virtual-functions--vfs-.md)します。

2.  VF のミニポート ドライバーが読み込まれ、初期化後、NDIS では、ゲスト オペレーティング システムのネットワーク仮想サービス クライアント (NetVSC) のプロトコルの端をドライバーにバインドします。

    **注**NetVSC は VF のミニポート ドライバーにのみバインドします。 VF ミニポート ドライバーにバインドできます、ゲスト オペレーティング システムでは、その他のプロトコル スタックはありません。

ゲスト オペレーティング システム内のネットワーク トラフィックを介した、NetVSC がドライバーに正常にバインドした後、 *VF データ パス*します。 パケットを送信またはソフトウェア ベースの合成データ パスの代わりに、ネットワーク アダプターの基になる VF 経由で受信しました。 合成データ パスの詳細については、次を参照してください。 [SR-IOV 対応の合成データ パス](sr-iov-synthetic-data-path.md)します。

次の図は、SR-IOV 対応のネットワーク アダプタ上で、VF データ パスのコンポーネントを示します。

![スタックの図を管理親パーティションを使用して通信 pgf ミニポートと、vf を使用して通信するゲスト オペレーティング システムが含まれる子パーティションの下に、sr-iov アダプター ミニポート](images/sriovvf-datapaths.png)

VF データ パスの使用の利点は、次のとおりです。

-   すべてのデータ パケットは、ゲスト オペレーティング システムのネットワーク コンポーネントと、VF 間で直接フローです。 これにより、HYPER-V 子と親パーティションの間でどのデータ パケットのフローでの合成データ パスのオーバーヘッドがなくなります。

    合成データ パスの詳細については、次を参照してください。 [SR-IOV 対応の合成データ パス](sr-iov-synthetic-data-path.md)します。

-   VF のデータ パスは、HYPER-V 子パーティションからのパケット トラフィック管理オペレーティング システムでの介入をバイパスします。 VF は、がアタッチされている子パーティションを独立したメモリ領域、割り込みと DMA のストリームを提供します。 これは、nonvirtualized 環境とほぼ互換性があるネットワークのパフォーマンスを発揮します。

-   VF データ パス上でパケットのルーティングは、NIC によって実行、SR-IOV ネットワーク アダプターをオンにします。 パケットを送信または外部ネットワーク アダプターの物理ポート経由で受信します。 パケットは、VF がアタッチされている他の子パーティションとの間も転送されます。

    **注**をまたはから子パーティションを VF にアタッチされませんが、NIC によって転送されるパケットが HYPER-V 拡張可能スイッチ モジュールに切り替えます。 このモジュールは、HYPER-V の親パーティション内で実行し、合成データ パスを使用して子パーティションにこれらのパケットを配信します。