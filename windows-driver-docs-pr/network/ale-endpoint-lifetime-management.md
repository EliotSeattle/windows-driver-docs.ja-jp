---
title: ALE エンドポイントの有効期間管理
description: ALE エンドポイントの有効期間管理
ms.assetid: cbf54062-4ced-4cf6-babf-e9e4e1ddf302
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 976ac66dc1e0bc436cfc464d5ad940d54b9afc79
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56530539"
---
# <a name="ale-endpoint-lifetime-management"></a>ALE エンドポイントの有効期間管理


アプリケーション レイヤーの強制 (ALE) をサポートしているコールアウト ドライバーは、問題を処理するリソースを割り当てる必要があります。 このトピックでは、関連付けられているエンドポイントが閉じられたときに、このようなリソースを解放するコールアウト ドライバーを構成する方法について説明します。 ALE エンドポイントの有効期間管理は、Windows 7 および Windows の以降のバージョンでサポートされます。

ALE エンドポイントに関連付けられているリソースを管理するには、コールアウト ドライバーは、次の層に登録できます。

-   FWPS\_レイヤー\_ALE\_リソース\_リリース\_V4 (FWPM\_レイヤー\_ALE\_リソース\_リリース\_V4)

-   FWPS\_レイヤー\_ALE\_リソース\_リリース\_V6 (FWPM\_レイヤー\_ALE\_リソース\_リリース\_V6)

-   FWPS\_レイヤー\_ALE\_エンドポイント\_クロージャ\_V4 (FWPM\_レイヤー\_ALE\_エンドポイント\_クロージャ\_V4)

-   FWPS\_レイヤー\_ALE\_エンドポイント\_クロージャ\_V6 (FWPM\_レイヤー\_ALE\_エンドポイント\_クロージャ\_V6)

ALE リソース割り当ての対応するレイヤーですべてを示す値を使用するよう ALE リソース リリース レイヤーが示されています (たとえば、FWPS\_レイヤー\_ALE\_リソース\_割り当て\_V4)。 ドライバーが、割り当ての層、FWPS リリース レイヤーを一致そのコールアウトを確認する\_メタデータ\_フィールド\_トランスポート\_エンドポイント\_ハンドル メタデータ フィールドはレイヤーとそれぞれの両方で提供されますエンドポイントには、一意のハンドルが割り当てられます。

ALE エンドポイント クロージャ レイヤーは、エンドポイントの種類に応じて異なる方法で起動されます。 すべて ALE 承認の TCP 接続の ALE エンドポイントの閉包が示されます層の接続 (たとえば FWPS\_レイヤー\_ALE\_AUTH\_CONNECT\_V4) ALE を承認または受信 (のレイヤーをそのまま使用例 FWPS\_レイヤー\_ALE\_AUTH\_RECV\_ACCEPT\_V4) を示す値。 エンジンがエンドポイントごとに一意のハンドルを割り当てるし、FWPS で渡します ALE リソースには、リリースの問題を\_メタデータ\_フィールド\_トランスポート\_エンドポイント\_メタデータ フィールドのハンドル。 TCP 以外のエンドポイントの一意のリモート ピアと通信して、ソケットの数に関係なく、各エンドポイントの ALE エンドポイント クロージャ レイヤーが呼び出されます。 ALE エンドポイント クロージャ レイヤーは各 TCP リスニング ソケットも呼び出されます。

コールアウト ALE エンドポイント クロージャ レイヤーの登録には、保留の分類ことができます。 これにより、エンドポイントのシャット ダウンする前に、非同期処理のコールアウトのすべてのパケットを再挿入をキューに登録できます。 保留の分類にコールアウト ドライバーを呼び出す必要があります[ **FwpsPendClassify0** ](https://msdn.microsoft.com/library/windows/hardware/ff551197)への呼び出しに続く[ **FwpsCompleteClassify0** ](https://msdn.microsoft.com/library/windows/hardware/ff551150)とき処理が完了しました。

該当する場合、エンジンは、FWPS に親エンドポイントの一意のハンドルを示します\_メタデータ\_フィールド\_親\_エンドポイント\_メタデータ フィールドのハンドル。 これにより、必要な場合、親/子の関係を追跡するために、コールアウト ドライバー。

 

 





