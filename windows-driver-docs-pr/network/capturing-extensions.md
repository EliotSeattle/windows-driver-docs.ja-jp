---
title: キャプチャ拡張機能
description: キャプチャ拡張機能
ms.assetid: A8C2E550-4B1F-4DDB-B97F-1F7B6B74F5E7
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: d260e5edb69b902c3b4c84539ca34408bb24bc3e
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56579363"
---
# <a name="capturing-extensions"></a>キャプチャ拡張機能


キャプチャ拡張機能、HYPER-V 拡張可能スイッチは、パケット トラフィック、オブジェクト識別子 (OID) の要求、および NDIS 状態インジケーターを検査します。 この種類の拡張は、変更や、パケットを削除または拡張可能スイッチ ポートに配信されてからのパケットを除外することはできません。 ただし、取得拡張機能と拡張機能は、ホスト アプリケーションに送信するトラフィックの統計情報を含むパケットなどのパケットのトラフィックが発生することです。

キャプチャ拡張機能は、イングレス データ パスの先頭と出口のデータ パスの最後に呼び出されます。 これらのデータ パスの詳細については、[Hyper-v 拡張可能スイッチのデータ パス](hyper-v-extensible-switch-data-path.md)を参照してください。

キャプチャ拡張機能では、次の要件と制限事項があります。

-   キャプチャ拡張機能は、拡張可能スイッチのインターフェイスをサポートする NDIS フィルター ドライバーとして開発する必要があります。

    フィルター ドライバーの詳細については、[NDIS フィルター ドライバー](ndis-filter-drivers2.md)を参照してください。

    キャプチャ拡張機能の記述方法の詳細については、[書き込みの Hyper-v 拡張可能スイッチ拡張機能](writing-hyper-v-extensible-switch-extensions.md)を参照してください。

-   キャプチャ拡張機能は、標準の NDIS 監視フィルター ドライバーと同じ機能を提供します。 ただし、INF ファイルをキャプチャ拡張機能をする必要がありますとしてインストール フィルター ドライバーを変更します。

    フィルター ドライバーを変更する方法の詳細については、[型のフィルター ドライバー](types-of-filter-drivers.md)を参照してください。

    フィルター ドライバーを変更するための INF 要件の詳細については、[変更フィルター ドライバーの INF ファイルを構成する](configuring-an-inf-file-for-a-modifying-filter-driver.md)を参照してください。

-   キャプチャ拡張機能は、イングレスおよびエグレス拡張可能スイッチのデータ パス上でパケットを監視できます。 ただし、この種類の拡張機能を呼び出す必要があります常に[ **NdisFSendNetBufferLists** ](https://msdn.microsoft.com/library/windows/hardware/ff562616)拡張可能スイッチ ドライバー スタック内の基になるドライバーにパケットを転送し、それらを完了できません。

-   キャプチャ拡張機能は、パケット内のデータを変更したり、パケットの帯域外の (OOB) データを変換先のポートを追加する必要がありますしません。 拡張機能は、任意の拡張可能スイッチ ポートへのパケットの配信を除外しない必要があります。

-   キャプチャ拡張機能は、パケットを取得できます。 たとえば、拡張機能は、リモート監視アプリケーションにトラフィックの状態を報告する順序でパケットを発生させてよい場合します。

    拡張機能により、パケットを送信元の詳細については、[パケットの発信トラフィック](originating-packet-traffic.md)を参照してください。

    **注**  ように他の拡張子を持つキャプチャ拡張機能はのみ、拡張可能スイッチのイングレス データ パスにパケット トラフィックを送信します。

     

-   キャプチャ拡張機能には、パケット、OID 要求、および拡張可能スイッチのドライバー スタックに発行される NDIS 状態インジケーターを監視できます。 ただし、この種類の拡張機能では、パケット、OID 要求、および拡張可能スイッチ ドライバー スタックを通じた NDIS 状態インジケーターを転送する必要があります。 拡張機能は、パケット、OID 要求、または、監視対象 NDIS 状態インジケーター内のデータを変更する必要があります。

-   **FilterClass** INF ファイルで値拡張機能を設定する必要があります**ms\_切り替える\_キャプチャ**します。 詳細については、[Hyper-v 拡張可能スイッチ拡張機能の要件を INF](inf-requirements-for-hyper-v-extensions.md)を参照してください。

-   任意の数をキャプチャするための拡張機能は、拡張可能スイッチ インスタンスにバインドできます。 既定では、複数のキャプチャ拡張機能がインストールされているときにに基づいて並べ替えられています。 などの複数キャプチャ拡張機能に、最近インストールされた拡張機能が、スタック内の他のキャプチャ拡張機能の上に配置を拡張可能スイッチのドライバー スタックで配置されます。

    拡張可能スイッチ インスタンスにバインドされた後、取得拡張機能で拡張可能スイッチのドライバー スタックのレイヤーを並べ替えることができます。 詳細については、[の並べ替えの Hyper-v 拡張可能スイッチの拡張](reordering-hyper-v-extensibility-switch-extensions.md)を参照してください。

 

 





