---
title: 転送拡張機能
description: 転送拡張機能
ms.assetid: 7ABBB3F3-66F5-4651-8A5A-94940F3FD82D
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: e9edee9cb08971a5cd6eeabb6511359f0fca5989
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56557592"
---
# <a name="forwarding-extensions"></a>転送拡張機能


転送拡張機能が、フィルター処理の拡張機能と同じ機能がコア パケットの転送を実行して、拡張可能スイッチのタスクをフィルター処理を担当します。 これらのタスクを以下に示します。

-   パケットの宛先ポートを決定します。

    **注**  宛先ポートし、パケットを転送パケットが、NVGRE パケットの場合は、拡張可能スイッチの HYPER-V ネットワーク仮想化 (HNV) コンポーネントを決定します。 詳細については、[ハイブリッド転送](hybrid-forwarding.md)を参照してください。

     

-   セキュリティ、プロファイル、または仮想 LAN (VLAN) のポリシーなどの標準ポート ポリシーの適用によってパケットのフィルター処理します。

    **注**  拡張可能スイッチが引き続き組み込みのポリシーに基づくフィルター処理を実行します。 これらのポリシーは、アクセス制御リスト (Acl) とサービスの品質 (QoS)。

     

**注**  パケットの宛先ポートだけでなく標準のポートの設定に基づいてパケットをフィルター処理、転送拡張機能をインストールしないと拡張可能スイッチで有効になっているは、スイッチを決定します。

 

転送拡張機能は、すぐに拡張可能スイッチ拡張機能のミニポート ドライバーで送信および受信データ パス上に配置されます。 これらのデータ パスの詳細については、[Hyper-v 拡張可能スイッチのデータ パス](hyper-v-extensible-switch-data-path.md)を参照してください。

転送拡張機能は、イングレス データ パス取得したパケットを使用して、次を実行できます。

-   パケット トラフィックをフィルター処理しカスタムおよび標準ポートを適用または拡張可能スイッチを通じてパケット配信ポリシーを切り替えることができます。 転送拡張機能では、イングレス データ パス内のパケット フィルター処理、送信元ポートとパケットに、拡張機能を代入する宛先ポートに基づいてフィルタ リング規則が適用されます。

    カスタム ポリシーは、独立系ソフトウェア ベンダー (ISV) によって定義されます。 標準的なポリシーは、拡張可能スイッチのインターフェイスによって定義されます。 この種のポリシーのプロパティの設定は、HYPER-V の WMI 管理層によって管理されます。 転送拡張機能がこれらのオブジェクト識別子 (OID) 要求プロパティの設定で構成されている[OID\_スイッチ\_ポート\_プロパティ\_UPDATE](https://msdn.microsoft.com/library/windows/hardware/hh598278)と[OID\_スイッチ\_プロパティ\_UPDATE](https://msdn.microsoft.com/library/windows/hardware/hh598283)します。

    ポリシーの拡張可能スイッチの詳細については、[を管理する Hyper-v 拡張可能なスイッチ ポリシー](managing-hyper-v-extensible-switch-extensibility-policies.md)を参照してください。

-   新しい、変更、または複製されたパケットの受信データのパスを挿入できます。

    詳細については、[Hyper-v 拡張可能スイッチの送信と受信操作](hyper-v-extensible-switch-send-and-receive-operations.md)を参照してください。

-   それは、パケットの 1 つまたは複数の拡張可能スイッチの宛先ポートへの配信を判断できます。 これにより、拡張可能なスイッチ ポートのパケット配信の宛先ポートを追加する転送拡張機能です。

    宛先ポートを追加する方法の詳細については、[を追加する拡張可能なスイッチ宛先ポート データ パケットに](adding-extensible-switch-destination-port-data-to-a-packet.md)を参照してください。

転送拡張機能は、送信データ パス取得したパケットを使用して、次を実行できます。

-   パケット トラフィックをフィルター処理しカスタムおよび標準ポートを適用または拡張可能スイッチを通じてパケット配信ポリシーを切り替えることができます。 出口データ パス内のパケット フィルターを転送拡張機能は、パケットの送信元または送信先のポートに基づくフィルタ リング規則を適用できます。

-   これは、パケットの 1 つまたは複数の拡張可能スイッチの宛先ポートへの配信を除外できます。 これにより、拡張可能スイッチのポートへのパケットの配信を除外する転送拡張機能です。

    拡張可能スイッチ ポートにパケット配信を除外する方法の詳細については、[拡張可能スイッチの宛先ポートへのパケット配送の除外](excluding-packet-delivery-to-extensible-switch-destination-ports.md)を参照してください。

    **注**  エグレス データ パス上のパケットを処理する場合、転送拡張機能はパケット配信を除外のみできます。 拡張機能では追加のみまたはイングレス データ パス上のパケットの宛先ポートを変更できます。

     

-   パケット データを変更できます。 転送拡張機能、データ パケットを変更する場合は、変換先のポートを割り当てる前にパケットを最初に複製にする必要があります。 パケットが割り当てられている変換先が変更されたとポートをされた後、拡張機能は、エグレス データのパスに変更されたパケットを挿入する必要があります。

    詳細については、[パケット トラフィックの複製](cloning-or-duplicating-packet-traffic.md)を参照してください。

OID 要求と NDIS 状態インジケーターを検査、だけでなく転送拡張機能は、次の操作を行うことができます。

-   拡張可能スイッチ コントロール パスに Oid または NDIS の状態インジケーターを挿入できます。 これにより、作成または Oid と状態インジケーターの変更を基になる物理ネットワーク アダプターとの間に転送する転送拡張機能です。

    たとえば、拡張可能スイッチの外部ネットワーク アダプターは、NDIS マルチプレクサー (マルチプレクサー) の中間ドライバーの仮想ミニポート端にバインドできます。 MUX 中間ドライバー自体は、ホスト上の 1 つまたは複数の物理ネットワーク チームにバインドできます。 この構成と呼ばれる、*拡張可能スイッチ チーム*します。

    この構成では、拡張可能スイッチ拡張機能は拡張可能スイッチ チームのすべてのネットワーク アダプターに公開されます。 これにより、転送拡張機能が拡張可能スイッチのドライバー スタックを構成し、チーム内の個々 のネットワーク アダプターの使用を管理するの。 たとえば、拡張機能では、個々 のアダプターに送信されるパケットを転送することによって、over、チーム分散フェールオーバー (LBFO) のソリューション ロードのサポートを提供できます。 このような拡張機能と呼ばれる、*チーミング プロバイダー*します。

    チーミング プロバイダーとして動作している、転送拡張機能は作成または変更を有効または、チームでアダプターのハードウェア機能を無効にする OID 要求できます。 チーム化のプロバイダーを作成またはチームの 1 つまたは複数のアダプターへの変更に基づく NDIS 状態インジケーターの変更もできます。

    プロバイダーのチーミングの詳細については、[プロバイダーの拡張機能のチーミング](teaming-provider-extensions.md)を参照してください。

-   状態を返すことによって、拡張可能スイッチ ポートまたはネットワーク アダプターの接続の作成を拒否することができます\_データ\_いない\_適用可能な拡張可能スイッチの Oid を承諾します。 状態を返すことによって、転送拡張機能がポートの作成要求を拒否するなど、\_データ\_いない\_ドライバーの OID 設定要求の受信時に合意[OID\_スイッチ\_ポート\_作成](https://msdn.microsoft.com/library/windows/hardware/hh598272)です。

    **注**  転送拡張機能を作成またはポートを削除またはしないでネットワーク アダプターの接続。 拡張可能スイッチのプロトコルのエッジは、作成またはポートまたはネットワーク アダプターの接続の削除について、基になる拡張機能を通知する Oid を発行します。 詳細については、[Hyper-v 拡張可能スイッチのポートおよびネットワーク アダプターの状態](hyper-v-extensible-switch-port-and-network-adapter-states.md)を参照してください。

     

-   状態を返すことによって追加または拡張可能スイッチまたはポートのポリシーの更新プログラムを拒否できます、\_データ\_いない\_適用可能な拡張可能スイッチの Oid を受け入れられます。 状態を返すことによって、転送拡張機能がポート ポリシーの追加を拒否するなど、\_データ\_いない\_ドライバーの OID 設定要求の受信時に合意[OID\_スイッチ\_ポート\_プロパティ\_追加](https://msdn.microsoft.com/library/windows/hardware/hh598275)します。

    ポリシーの拡張可能スイッチの詳細については、[を管理する Hyper-v 拡張可能なスイッチ ポリシー](managing-hyper-v-extensible-switch-extensibility-policies.md)を参照してください。

転送拡張機能では、次の要件があります。

-   転送拡張機能は、拡張可能スイッチのインターフェイスをサポートする NDIS フィルター ドライバーとして開発する必要があります。

    フィルター ドライバーの詳細については、[NDIS フィルター ドライバー](ndis-filter-drivers2.md)を参照してください。

    転送拡張機能を記述する方法の詳細については、[書き込みの Hyper-v 拡張可能スイッチ拡張機能](writing-hyper-v-extensible-switch-extensions.md)を参照してください。

-   転送拡張機能の INF ファイルでは、変更のフィルター ドライバーとして拡張機能をインストールする必要があります。 NDIS 監視フィルターは、拡張可能スイッチ ドライバー スタックでドライバーをインストールすることはできません。

    フィルター ドライバーを変更する方法の詳細については、[型のフィルター ドライバー](types-of-filter-drivers.md)を参照してください。

    フィルター ドライバーを変更するための INF 要件の詳細については、[変更フィルター ドライバーの INF ファイルを構成する](configuring-an-inf-file-for-a-modifying-filter-driver.md)を参照してください。

-   **FilterClass** INF ファイルで値拡張機能を設定する必要があります**ms\_切り替える\_フォワード**します。 詳細については、[Hyper-v 拡張可能スイッチ拡張機能の要件を INF](inf-requirements-for-hyper-v-extensions.md)を参照してください。

-   拡張可能スイッチのインスタンスごとにドライバー スタックでは、1 つだけの転送拡張機能を有効にできます。

拡張可能スイッチ チームの詳細については、[型の物理ネットワーク アダプターの構成](types-of-physical-network-adapter-configurations.md)を参照してください。

転送拡張機能の詳細については、次のページを参照してください。

-   [プロバイダーの拡張機能のチーミング](teaming-provider-extensions.md)
-   [ハイブリッド転送](hybrid-forwarding.md)

## <a name="related-topics"></a>関連トピック


[HYPER-V 拡張可能なスイッチ ポートにパケットを転送](forwarding-packets-to-hyper-v-extensible-switch-ports.md)

[物理ネットワーク アダプターにパケットを転送](forwarding-packets-to-physical-network-adapters.md)

[HYPER-V 拡張可能スイッチの概要](overview-of-the-hyper-v-extensible-switch.md)

 

 






