---
title: MB デバイスの準備
description: MB デバイスの準備
ms.assetid: 67a67ff7-dcff-4aec-bea9-7b1be9593649
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: f0255f56b6755a455a4697cdc555c028a655e275
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72844294"
---
# <a name="mb-device-readiness"></a>MB デバイスの準備


このトピックでは、mb サービスがデータ接続のセットアップを開始する前に、MB デバイスがアクセス可能で、ネットワーク関連のアクティビティに使用できるようにするための手順について説明します。 ユーザーサブスクリプションがアクティブ化され、デバイスまたはサブスクライバー Id モジュール (SIM カード) に格納されているサブスクライバー関連の情報が、デバイスで使用できるようになりました。

MB サービスは、ミニポートドライバーが、サービスからの命令を待たずに、システムが読み込まれた後に、その MB デバイスのハードウェア (ラジオスタック、SIM カード、または同等の回路) を自動的に初期化することを前提としています。

ミニポートドライバーは、MB デバイスの初期準備完了状態を**WwanReadyStateOff**に設定します。 初期化を続行すると、ミニポートドライバーは、デバイスの準備完了状態に対する変更を MB サービスに通知するためにイベント通知を送信する必要があります。

ミニポートドライバーがエラー状態になると、初期化プロセスを停止する必要があります。 エラー状態が解消されると、ミニポートドライバーは、デバイスが**WwanReadyStateInitialized** ready 状態になるまで初期化プロセスを再開できます。

いくつかのエラーシナリオの例を次に示します。

-   デバイスに SIM カードが必要で、ミニポートドライバーによって SIM カードが存在しないことが検出された場合、ミニポートドライバーは**WwanReadyStateSimNotInserted** ready イベント通知を送信する必要があります。また、ミニポートドライバーは、ユーザーがSIM カードをデバイスに挿入します。

-   デバイスに SIM カードが必要で、ミニポートドライバーが挿入された SIM カードを読み取ることができない場合 (たとえば、U フレームが GSM ベースのデバイスに挿入された場合や、USIM が CDMA ベースのデバイスに挿入された場合など)、SIM カードがデバイスと互換性がありません (例: 3G デバイスに 3G (USIM 形式を解釈できません) が挿入されます。また、ミニポートドライバーは**WwanReadyStateBadSim** ready イベント通知を送信する必要があります。また、ユーザーが正しい SIM カードを挿入するまで、ミニポートドライバーはその状態のままにしておく必要があります。をデバイスに挿入します。

-   デバイスが PIN によってロックされている場合 (SIM カードを使用しているデバイスの場合)、またはデバイスの初期化の進行を妨げるパスワード (SIM カードを使用していないデバイスの場合) では、ミニポートドライバーは**WwanReadyStateDeviceLocked** ready イベントを送信する必要があります。ユーザーが正しい PIN またはパスワードを入力するまで、通知とミニポートドライバーはその状態のままにしておく必要があります。

-   サービスのアクティブ化が必要であることがミニポートドライバーによって検出された場合、ミニポートドライバーは**WwanReadyStateNotActivated** ready イベント通知を送信する必要があり、サービスがアクティブ化されるまでその状態を維持する必要があります。 これは、北米の CDMA ベースのデバイスに対する一般的な動作です。

-   ミニポートドライバーが前に説明したものとは異なるエラーで実行される場合、ミニポートドライバーは**WwanReadyStateFailure**の準備完了イベント通知を送信する必要があり、問題が特定されるまでその状態のままにしておく必要があります。やり直し.

MB サービスでは、ミニポートドライバーがこれらのエラーをすべて検出できるとは限らないことに注意してください。 また、このサービスでは、ミニポートドライバーがこれらのエラー状態を検出する順序を想定していません。 ただし、上記の順序でエラーシナリオを実装することをお勧めします。

ミニポートドライバーによって**WwanReadyStateInitialized** ready イベント通知が送信されるまで、サービスは、問題が特定され、修正されるまで、ネットワーク関連のアクティビティを使用してそれ以上続行されません。 ただし、サービスは依然として、ミニポートドライバーに Oid を送信する場合があります。

ミニポートドライバーは、 **WwanReadyStateInitialized**の準備ができている状態を報告する前に、SMS サブシステムの準備が整うまで待つ必要はありません。 代わりに、sms サブシステムで SMS メッセージを送受信する準備ができたときに、ミニポートドライバーは、 [\_sms\_構成](https://docs.microsoft.com/windows-hardware/drivers/network/oid-wwan-sms-configuration)通知を\_、個別の OID を送信する必要があります。

### <a name="emergency-mode-support"></a>緊急モードのサポート

[OID\_wwan\_準備完了の\_情報](https://docs.microsoft.com/windows-hardware/drivers/network/oid-wwan-ready-info)の処理中に、ミニポートドライバーによって緊急コールサービスがサポートされていることが示された場合、ミニポートドライバーは、 [**wwan\_READY\_INFO**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wwan/ns-wwan-_wwan_ready_info)構造体の**EmergencyMode**メンバーを**WwanEmergencyModeOn**に設定する必要があります。 この場合、ミニポートドライバーは引き続き MB サービスに登録通知を送信する必要がありますが、サービスは自動構成関連機能を起動しません。

ミニポートドライバーでは、SIM が有効ではなくなったことを検出するシナリオ (サブスクリプションが未払いである、またはデバイスが盗難に報告されたためにサービスが非アクティブ化されているなど) であっても、緊急通話サービスをサポートするように指定できます。

デバイスの準備の詳細については、「 [OID\_WWAN\_準備完了\_情報](https://docs.microsoft.com/windows-hardware/drivers/network/oid-wwan-ready-info)」を参照してください。

 

 





