---
title: Winsock カーネル関数とイベントコールバック関数の使用
description: Winsock カーネル関数と
ms.assetid: 63a3f933-f74a-4cb8-a7a9-9498e1c17afa
keywords:
- Winsock カーネル WDK ネットワーク, 関数
- WSK WDK ネットワーク, 関数
- Winsock カーネル WDK ネットワーク、イベント
- WSK WDK ネットワーク、イベント
- イベント WDK Winsock カーネル
- functions WDK Winsock カーネル
- イベントコールバック関数 WDK Winsock カーネル
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: dff14c922cd564294d5dee0639258bb0ba6152fc
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72842961"
---
# <a name="using-winsock-kernel-functions-vs-event-callback-functions"></a>Winsock カーネル関数とイベントコールバック関数の使用


特定のソケット操作の場合、Winsock カーネル (WSK) アプリケーションは、ソケットの WSK 関数のいずれかを呼び出して操作を実行するか、または操作に関連付けられた[イベント](winsock-kernel-events.md)が発生したときに wsk サブシステムが呼び出すソケットに対してイベントコールバック関数を実装し、有効にすることができます。 たとえば、接続指向のソケットでデータを受信する場合、WSK アプリケーションはソケットの[**Wskreceive**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wsk/nc-wsk-pfn_wsk_receive)関数を呼び出すか、またはソケットに対して[*wskreceiveevent*](https://docs.microsoft.com/windows-hardware/drivers/ddi/wsk/nc-wsk-pfn_wsk_receive_event)イベントコールバック関数を実装および有効にすることができます。 WSK アプリケーションの要件によって、アプリケーションで使用する方法が決まります。 2つの方法の使用例については、WSK のドキュメントを参照してください。

次の一覧は、各方法の重要なポイントをまとめたものです。

### <a name="using-winsock-kernel-functions"></a>Winsock カーネル関数の使用

-   WSK アプリケーションはソケット操作を実行します。つまり、WSK アプリケーションは、ソケット操作が行われるタイミングを制御します。 これにより、WSK アプリケーションが必要とする同期が単純化されます。

-   WSK アプリケーションは、ソケット関数に Irp を提供します。 これらの Irp は、ソケット操作が完了するまで WSK サブシステムによってキューに登録されます。 WSK 関数での Irp の使用の詳細については、「 [Winsock カーネル関数での irp の使用](using-irps-with-winsock-kernel-functions.md)」を参照してください。

-   WSK アプリケーションは、各操作の IRP が WSK サブシステムによって完了するのを待機することで、ブロックするソケット操作を実行できます。

-   WSK アプリケーションでは、接続指向のソケットでの高パフォーマンスデータ転送を確実に行うために、複数のソケット操作をキューに入れておく必要がある場合があります。これは、着信データグラムがデータグラムソケットにドロップされないようにするため、または受信接続がリッスンソケット上で削除されています。

-   WSK アプリケーションは、データ転送操作用のデータバッファーを提供します。 これにより、データのコピーが必要になる回数を減らすことができます。 ただし、WSK アプリケーションが複数のデータ転送操作をキューに保持している場合は、キューに置かれたデータ転送操作ごとに、アプリケーションで WSK サブシステムにデータバッファーを提供する必要があります。 そのため、WSK アプリケーションでは、追加のメモリリソースが必要になる場合があります。

### <a name="using-event-callback-functions"></a>イベントコールバック関数の使用

-   WSK サブシステムはソケット操作を駆動します。つまり、WSK サブシステムは、ソケットのイベントコールバック関数を呼び出すことによって、ソケットのイベントの WSK アプリケーションに通知します。 WSK アプリケーションでは、イベントコールバック関数の非同期の性質を処理するために、より複雑な同期が必要になる場合があります。

-   WSK アプリケーションは、ソケット操作に対して Irp を使用しません。

-   WSK アプリケーションは、ソケット操作をキューに置いている必要はありません。 WSK サブシステムは、ソケットのイベントが発生するとすぐに WSK アプリケーションのイベントコールバック関数を呼び出します。 WSK アプリケーションが、ソケットのイベントコールバック関数が呼び出される速度に対応できる場合、イベントコールバック関数を使用すると、最大のパフォーマンスと、データグラムや着信接続を削除する可能性が最も低くなります。

-   WSK サブシステムは、データ転送操作用のデータバッファーを提供します。 Wsk アプリケーションは、これらのデータバッファーを WSK サブシステムに直ちに、または適切な時間内に解放して、WSK サブシステムでメモリリソースが不足しないようにする必要があります。 そのため、wsk アプリケーションでは、WSK サブシステムによって所有されているデータバッファーから、独自のデータバッファーにデータをコピーすることが必要になる場合があります。

上記の一覧は必ずしも包括的であるとは限りませ**ん  。** 特定の WSK アプリケーションに最適な方法を選択する際には、他に考慮すべき点があります。

 

 

 





