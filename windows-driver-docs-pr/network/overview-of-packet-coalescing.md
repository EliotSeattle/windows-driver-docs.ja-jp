---
title: パケット結合の概要
description: パケット結合の概要
ms.assetid: E406E89C-247B-4DCB-B309-B742BF0A27E9
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 522565d0e1a09ab3fee4e4b57752483727164161
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63340944"
---
# <a name="overview-of-packet-coalescing"></a>パケット結合の概要


特定の IP バージョン 4 (IPv4) と 6 (IPv6) のネットワーク プロトコルは、パケットをブロードキャストまたはマルチキャスト アドレスの送信を伴う IP バージョン。 これらのパケットは、IPv4 および IPv6 サブネット内の複数のホストで受信されます。 ほとんどの場合、これらのパケットを受信するホストは行いませんこれらのパケットで何か。 そのため、これらの不要なマルチキャストまたはブロードキャスト パケットの受信は、不要な処理と電力の消費量、受信ホスト内に発生するとします。

たとえば、ホスト A の送信、マルチキャスト リンク ローカル マルチキャスト名前解決 (LLMNR) を解決するのには IPv6 サブネットの要求は、B の名前をホストします。 ホスト A は、を除き、この LLMNR 要求は、サブネット上のすべてのホストによって受信されます。 ホスト B を除いては、他のホストで実行されている TCP/IP プロトコル スタックは、パケットを検査し、なパケットがその意図されていませんを決定します。 プロトコル スタックは、パケットと呼び出しを拒否するため、 [ **NdisReturnNetBufferLists** ](https://msdn.microsoft.com/library/windows/hardware/ff564534)にパケットをミニポート ドライバーに戻ります。

NDIS パケット結合 NDIS 6.30 以降では、ネットワーク アダプターをサポートできます。 ランダム ブロードキャストまたはマルチキャスト パケット数、処理のオーバーヘッドと電源の結合を介して受信割り込みの数を減らすことでは、システムの消費量が大幅に削減します。

パケットの結合には、次の手順が含まれます。

1.  定義、TCP/IP プロトコル スタックなどのドライバーを後続 NDIS ブロードキャストおよびマルチキャスト パケットを画面に使用されるフィルターを受信します。 上にあるドライバーは、パケットの結合をサポートしている基になるミニポート ドライバーにこれらのフィルターをダウンロードします。 ミニポート ドライバーがネットワーク アダプターを構成して、ダウンロードした後、パケットの結合フィルターを受信します。

    これらのフィルターの詳細については、次を参照してください。[パケット結合受信フィルター](packet-coalescing-receive-filters.md)します。

2.  一致するパケットを受信した受信フィルターはキャッシュまたは*まとめられた*、ネットワーク アダプターにします。 アダプターは、結合されたパケットの受信の割り込みを生成しません。 代わりに、別のハードウェア イベントが発生した場合、アダプターは、ホストを中断します。

    この割り込みが生成されたときに、アダプターは、割り込みの受信イベントを示す必要があります。 これにより、ネットワーク アダプターのネットワーク アダプターで受信した結合されたパケットを処理できます。

    たとえば、パケットの結合をサポートするネットワーク アダプターは、次のイベントのいずれかが発生すると受信割り込みを生成できます。

    -   有効期限は、一致する受信のフィルターの最大の結合の遅延値に設定されてハードウェア タイマーの有効期限。

    -   ハードウェア合体バッファー内で使用可能な領域は、アダプターが指定した低水位マークに到達します。

    -   結合フィルターに一致しないパケットを受信します。

    -   送信の完了イベントなどの別の中断イベントが発生しました。

    このプロセスの詳細については、次を参照してください。[処理パケット結合受信フィルター](handling-packet-coalescing-receive-filters.md)します。

次の点は、パケットは、NDIS によって結合のサポートに適用されます。

-   NDIS は、パケットは物理ネットワーク アダプターに割り当てられている既定の NDIS ポート (ポート 0) で受信したパケットの結合をサポートします。 NDIS は、パケットが仮想ネットワーク アダプターに割り当てられている NDIS ポートで結合をサポートしていません。 詳細については、次を参照してください。 [NDIS ポート](ndis-ports.md)します。

-   NDIS サポート パケットが、既定で受信したパケットの結合には、ネットワーク アダプターのキューが表示されます。 この受信キューが識別子の NDIS\_既定\_受信\_キュー\_id。
