---
title: デバイス インストールの共同インストーラーのデバッグ
description: デバイス インストールの共同インストーラーのデバッグ
ms.assetid: a5cf3cec-bd61-49a6-b836-6759cd8c7d82
keywords:
- デバイス インストールの共同インストーラーがデバッグ
- デバッグ共同インストーラーをインストール
- デバッグ共同インストーラー
ms.date: 05/23/2017
ms.localizationpriority: medium
ms.openlocfilehash: ce340d98e111ff1bf87b7877c402ae54b8afff22
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63324638"
---
# <a name="debugging-a-device-installation-co-installer"></a>デバイス インストールの共同インストーラーのデバッグ


## <span id="ddk_debugging_dual_boot_machines_dbg"></span><span id="DDK_DEBUGGING_DUAL_BOOT_MACHINES_DBG"></span>


一部のハードウェア デバイスのインストール パッケージと呼ばれる DLL ファイルを含める*co-installer*デバイスのインストールを支援します。

その他のモジュールと同じように共同インストーラーをデバッグすることはできません。 これは共同インストーラーが読み込まれている一意の方法により、多くのインストール シナリオが実行中のプロセスを中断する機会を開発者に提供することがなく自動的に発生するためです。

この問題を解決するには、プログラムでデバイスをインストールします。 共同インストーラー自体へのアクセスを許可するデバイスにインストールされるアプリケーションにデバッガーをアタッチします。 これを実現する最も簡単な方法がまたはを使用して、デバイスを再インストールするには、 [DevCon](https://go.microsoft.com/fwlink/p/?linkid=152915) Windows Driver Kit (WDK) に含まれるツールです。 Windbg 共同インストーラーをデバッグできます。

このタスクを実行するのにには、次の手順を使用します。 この手順では、共同インストーラーを使用するデバイスの作業用のドライバーのインストール パッケージを開発したものとします。 WDK の最新のコピーがあることも想定しています。 ドライバー、ドライバーのインストール パッケージ、およびドライバーのインストールの co-installer を開発する方法の詳細については、WDK のマニュアルを参照してください。

**共同インストーラーを使用して DevCon と WinDbg のデバッグ**

1.  ハードウェア デバイスを接続します。

2.  キャンセル、**新しいハードウェアが見つかりました**ウィザード。

3.  WinDbg を開始します。

4.  選択**実行可能ファイルのオープン**WinDbg から**ファイル**メニュー。

5.  **実行可能ファイルのオープン** ダイアログ ボックスで、次の操作を行います。
    1.  ファイルの選択テキスト ボックスでは、DevCon ツール (Devcon.exe) を選択します。 これは、WDK のインストール フォルダーを参照し、サブディレクトリ ツール を開きし、サブディレクトリ devcon、コンピューターのプロセッサ アーキテクチャに一致するサブディレクトリを開きます開き選択します Devcon.exe。 1 回だけ Devcon.exe クリックし、キーを押してで実行されていない**オープン**します。
    2.  **引数**テキスト ボックスに、次のテキストを入力、 *INFFile*は、デバイスのインストール情報 (INF) ファイルのファイル名と*HardwareID*が、デバイスのハードウェア ID:

        ```text
        update INFFile HardwareID 
        ```

    3.  **開始ディレクトリ**テキスト ボックスに、デバイスのインストール パッケージへのパスを入力します。
    4.  **[開く]** をクリックします。

6.  デバッグ プロセスが開始され、DevCon、ドライバーをインストールする前に、WinDbg が DevCon プロセスが中断されます。

7.  読み込まれるときに、共同インストーラー プロセスを中断するデバッガーを構成します。 次のいずれかで、これを行うことができます。
    -   デバッガー コマンド ウィンドウで、 [ **sxe (例外の設定)** ](sx--sxd--sxe--sxi--sxn--sxr--sx---set-exceptions-.md)コマンドに続けて **%ld:** とし、ファイル拡張子を除く、共同インストーラーのファイル名。 ありません領域コロンの後に、次のコマンドを使用して、共同インストーラーの名前が mycoinst.dll の場合は。
        ```dbgcmd
        sxe ld:mycoinst 
        ```

    -   選択**イベント フィルター** WinDbg から**デバッグ**メニュー。 **イベント フィルター**ダイアログ ボックスで、**モジュールの読み込み**します。 **実行**、**有効です。** **続行**、**は処理されません。** をクリックして、**引数**ボタンをクリックし、テキスト ボックスにファイル拡張子を除く、共同インストーラーのファイル名を入力します (たとえば、"mycoinst"の入力 mycoinst.dll)。 クリックして**OK**順にクリックします**閉じる**します。

8.  実行を再開するには、F5 を押すか、入力、 **g (移動)** デバッガー コマンド ウィンドウでコマンド。

9.  共同インストーラーが読み込まれると、実行がデバッガーに中断されます。 この時点では、必要な追加のブレークポイントを設定できます。

### <a name="span-idlimitationsofthisprocedurespanspan-idlimitationsofthisprocedurespanlimitations-of-this-procedure"></a><span id="limitations_of_this_procedure"></span><span id="LIMITATIONS_OF_THIS_PROCEDURE"></span>このプロシージャの制限事項

場合によっては、DevCon デバイスのインストール パッケージを実行している可能性があります、PnP インストールの場合よりも若干異なる動作などのさまざまなセキュリティ トークンおよびため。 共同インストーラーの特定の問題をデバッグしようとすると、その DevCon が関係している場合に、この問題がレプリケートされないこと可能性があります。 したがって、この手法を使用する前に、デバッガーをアタッチ、PnP と DevCon シナリオの両方でこの問題があることを確認するのにことがなく、ドライバーをインストールするのに DevCon を使用する必要があります。

問題が消える DevCon のインストールが開始されるたびに場合、は、DevCon を使用することがなく、共同インストーラーをデバッグする必要があります。 これは、使用することの 1 つの方法、 [TList](tlist.md)ツールを **/m**オプションのどのプロセスが、共同インストーラー モジュールの読み込みと、そのプロセスにデバッガーをアタッチを決定します。

 

 





