---
title: タイム トラベル デバッグ - トレースの記録
description: このセクションでは、タイムトラベルトレースを記録する方法について説明します。
ms.date: 01/23/2020
ms.localizationpriority: medium
ms.openlocfilehash: 30d4e06410e2958e39e351af855776b21f3dc190
ms.sourcegitcommit: ee70846334ab6710ec0f9143e9f3a3754bc69f98
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/23/2020
ms.locfileid: "76706964"
---
#  <a name="time-travel-debugging---record-a-trace"></a>タイム トラベル デバッグ - トレースの記録

![時計を示す短いタイムトラベルロゴ](images/ttd-time-travel-debugging-logo.png)

このセクションでは、タイムトラベルデバッグ (TTD) トレースを記録する方法について説明します。 WinDbg プレビューでトレースを記録し、*実行可能ファイル (詳細) を起動*して*プロセスにアタッチ*するには、2つの方法があります。 

## <a name="launch-executable-advanced"></a>実行可能ファイルの起動 (詳細)

実行可能ファイルを起動して TTD トレースを記録するには、次の手順を実行します。

1. WinDbg Preview で、**ファイル** > **デバッグ開始** > **実行可能ファイルの起動 (詳細)** を選択します。

2. 記録するユーザーモードの実行可能ファイルへのパスを入力するか、 **[参照]** を選択して実行可能ファイルに移動します。 WinDbg Preview で [起動実行可能ファイル] メニューを操作する方法の詳細については、「 [Windbg preview-user mode session を開始する](windbg-user-mode-preview.md)」を参照してください。

    ![[起動実行可能ファイル (詳細)] 画面に [記録の開始] チェックボックスが表示されている WinDbg プレビューのスクリーンショット](images/ttd-windbgx-configure-recording.png)

3. 実行可能ファイルが起動されたときにトレースを記録するには、[**タイムトラベルによるプロセスの記録] デバッグ**ボックスをオンにします。

4. **[構成と記録]** を選択した場合は、トレースファイルの場所を構成できます。

    ![参照ボタンとパスが表示されている [記録の構成] ダイアログのスクリーンショット](images/ttd-start-recording-dialog.png)

5. [ **OK]** をクリックして実行可能ファイルを起動し、記録を開始します。

6. トレースが記録されていることを示す [記録] ダイアログが表示されます。

    ![[停止]、[デバッグ]、[キャンセル] オプションを示す TTD 記録ポップアップ](images/ttd-recording-pop-up-dialog.png)

7. 記録の詳細については、「記録[する方法](#HOWTORECORD)」を参照してください。

## <a name="attach-to-a-process"></a>プロセスへのアタッチ

プロセスにアタッチして TTD トレースを記録するには、次の手順を実行します。

1. WinDbg プレビューで、**ファイル** > **デバッグ開始** > **プロセスにアタッチ** の順番に選択します。

2. トレースするユーザーモードプロセスを選択します。 WinDbg プレビューで [*プロセスのアタッチ*] メニューを操作する方法の詳細については、「 [windbg preview-user Mode session を開始](windbg-user-mode-preview.md)する」を参照してください。

    ![記録の開始チェックボックスが表示されている WinDbg プレビューのスクリーンショット](images/ttd-start-recording-attach-to-process.png)


3. 実行可能ファイルが起動されたときにトレースを作成するには、[**タイムトラベルによるプロセスの記録] デバッグ**ボックスをオンにします。 

4. **[アタッチ]** をクリックして記録を開始します。

5. トレースが記録されていることを示す [記録] ダイアログが表示されます。

    ![[停止]、[デバッグ]、[キャンセル] オプションを示す TTD 記録ポップアップ](images/ttd-recording-pop-up-attach.png)

6. 記録の詳細については、「記録[する方法](#HOWTORECORD)」を参照してください。

## <a name="span-idhowtorecordspanspan-idhowtorecordspanhow-to-record"></a><span id="HOWTORECORD"></span><span id="howtorecord"></span>記録する方法

1. プロセスが記録されているので、ここでデバッグする問題を発生させる必要があります。 問題のあるファイルを開くか、アプリの特定のボタンをクリックして、目的のイベントを発生させることができます。 

2. [記録] ダイアログボックスが表示されている間、次のことができます。

    - **停止とデバッグ**-これを選択すると、記録が停止し、トレースファイルが作成され、トレースファイルが開きます。これにより、デバッグを開始できます。 
    - **[キャンセル]** : これを選択すると、記録が停止し、トレースファイルが作成されます。 トレースファイルは、後で開くことができます。 

3. 記録が完了したら、アプリを閉じるか、 **[停止] および [デバッグ**] をクリックします。

   > [!NOTE]
   > *停止とデバッグ*と*キャンセル*の両方で、関連付けられたプロセスが終了します。 
   >

4. 記録されているアプリケーションが終了すると、トレースファイルが閉じられ、ディスクに書き込まれます。 これは、プログラムがクラッシュした場合にも当てはまります。

5. トレースファイルを開くと、デバッガーによってトレースファイルのインデックスが自動的に作成されます。 インデックスを作成すると、より正確で高速なメモリ値の検索が可能になります。 このインデックス作成処理にかかる時間は、トレースファイルのサイズが大きいほど長くなります。

    ```dbgcmd
    ...
    00007ffc`61f789d4 c3              ret
    0:000> !index
    Indexed 1/1 keyframes
    Successfully created the index in 96ms.
    ```

   > [!NOTE]
   > キーフレームは、インデックス作成に使用されるトレース内の場所です。 キーフレームは自動的に生成されます。 大きいトレースには、より多くのキーフレームが含まれます。 トレースにインデックスを設定すると、キーフレームの数が表示されます。
   >

6. この時点で、トレースファイルの先頭に移動して、時間をさかのぼる準備ができています。

    > [!TIP]
    > ブレークポイントの使用は、特定のイベントでコードの実行を一時停止するための一般的な方法です。  TTD に固有で、トレースが記録された後にブレークポイントがヒットするまで、ブレークポイントを設定し、時間をさかのぼって戻すことができます。 問題が発生した後にプロセスの状態を確認する機能は、ブレークポイントの最適な場所を特定するために、追加のデバッグワークフローを有効にします。 過去にブレークポイントを使用する例については、「[タイムトラベルのデバッグ-サンプルアプリのチュートリアル](time-travel-debugging-walkthrough.md)」を参照してください。

## <a name="next-steps"></a>次のステップ

TTD トレースの記録が完了したので、トレースを再生するか、トレースファイルを使用できます。たとえば、同僚と共有できます。 詳細については、次のトピックを参照してください。

[タイムトラベルデバッグ-トレースを再生する](time-travel-debugging-replay.md)

[タイムトラベルデバッグ-トレースファイルの操作](time-travel-debugging-trace-file-information.md)

[タイムトラベルデバッグ-トラブルシューティング](time-travel-debugging-troubleshooting.md)

[タイムトラベルデバッグ-サンプルアプリのチュートリアル](time-travel-debugging-walkthrough.md)

## <a name="see-also"></a>関連項目

[タイムトラベルのデバッグ-概要](time-travel-debugging-overview.md)

