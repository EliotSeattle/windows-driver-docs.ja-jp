---
title: WIA ドライバーのプロセス外の COM オブジェクト
description: WIA ドライバーのプロセス外の COM オブジェクト
ms.assetid: 0b08652e-36ae-46f8-8915-7f2bb45df05c
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 24f0ff71301ac85c706fee138727ddb17aa526a2
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56536995"
---
# <a name="out-of-process-com-objects-for-wia-drivers"></a>WIA ドライバーのプロセス外の COM オブジェクト





ドライバーを呼び出す場合**CoCreatInstance** (Microsoft Windows SDK のドキュメントで説明) アウト プロセス コンポーネント、ドライバーのアクセスを許可する設定、コンポーネントに適切なアクセス許可がない限り、呼び出しが失敗します。

COM のセキュリティ モデルの詳細については、COM プログラミングの書籍やオンライン ドキュメントを参照してください。 簡単な説明を次に示します。

アウト プロセス COM コンポーネントに関連付けられているアクセス許可の 2 つの種類があります。

-   起動のアクセス許可

    起動のアクセス許可は、現在実行されていない場合は、COM コンポーネントを開始するためのアクセス許可を持っているユーザーを示します。 実行されていないローカル サーバーでは、コンポーネントが実装されている場合の呼び出しなど**CoCreateInstance** (呼び出し元がそれを開始する権限を想定)、ローカル サーバーを起動しようとしました。 com コンポーネントの結果。

-   アクセス許可

    アクセスのアクセス許可は、これらの COM コンポーネントを COM インターフェイスを取得するには、そのプロセスへの呼び出しを許可するユーザーを示します。

    起動のアクセス許可とアクセス許可は一致する必要はありません。 たとえば、起動アクセス許可を管理者にのみ、設定できますが、対話型ユーザーおよび管理者にアクセス許可を設定できます。 または、管理者が、COM サーバーを起動する権限を付与する可能性がありますが、通常のユーザーが、コンポーネントを使用して、COM サーバーが既に実行されている場合のみでしょう。

コンポーネントの下の適切な場所に、COM サーバーの起動とアクセスのアクセス許可を格納するをお勧め**AppId**レジストリ サブキー。 これにより、管理者がコンポーネント サービス管理ツールを使用して、必要な場合に、これらのアクセス許可を変更できます。 実行時にそれらのアクセス許可を使用して、COM サーバーを作成するを呼び出すことを確認する**CoInitializeSecurity** (Windows SDK のドキュメントで説明) と、EOAC\_APPID フラグを渡して、コンポーネントの**AppId**します。 これにより、COM にコンポーネントの移動を**AppId**サブキーのレジストリでは、アクセス許可設定を使用する、 **AccessPermission**と**LaunchPermission**エントリ。

 

 




