---
title: WIA マイクロドライバーの作成
description: WIA マイクロドライバーの作成
ms.assetid: 4f453569-d768-47fb-9b70-ebb51e303cf0
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 41829f064a0e55b8d6d8976c7bb438309ff50e43
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72840869"
---
# <a name="creating-a-wia-microdriver"></a>WIA マイクロドライバーの作成





多くのフラットベッドスキャナーは、同様の方法で制御されます。 モデル間の一般的な動作は、WIA フラット化ドライバーと呼ばれる Microsoft が提供する一般的なドライバーに抽象化されています。 このドライバーは、必要なデバイス固有の動作を実装する、スキャナーベンダーによって提供されるマイクロドライバーと呼ばれる DLL を呼び出します。 WIA フラット化ドライバーと microdriver を、WIA ミニドライバーとして使用することができます。 マイクロドライバを使用する利点は、実装とデバッグが非常に簡単であることです。 すべてのスキャナーがマイクロドライバーでサポートされるとは限りません。 これは、(両面印刷装置やその他の高度な機能を持たない) 単純なデバイスや、基本機能ドライバーが必要な場合に最適です。

このセクションで説明されている WIA マイクロ**ドライバー  は**、wia 1.0 です。 現時点では、WIA 2.0 に対応する WIA マイクロドライバモデルはありません。 Wia 2.0 (Windows Vista 以降) をサポートする Windows バージョンが搭載されているコンピューターで実行する WIA マイクロドライバーを開発する場合、この WIA マイクロドライバーは他の WIA 1.0 デバイスと同様に動作し、wia 1.0 互換モードでは WIA 2.0 アプリケーションによって使用されます。

 

次の図は、WIA マイクロドライバアーキテクチャのコンポーネントを示しています。

![wia マイクロドライバアーキテクチャのコンポーネントを示す図](images/art-6.png)

WIA フラットドライブは、マイクロドライバで WIA マイクロドライバ関数を呼び出すことによって、WIA サービスからの要求を処理します。 マイクロドライバーは、これらの各関数を実装する必要があります。 スキャンウィンドウや解像度などのスキャンパラメーターを格納して通信するために、 [**Scaninfo**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wiamicro/ns-wiamicro-_scaninfo)構造体がマイクロドライバーに渡されます。 WIA フラット化ドライバーは、SCANINFO 構造体から値を読み取りますが、書き込みは行われません。 これは、SCANINFO メンバーを設定するマイクロドライバの役割です。

マイクロドライバーはスキャンのパラメーターを格納しないようにする必要がありますが、 [**Scaninfo**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wiamicro/ns-wiamicro-_scaninfo)構造体に格納されている値に依存している必要があります。 これは、デバイスへの複数のアプリケーションアクセスをサポートするために重要です。 2つのアプリケーションが同時に同じデバイスでスキャンを設定している場合、実行中のマイクロドライバーのコピーは1つだけです。 このような状況では、マイクロドライバは、デバイスにアクセスしようとしているアプリケーションに応じて、2つの異なる SCANINFO 構造のいずれかで呼び出されます。

 

 




