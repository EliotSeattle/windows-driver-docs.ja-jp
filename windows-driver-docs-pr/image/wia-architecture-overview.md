---
title: WIA アーキテクチャの概要
description: WIA アーキテクチャの概要
ms.assetid: 47f44042-f22b-4ee0-88c5-fc977bf13791
ms.date: 07/18/2018
ms.localizationpriority: medium
ms.openlocfilehash: 86b0d7f282e233c07bc1b7944f114e59eeabdacf
ms.sourcegitcommit: fb7d95c7a5d47860918cd3602efdd33b69dcf2da
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/25/2019
ms.locfileid: "67375364"
---
# <a name="wia-architecture-overview"></a>WIA アーキテクチャの概要

WIA が、クライアント アプリケーションの堅牢な動作を確認するコンポーネント オブジェクト モデル (COM) アウト プロセス サーバーとして実装されます。 

WIA が 3 つの主要なコンポーネント: WIA サービス、WIA ドライバー サービス ライブラリ、および仕入先のユーザー モード ドライバー。

-   WIA サービスで、イメージング デバイスを列挙します、デバイスのプロパティを取得します、デバイスの場合、イベントを設定、およびデバイス オブジェクトを作成します。

-   WIA ドライバー サービス ライブラリでは、独立したデバイスではすべてのサービスを実装します。

-   仕入先のユーザー モード ドライバーでは、WIA プロパティやコマンドを特定のデバイスにマップします。 WIA 仕入先のユーザー モード ドライバーの 2 種類あります。

    -   ミニドライバー:これは、ドライバーのベンダーの最も一般的な種類です。 これは、WIA ミニドライバー インターフェイスを実装する COM オブジェクトです。 仕入先は、すべての WIA 機能をこの種類のドライバーの機能の利用できます。
    
    -   Microdriver:このドライバーは、ミニドライバーよりもはるかに制限し、そのため、開発が簡単にします。 基本的なスキャナーのデバイスの主に使用されます。 このドライバーは、COM オブジェクトがありません。いくつかの関数をエクスポートする DLL になります。 Microdrivers は、デバイスのカメラを使用できません。

次の図は、WIA アーキテクチャを示しています。

![wia コンポーネントを示す図](images/art-1.png)

### <a name="imaging-applications"></a>イメージング アプリケーション

イメージング アプリケーションは、ミニドライバーと直接通信しないが、WIA アプリケーション プログラミング インターフェイス (API) をイメージにアクセスし、WIA デバイスからデータを取得を通じて WIA サービスと通信します。 これらのアプリケーションには、共通のシステム提供のユーザー インターフェイスまたはベンダーから提供されたユーザー インターフェイスを使用できます。 イメージング アプリケーションの WIA API の詳細については、Microsoft Windows SDK のドキュメントを参照してください。

### <a name="wia-service"></a>WIA サービス

WIA サービスは、イメージング アプリケーションと WIA ミニドライバーと通信するシステム提供のコンポーネントです。 WIA サービスは、アプリケーションから別のプロセスで、WIA ミニドライバーと同じプロセスで実行します。 WIA デバイス ドライバー インターフェイス (DDI) を介してさらに適切なミニドライバーに要求するように指示する WIA サービスにそのデバイスの要求をアプリケーションに指示します。

### <a name="wia-driver-services-library"></a>WIA ドライバー サービス ライブラリ

WIA ドライバー サービス ライブラリは、WIA ミニドライバーのヘルパー関数を提供するシステム提供のコンポーネントです。 ミニドライバーは、次のタスクを実行するヘルパー関数を呼び出すことができます。

-   WIA ドライバーの項目のツリーを初期化します。

-   読み取り、書き込み、およびデバイスのプロパティを検証します。

-   データを転送します。

また、ミニドライバーを実行できますなどのタスク自体。 ヘルパー関数を利用して個々 のソリューションを柔軟に構築しながら、開発時と、WIA ミニドライバーのサイズを削減できます。

### <a name="wia-user-mode-minidrivers"></a>WIA User-mode ミニドライバー

WIA ミニドライバーは、ベンダーから提供された、WIA プロパティの変更と、イメージング デバイスにコマンドを直接ユーザー モード コンポーネント。 ミニドライバーは、ミニドライバーとの通信に WIA サービスによって呼び出される WIA DDI を実装します。

WIA ミニドライバーは、標準の WIA ミニドライバー インターフェイスを実装します。 ミニドライバーは、USB ドライバーなど、標準の Microsoft Windows カーネル モード ドライバーを使用してイメージング デバイスと通信します。 ミニドライバーは、呼び出すことによって、カーネル モード ドライバーと通信する、 [ **CreateFile**](https://docs.microsoft.com/windows/desktop/api/fileapi/nf-fileapi-createfilea)、 **ReadFile**、 **WriteFile**、および**DeviceIoControl** (Microsoft Windows SDK のドキュメントで説明) の Win32 関数。

イメージングのアプリケーションは、WIA ミニドライバーを直接呼び出すにことはできません。 ドライバーを直接呼び出す WIA サービスのみが許可されます。

### <a name="kernel-io-drivers"></a>カーネル I/O ドライバー

静止画像のカーネル モード ドライバーは、静止画像デバイスからデータを提供するシステム提供または IHV 提供のコンポーネントです。 カーネル モードの静止イメージ ドライバーでは、bus 固有です。

WDM ベースであり、Microsoft は、カーネル モードは引き続き、USB、SCSI、および IEEE 1394 のバスのドライバーをイメージします。 参照してください[静止画像デバイスへのアクセスのカーネル モードのドライバー](accessing-kernel-mode-drivers-for-still-image-devices.md)詳細についてはします。

仕入先は、カーネル モードの静止イメージ ドライバーを提供する必要があります*のみ*イメージング デバイスは、Microsoft 提供のカーネル モードと互換性がない場合は、I/O ドライバー。

 
