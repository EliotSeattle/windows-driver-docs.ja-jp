---
title: 書き込みキャッシュのプロパティのクエリ
description: 書き込みキャッシュのプロパティのクエリ
ms.assetid: 80b7c366-3b54-4dae-8ac7-63caaa1767f9
keywords:
- ストレージ ドライバー WDK、書き込みキャッシュ
- WDK の記憶域のキャッシュを書き込み
- WDK の記憶域の書き戻し
- WDK の記憶域を使用して書き込み
- WDK のストレージ同期のキャッシュのサポート
- バッテリ バックアップ WDK ストレージ
- WDK の記憶域のキャッシュ
- 書き込みキャッシュのクエリを実行します。
- ライト スルー要求 WDK ストレージ
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 6a5052b603544e1374d7329aede8b78052dcee27
ms.sourcegitcommit: fb7d95c7a5d47860918cd3602efdd33b69dcf2da
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/25/2019
ms.locfileid: "67383150"
---
# <a name="querying-for-the-write-cache-property"></a>書き込みキャッシュのプロパティのクエリ


記憶装置は、多くの場合、ディスク プラッターなどの不揮発性のメディアにデータを書き込む前に書き込みキャッシュ内のデータをバッファーします。 この種類のバッファーにはデバイスのパフォーマンスが向上しますが、データの整合性も低くなります。 書き込みキャッシュでは、バッテリ バックアップすることはありません、電源障害でキャッシュされたデータの損失が発生することができます。

データ損失の問題の 1 つの救済手段では、(SCSI デバイスで同期キャッシュの SCSI コマンド) で書き込みキャッシュをフラッシュします。 ただし、負荷の高い操作では、書き込みキャッシュがフラッシュと、パフォーマンスを大幅に低下できる場合は、頻繁に実行します。 多くのストレージ デバイスを許可する、書き込みキャッシュをフラッシュするのではなく*ライト スルー*要求。 ライト スルー要求は、書き込みキャッシュをバイパスし、メディアに直接データを送信します。

たとえば、データベース アプリケーションでは、ライト スルー要求を使用して、トランザクション ログが、メディアにアクセスし、ファイル システム ドライバーは、ライト スルー要求を使用して、ファイル システム メタデータがメディアに達したことを確認することを確認します。

ただし、書き込みキャッシュがあるすべての記憶装置がサポート要求ライト スルーまたはキャッシュの同期します。一部のデバイスは、バイパスまたはバッテリ バックアップ システム電源障害時にデータが破損しないようにしているために、念のためキャッシュ データをフラッシュする必要はありません。 効果的な使用を行えるようにする前に、アプリケーションやドライバーによって、デバイスの書き込みキャッシュのプロパティに関する情報する必要があります。

Windows Vista で使用することができます、 [ **IOCTL\_ストレージ\_クエリ\_プロパティ**](https://docs.microsoft.com/windows-hardware/drivers/ddi/content/ntddstor/ni-ntddstor-ioctl_storage_query_property)の要求、 **StorageDeviceWriteCacheProperty**書き込みキャッシュのプロパティのデバイスの特性の書き込みキャッシュを指定するための記憶域クラス ドライバーを照会するプロパティの識別子。 書き込みキャッシュのプロパティには、デバイスのキャッシュの機能に関する次の情報が含まれています。

-   *書き込みキャッシュのプレゼンス*します。 書き込みキャッシュのプロパティは、デバイスで書き込みキャッシュを持つかどうかを指定します。

-   *書き込みキャッシュの種類*します。 書き込みキャッシュの 2 つの主な種類があります:*書き戻す*と*を使用して書き込み*します。 ライトバック キャッシュの場合は、デバイスは、どうしても必要になるまで、不揮発性のメディアにキャッシュ データをコピーしません。 この操作では、書き込み操作のパフォーマンスが向上します。 ライト スルー キャッシュでは、デバイスは、データをキャッシュし、並列でメディアを書き込みます。 これが、書き込みのパフォーマンスを向上しませんが、後続の読み取り操作を高速化により、します。

    ライト スルーを混同しないでください*キャッシュ*ライト スルーで*要求*します。 ライト スルー要求は、任意の種類のデバイスは、ライト スルー要求をサポートしている場合、ライトバック キャッシュを含むキャッシュで使用できます。 たとえば、ターゲットの SCSI デバイスの書き戻しのキャッシュを使用します。 デバイスは、ライト スルー要求をサポートする場合、イニシエーターは、書き込みコマンドのコマンド記述子ブロック (CDB) で force unit access (FUA) のビットを設定して、書き込みキャッシュをバイパスできます。

-   *キャッシュのサポートを同期*します。 書き込みキャッシュのプロパティは、デバイスが、SCSI 同期キャッシュをサポートしているかどうかを示すコマンド、または同等のコマンドをその他のバスに接続します。

-   *バッテリ バックアップ*します。 書き込みキャッシュのプロパティは、デバイスに電源障害時にキャッシュ データの整合性を保護するバッテリ バックアップがあるかどうかを示します。

書き込みキャッシュのプロパティを報告する情報の詳細については、次を参照してください。 [**ストレージ\_書き込み\_キャッシュ\_プロパティ**](https://docs.microsoft.com/windows-hardware/drivers/ddi/content/ntddstor/ns-ntddstor-_storage_write_cache_property)します。

書き込みキャッシュのプロパティのメカニズムがなければ (つまり、IOCTL を使用して\_ストレージ\_クエリ\_プロパティ要求と**StorageDeviceWriteCacheProperty**プロパティの識別子)、アプリケーションドライバーが別の一連のすべてのバスのコマンドによるデバイスの書き込みキャッシュの特性を照会する必要があります。 たとえば、ターゲット デバイスは、IEEE 1394 バスに接続し、削減ブロックのコマンド (RBC) プロトコルを使用して場合に、イニシエーターは、書き込みキャッシュが有効になっているかどうかを決定する、デバイスのモード データのページ 6 を取得する必要があります。 ターゲット デバイスが SCSI 準拠の場合は、イニシエーターがモード データの 8 ページを取得する必要があります。 プロパティの書き込みキャッシュ メカニズムでは、イニシエーターからこれらの操作の詳細を非表示にし、異なるバスでは、同じストレージ デバイスの書き込みキャッシュの特性をクエリする方法とを提供します。

書き込みキャッシュのプロパティのメカニズムでは、(これらのデバイスを照会するための標準的な技法がない) ために、RAID デバイスのサポートされていないかのフラッシュ メモリ デバイス。

書き込みキャッシュのプロパティは、Windows の 64 ビット バージョンでサポートされます。

 

 




