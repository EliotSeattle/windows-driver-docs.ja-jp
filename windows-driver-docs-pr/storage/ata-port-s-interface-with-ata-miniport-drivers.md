---
title: ATA ポートと ATA ミニポート ドライバーとのインターフェイス
description: ATA ポートと ATA ミニポート ドライバーとのインターフェイス
ms.assetid: c3a9b862-8d6e-4ad7-8061-178b053b820c
keywords:
- ATA ポート ドライバー WDK、ミニポート ドライバー
- ATA のミニポート ドライバー WDK
- ミニポート ドライバー WDK ストレージ、ATA のミニポート ドライバー
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 6acd4090899140ccc9e8a9b9882bb1efac72434e
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56578281"
---
# <a name="ata-ports-interface-with-ata-miniport-drivers"></a>ATA ポートと ATA ミニポート ドライバーとのインターフェイス


## <span id="ddk_ata_ports_interface_with_ata_minport_drivers_kg"></span><span id="DDK_ATA_PORTS_INTERFACE_WITH_ATA_MINPORT_DRIVERS_KG"></span>


**注**ATA ポートはドライバーと ATA ミニポート ドライバー モデルが変更されるか利用今後します。 代わりに、使用をお勧め、 [Storport ドライバー](https://msdn.microsoft.com/windows/hardware/drivers/storage/storport-driver)と[Storport ミニポート](https://msdn.microsoft.com/windows/hardware/drivers/storage/storport-miniport-drivers)ドライバー モデル。


Windows Vista 以降のバージョンの Windows IDE アーキテクチャでは、システム提供の 4 つの IDE ドライバーがあります。

-   ATA ポート ドライバー (*Ataport.sys*) コント ローラーのチャネルを管理します。

-   既定の ATA ミニポート ドライバー (*Atapi.sys*)

-   コント ローラーのドライバー (*Pciidex.sys*)

-   既定のコント ローラー ミニドライバー (*問題は、Pciide.sys*)

ATA ポート ドライバーと既定のミニポート ドライバーは、Windows Vista の新機能です。 コント ローラーのドライバーと既定のコント ローラー ドライバーは、Windows Vista の新機能ではありません。

Microsoft Windows オペレーティング システムを Windows Vista より前のバージョンでは、ベンダーが既定のコント ローラー ミニドライバーを置き換えることができます (*問題は、Pciide.sys*) 特定のコント ローラーにカスタマイズされているさまざまなミニドライバーにします。 Windows オペレーティング システムを Windows Vista より前の IDE スタックの構造の詳細については、次を参照してください。[ポートの IDE ドライバー](ide-port-driver.md)します。

Windows Vista および以降のバージョンの Windows IDE アーキテクチャに ATA ポート ドライバーを組み込むことでは、ベンダーを置き換えることができます*問題は、Pciide.sys*ベンダーから提供された ATA ミニポート ドライバーを使用しています。 このドライバーは、コント ローラー ミニドライバーより多くの機能を含めることができます。

ATA のミニポート ドライバーでは 2 つの関数を実行できる可能性があります。 2 つのインターフェイスをサポートすることによって、コント ローラー ミニドライバーとチャネルのミニポート ドライバーの両方として使用できます。

-   コント ローラーのインターフェイス

    このインターフェイスが必要です。 このインターフェイスを実装する ATA のミニポート ドライバーでは、コント ローラーのミニドライバーの関数を実行します。 このインターフェイスにより、ATA のミニポート ドライバー、コント ローラーのチャネルの列挙を制御して、タイミング モードなどの IDE コント ローラーの特定の特性を構成します。

-   チャネル インターフェイス

    このインターフェイスは省略可能です。 このインターフェイスを実装する ATA のミニポート ドライバーでは、コント ローラーのミニドライバーの機能とチャネルのミニポート ドライバーの機能の両方を実行します。 このようなドライバーは、I/O チャネルを管理するミニドライバー ルーチンにフック ATA ポート ドライバーを提供します。 システムで既定のチャネルのミニポート ドライバーを使用して、チャネルの操作を処理する ATA のミニポート ドライバーがこのインターフェイスを実装していない場合 (*Atapi.sys*)。

これら 2 つのインターフェイスを分離することにより、基になるハードウェアの構成に準拠している、チャネルは、並列で運用されているときにパフォーマンスが向上し、ミニポート ドライバーのコードを簡単に開発および管理します。 さらに、インターフェイス、分離して、各チャネルはチャネルごとにリセットします bus などの操作を行うポート ドライバーを有効するチャネルのミニポート ドライバーの独自インスタンスを持つことができます。

次の図は、のみ、コント ローラーのインターフェイスを実装する ATA ミニポート ドライバーを示します。

![コント ローラーのインターフェイスを実装するベンダーのミニポート ドライバー](images/ataport1.png)

ATA のミニポート ドライバーでは、コント ローラーのインターフェイスを初期化後は、ポート ドライバー呼び出しミニポート ドライバーのルーチン、コント ローラーの特定の特性を構成するが、ATA のミニポート ドライバーでは、デバイスまたは I/O コント ローラーは処理しません。 すべての I/O 要求は、ATA ポート ドライバーと既定のチャネルのミニポート ドライバーによって処理されます。

ほとんどの場合、この種のベンダーのミニドライバーを実装する必要はありません。 既定のコント ローラー ミニドライバー (*問題は、Pciide.sys*) ほとんどのコント ローラーのハードウェアを管理するだけで十分です。

次の図は、チャネルのドライバーとコント ローラーのドライバーの両方としてベンダーから提供されたミニポート ドライバーが機能する構成を示します。

![両方のコント ローラーおよびチャネル インターフェイスを実装するベンダーのミニポート ドライバー](images/ataport2.png)

チャネル インターフェイスを実装する ATA ミニポート ドライバー、コント ローラー用ドライバーを管理ルーチンをコント ローラーとチャネルを公開します (*Pciidex.sys*)。 パフォーマンス上の理由から、 *Pciidex.sys* ATA ポート ドライバーに渡しますチャネル管理のエントリ ポイントし、ATA ポート ドライバー呼び出し ATA ミニポート ドライバーのチャネルの管理ルーチンの仲介せずに直接*Pciidex.sys*します。 *Pciidex.sys*ドライバーは ATA ミニポート ドライバーのコント ローラーのルーチンを呼び出します。

 

 


