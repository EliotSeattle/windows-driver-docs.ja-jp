---
title: ユーザー モード ディスプレイ ドライバーのスレッド モデル
description: ユーザー モード ディスプレイ ドライバーのスレッド モデル
ms.assetid: 43bb6032-5f34-434b-8404-aef6a424a2ee
keywords:
- スレッド WDK 表示、ユーザーモードドライバー
- 同期 WDK ディスプレイ、ユーザーモードドライバー
- ユーザーモード表示ドライバー WDK Windows Vista、同期
- ユーザーモード表示ドライバー WDK Windows Vista、スレッド処理
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 4cfc28a1a9e19b3613c69cd8e5c7e8f45fbf81cd
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72825486"
---
# <a name="threading-model-of-user-mode-display-driver"></a>ユーザー モード ディスプレイ ドライバーのスレッド モデル


## <span id="ddk_thread_model_of_user_mode_display_driver_gg"></span><span id="DDK_THREAD_MODEL_OF_USER_MODE_DISPLAY_DRIVER_GG"></span>


ユーザーモードの表示ドライバーは、同時に複数のプロセスに読み込まれません。ユーザーモードの表示ドライバー DLL は、各プロセスのアドレス空間に個別に読み込まれます。 同時に、複数のスレッドをユーザーモードの表示ドライバーで同時に実行することもできます。 ただし、ユーザーモード表示ドライバーで実行されている各スレッドは、別のディスプレイデバイスにアクセスする必要があります。これは、ユーザーモードの表示ドライバーの[**CreateDevice**](https://docs.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_createdevice)関数の呼び出しによって作成されます。 次に、例を示します。

-   2つの Microsoft Direct3D デバイスを作成するアプリケーションは、これらのデバイスに個別にアクセスする2つのスレッドを持つことができます。

-   アプリケーションでは、2つの異なるスレッド (Microsoft DirectX 9.0 Direct3D ランタイムによって作成された Direct3D デバイス) と、DirectX 5.0 ランタイムによって作成された Microsoft DirectDraw デバイスを使用できます。

   同じディスプレイデバイスを使用している複数のスレッドが、ユーザーモードの表示ドライバーで同時に実行されない場合があることに**注意**してください。

 

Direct3D デバイスは独立しており、各デバイスの状態とリソースは他のデバイスに影響を与えないため、ディスプレイミニポートドライバーでは、ユーザーモードの表示ドライバーでグローバルデータ構造を使用する必要はありません。 ユーザーモードの表示ドライバーでグローバルなクロスデバイスデータ構造 (たとえば、カスタムシステムメモリヒープマネージャー) を維持する必要がある場合は、独自のメカニズムを使用してアクセスを調停する必要があります。 このようなグローバルデータ構造では、ドライバーが管理することをお勧めしません。 Direct3D ランタイムは、リソースにアクセスする必要があるユーザーモードディスプレイデバイスごとに、共有リソースの独立した "ビュー" を開きます。そのため、プロセス間またはデバイス間のリソースは、単一のプロセスであるリソースとは異なる方法で処理されないようにする必要があります。デバイスの使用。 有効期間とその他の管理は、DirectX グラフィックスカーネルサブシステム (*Dxgkrnl*) によって処理されます。

マルチプロセッサコンピューターでは、Direct3D ランタイムはメインアプリケーションスレッドからではなく、ワーカースレッドからユーザーモードの表示ドライバーを呼び出すことがあります。 このマルチプロセッサの最適化は、ユーザーモードの表示ドライバーに対して透過的です。 ランタイムがマルチプロセッサの最適化を使用する場合でも、特定のデバイスを参照する1つのスレッドだけが特定の時点でドライバー内で実行されるようになります。

 

 





