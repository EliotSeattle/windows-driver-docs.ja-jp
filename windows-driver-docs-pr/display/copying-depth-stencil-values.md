---
title: 深度ステンシル値のコピー
description: 深度ステンシル値のコピー
ms.assetid: b83d4e6d-5645-49ab-bbb0-c694f1410cba
keywords:
- ユーザーモード表示ドライバー WDK Windows Vista、深度ステンシル値のコピー
- 深度ステンシルの値をコピーしています
- 深度-ステンシル値 WDK 表示
- ステンシル値 WDK 表示
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 056b799928e6b6c1b4326a1c0bec463d76626232
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72839033"
---
# <a name="copying-depth-stencil-values"></a>深度ステンシル値のコピー


Microsoft Direct3D ランタイムは、ユーザーモードの表示ドライバーの[**Blt**](https://docs.microsoft.com/windows-hardware/drivers/ddi/d3dumddi/nc-d3dumddi-pfnd3dddi_blt)関数を呼び出して、深度ステンシルの値をビデオメモリからシステムメモリにコピーします。その逆も同様です。 ドライバーとハードウェアは、すべてのドライバーでサポートされている不透明な深度ステンシル形式 (つまり、 [**D3DDDIFORMAT**](https://docs.microsoft.com/windows-hardware/drivers/ddi/d3dukmdt/ne-d3dukmdt-_d3dddiformat)列挙型で定義されているすべての形式 (D3DDDIFMT\_D\*のロック可能な\_を除く) をに変換する必要があります。またはから、次のいずれかの形式になります。

-   D3DDDIFMT\_D16\_ロック可能

-   D3DDDIFMT\_Vfpv3-d32\_ロック可能

-   D3DDDIFMT\_D32F\_ロック可能

-   D3DDDIFMT\_S8\_ロック可能

ドライバーは、ソース形式に存在するが、変換先の形式では存在しないチャネル (深度またはステンシル) を破棄します。 共通のチャネルの種類を共有しない深度ステンシル間のコピーは、ランタイムでは許可されません。

ドライバーはまず、ソースの深さの値を32ビットの符号なし整数値に変換した後、32ビットの符号なし整数値から変換先の表現に変換します。 これらの変換には、次の規則が適用されます。

-   ソースの深さの値が浮動小数点値の場合は、\[0, 1\] にクランプされ、結果には \_MAX\_UINT が乗算されます。

-   変換元が整数で、変換先が精度が低い整数の場合、右端の余分なビットが削除されます。

-   ソースが整数で、変換先がより精度の高い整数の場合、右端のビットが最上位ビットからレプリケートされます。

-   変換元が整数で、変換先が浮動小数点値の場合、32ビット整数は浮動小数点値に変換され、結果は \_MAX\_UINT で除算されます。

このドライバーでは、一様でない分散深度値に特別な処理を行う必要はありません。

ドライバーは、ソースステンシル値を8ビット整数に拡張します (つまり、ドライバーは、ソースステンシル値を左側にゼロを埋め込みます)。 変換先の表現で精度が低い場合、ドライバーは変換を実行する最上位ビットを破棄する必要があります。

ユーザーモード表示ドライバーは、任意のサブ四角形の深度ステンシルコピーをサポートする必要があります。 ただし、深度ステンシルのコピー中にミラー、ストレッチ、またはカラーキー操作を実行するためにドライバーは必要ありません。 ポイントサンプリングは、深度ステンシルのコピー中に暗黙的に要求されます。

 

 





