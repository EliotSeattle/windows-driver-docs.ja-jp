---
title: メモリ セグメントを使用して GPU アドレス スペースを表す
description: メモリ セグメントを使用して GPU アドレス スペースを表す
ms.assetid: 5ff23d53-0860-44fa-8ce1-c34aa22b8730
keywords:
- メモリセグメントの WDK 表示、メモリセグメントについて
- 非表示のビデオメモリの WDK ディスプレイ
- video memory manager WDK ディスプレイ
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 8a9430586b11f180a63f6e79abf86d4b10ef5a8e
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72829255"
---
# <a name="using-memory-segments-to-describe-the-gpu-address-space"></a>メモリ セグメントを使用して GPU アドレス スペースを表す


## <span id="ddk_using_memory_segments_to_describe_the_gpu_address_space_gg"></span><span id="DDK_USING_MEMORY_SEGMENTS_TO_DESCRIBE_THE_GPU_ADDRESS_SPACE_GG"></span>


ビデオメモリマネージャーが GPU のアドレス空間を管理できるようにするには、ディスプレイミニポートドライバーで、メモリセグメントを使用して、ビデオメモリマネージャーに対して GPU のアドレス空間を記述する必要があります。 ディスプレイミニポートドライバーは、ビデオメモリリソースを一般化して仮想化するためのメモリセグメントを作成します。 ドライバーは、ハードウェアがサポートするメモリの種類 (たとえば、フレームバッファーメモリやシステムメモリアパーチャ) に応じてメモリセグメントを構成できます。

ドライバーの初期化中に、ドライバーは、ビデオメモリマネージャーでメモリリソースを管理する方法を説明するセグメントの種類の一覧を返す必要があります。 ドライバーは、サポートするセグメントの種類の数を指定し、 [**DxgkDdiQueryAdapterInfo**](https://docs.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/nc-d3dkmddi-dxgkddi_queryadapterinfo)関数の呼び出しに応答することによって、各セグメントの種類を記述します。 ドライバーは、 [**DXGK\_SEGMENTDESCRIPTOR**](https://docs.microsoft.com/windows-hardware/drivers/ddi/d3dkmddi/ns-d3dkmddi-_dxgk_segmentdescriptor)構造体を使用して各セグメントを記述します。 詳細については、「[メモリセグメントの使用の初期化](initializing-use-of-memory-segments.md)」を参照してください。

その後、セグメントの数と種類は変更されません。 ビデオメモリマネージャーでは、各プロセスが特定のセグメント内のリソースを公平に共有していることが保証されます。 ビデオメモリマネージャーはすべてのセグメントを個別に管理し、セグメントは重複しません。 そのため、ビデオメモリマネージャーは、アプリケーションが現在別のセグメントから保持しているリソースの量に関係なく、1つのセグメントからアプリケーションに公平な量のビデオメモリリソースを割り当てます。

ドライバーは、セグメント識別子を各メモリセグメントに割り当てます。 その後、ビデオメモリマネージャーがビデオリソースの割り当てを作成し、それらのリソースを表示するように要求すると、ドライバーは、要求をサポートするセグメントを識別し、ドライバーがビデオメモリマネージャーに優先するセグメントを順番に指定します。使用. 詳細については、「[割り当てを作成するときのセグメントの指定](specifying-segments-when-creating-allocations.md)」を参照してください。

このドライバーでは、メモリセグメント内の GPU で使用可能なすべてのビデオメモリリソースを指定する必要はありません。ただし、ドライバーは、システム上で実行されているすべてのプロセスでビデオメモリマネージャーが管理するすべてのメモリリソースを指定する必要があります。 たとえば、固定関数パイプラインを実装する頂点シェーダーマイクロコードは、GPU アドレス空間に存在することができますが、すべてのプロセスでマイクロコードが常に使用可能であるため、ビデオメモリマネージャーによって管理される (つまり、セグメントの一部ではない) メモリの外部に存在することがあります。とは、プロセス間の競合の原因にはなりません。 ただし、ビデオメモリマネージャーでは、ドライバーのメモリセグメントの1つから、頂点バッファー、テクスチャ、レンダーターゲット、アプリケーション固有のシェーダーコードなどのビデオメモリリソースを割り当てる必要があります。これは、リソースの種類は、プロセス.

次の図は、ドライバーが GPU アドレス空間からメモリセグメントを構成する方法を示しています。

![gpu アドレス空間をセグメントに分割する方法を示す図](images/memseg.png)

  **メモ**ビデオメモリマネージャーに表示されていないビデオメモリをユーザー領域にマップしたり、特定のプロセスでのみ使用できるようにしたりすることはできません。 これを行うには、システム上で実行されているすべてのプロセスがすべてのメモリにアクセスできる必要がある、仮想メモリの基本的なルールを解除します。

 

 

 





