---
title: コントローラー オブジェクトの概要
description: コントローラー オブジェクトの概要
ms.assetid: a46732a7-1e60-41d5-96e9-d5284c000af1
keywords:
- コント ローラーのオブジェクトについて、コント ローラー オブジェクトの WDK カーネル
- ControllerControl ルーチンについての ControllerControl ルーチン
- オーバー ラップ I/O WDK カーネル
- 重複 I/O の WDK カーネル
ms.date: 06/16/2017
ms.localizationpriority: medium
ms.openlocfilehash: b949b319fd2bd2e9c7307be4f733fbe1f8f87458
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63341060"
---
# <a name="introduction-to-controller-objects"></a>コントローラー オブジェクトの概要





その名前からわかるように、コント ローラー オブジェクトは通常、物理デバイスのコント ローラーを接続されているデバイスを表します。 一連の物理的なコント ローラーによって調整類似するデバイスの WDM 最も低いレベル以外のドライバーでは、コント ローラー オブジェクトを作成でき、接続されているデバイスの I/O 操作を同期に使用することができます。 ドライバーの実装を[ *ControllerControl* ](https://msdn.microsoft.com/library/windows/hardware/ff542049)ルーチンとコント ローラーのオブジェクトを呼び出し、I/O マネージャーのルーチンをサポートします。

**注**   WDM ドライバーでは、コント ローラー オブジェクトの使用はサポートされていません。

 

一般に、ドライバーは、次の条件を保持している場合、接続されたデバイスへの操作を同期するのにコント ローラーのオブジェクトを使用します。

-   コント ローラーを実行しない長時間操作を中断することがなくので、ドライバーはデバイス専用のスレッドを作成またはシステム ワーカー スレッドを使用する必要はありません。

-   コント ローラーに接続されているデバイスは似ています。 つまりはまったく別の物理プロパティまたは、キーボードと補助デバイス コント ローラーに接続することができます、キーボードとマウス デバイスなどの運用機能を持つデバイス。

-   ドライバーはモノリシック設計されていますデバイスのコント ローラーに対する単一レイヤーと、ポート上に構築された (接続されているデバイス) の 1 つまたは複数のクラス ドライバー (コント ローラー) のポート ドライバーとして設計されているのではなく、物理デバイスを接続。ドライバー。

I/O チャネルでのデバイス ドライバーと一連の論理デバイス オブジェクトもオブジェクトを使用して、コント ローラーのようなデバイスのチャネル間の I/O 操作を同期します。

コント ローラー オブジェクトは、名前を持たない、I/O 要求のターゲットはできません。 デバイス オブジェクトのセットから I/O をシリアル化する同期メカニズムでは単純にすることをお勧めします。 コント ローラーのオブジェクトに名前があるないために、ユーザー モードの保護されたサブシステムは、ことはできませんデバイス I/O 要求ターゲットのデバイス オブジェクトを表すファイル オブジェクトのハンドルを取得せずに表示されていません。 コント ローラー オブジェクトも表示する上位レベルのドライバーは、コント ローラー オブジェクトに独自のデバイス オブジェクトをアタッチすることはできません。 つまり、I/O マネージャーもより高度なドライバーを設定できます IRP コント ローラーのオブジェクトによって表されるデバイスの I/O を要求します。 I/O 要求は、デバイス オブジェクトを常に発行されます。 ドライバーだけでは、コント ローラー オブジェクトを使用できます。

### <a name="synchronization-and-overlapped-io"></a>同期と重複 I/O

「アット」ディスク コント ローラーのような機能で物理デバイスのモノリシックなドライバーは、コント ローラー オブジェクトを使用して、デバイスの I/O 操作を同期する必要はありません。 たとえば、コント ローラー オブジェクトを使用する代わりに、次の同期方法のようなもの、ドライバーのライターをご覧ください。

-   I/O 要求の対象となっているデバイスを表すために、名前付きのデバイス オブジェクトを設定します。

-   デバイス オブジェクトが現在の I/O 操作の対象を示す状態情報 (各デバイスの拡張機能で、または 1 つのデバイスの拡張機能にデバイスがビジー状態フラグのセットなど) を維持します。

-   現在ビジー状態のデバイス オブジェクトの I/O 操作を実行して、現在の IRP が完了するまで、他のデバイス オブジェクトの受信の Irp をもう一度キューします。

上記の同期方法には、IRP がドライバーの対象のデバイス オブジェクトのすべての処理がシリアル化します。 完了する前に現在の IRP にドライバーも強制的に注意してください。 その[ *StartIo* ](https://msdn.microsoft.com/library/windows/hardware/ff563858)ルーチンが残念ながらドライバーのパフォーマンスが低下する次の IRP の処理を開始することができます。

特定のデバイス操作を重ねることができる場合コント ローラー オブジェクトを使用すると、この同期手法では、ドライバー、物理デバイスを設定する前に、操作に重複がかどうかを判断するためにはドライバーの I/O のスループットが拡大できます。 たとえば、ディスク コント ローラーにドライバーをことができますが重複しては別のディスクの読み取り/書き込み操作を 1 つのディスクにシークします。

さらに、コント ローラー オブジェクトを使用しては、比較的簡単に"AT"ディスク コント ローラーなどの 1 つの物理デバイスを 1 つ以上のターゲット デバイス オブジェクトの I/O 操作を同期する方法です。 コント ローラー オブジェクトを使用すると、すべてのデバイスと 1 つまたは複数のデバイス拡張機能のデバイス コント ローラーの状態を維持することがなく、requeue Irp をしなくても、一連の名前付きのデバイス オブジェクトの間で I/O 操作を同期するモノリシックなドライバーができます。

ただし、重複する全二重シリアル コント ローラーや、バス マスター アダプターなどの I/O 操作を目的とした一部のデバイスでは、一般に Irp の内部キューを設定するドライバーがあります。

 

 




