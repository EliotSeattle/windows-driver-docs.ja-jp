---
title: デバイスの名前空間アクセスの制御
description: デバイスの名前空間アクセスの制御
ms.assetid: e5312297-849f-4b4e-835d-0ce5295c7ce2
keywords:
- デバイス オブジェクトの WDK カーネル、セキュリティ
- WDK デバイス オブジェクトのセキュリティ
- デバイスの名前空間へのアクセスの WDK カーネル
- WDK デバイス オブジェクトの名前空間
- ファイルを開くときは、WDK のデバイス オブジェクトを要求します。
- WDK のデバイス オブジェクトの要求を開く
ms.date: 06/16/2017
ms.localizationpriority: medium
ms.openlocfilehash: 9465efc655fc20b9e9c6387f9a9e5ee0a28fd1aa
ms.sourcegitcommit: fb7d95c7a5d47860918cd3602efdd33b69dcf2da
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/25/2019
ms.locfileid: "67377195"
---
# <a name="controlling-device-namespace-access"></a>デバイスの名前空間アクセスの制御





Windows Driver Model (WDM) では、すべてのデバイス オブジェクトが関連付けられている*名前空間*します。 デバイスの名前空間で名前は、デバイスの名前で始まるパスです。 という名前のデバイスの"\\*デバイス*\\*DeviceName*「、その名前空間は、フォームの任意の名前で構成されています」\\*デバイス*\\*DeviceName*\\*FileName*"。 (ファイル システム、 *FileName*はファイル システム上のファイルの実際の名前です)。

WDM ドライバーは、デバイスの名前空間のすべての名前をオープンの要求を受信します。 ドライバーのオープンの要求を処理する"\\*デバイス*\\*DeviceName*"デバイス オブジェクト自体の開いているとします。 かどうか、ドライバーは、デバイスの名前空間にオープン要求のサポートを実装し、オープンの要求の処理"\\*デバイス*\\*DeviceName* \\ *ファイル名*"として"内のファイルの"デバイス オブジェクトの名前空間 (デバイスの"file"の概念はドライバーにより決定された) 開きます。

ほとんどのドライバーは、デバイスの名前空間にオープン操作のサポートを実装していませんが、すべてのドライバーがデバイスの名前空間に未承認のアクセスを防ぐためにセキュリティがチェックを提供する必要があります。 デバイスの名前空間内のファイル オープン要求の既定では、セキュリティを確認します (たとえば、"\\*デバイス*\\*DeviceName* \\ *ファイル名*")、ドライバーを自由に残されます: デバイス オブジェクトの ACL は、オペレーティング システムによってチェックされません。

デバイス オブジェクトのファイルの場合\_デバイス\_SECURE\_オープンの特性が設定されている、システムでは、デバイスの名前空間のすべてのファイル オープン要求にデバイス オブジェクトのセキュリティ記述子が適用されます。 ドライバー ファイルを設定できます\_デバイス\_SECURE\_でデバイス オブジェクトを作成するときに開く[ **IoCreateDevice** ](https://docs.microsoft.com/windows-hardware/drivers/ddi/content/wdm/nf-wdm-iocreatedevice)または[ **IoCreateDeviceSecure**](https://docs.microsoft.com/windows-hardware/drivers/ddi/content/wdmsec/nf-wdmsec-wdmlibiocreatedevicesecure)します。 WDM ドライバー、ファイル\_デバイス\_SECURE\_オープンをレジストリに設定することもできます。 デバイス オブジェクトによって作成される非 WDM ドライバーのレジストリに設定することも**IoCreateDeviceSecure**します。 デバイス オブジェクト プロパティの設定、レジストリ内のデバイスの特性などの詳細については、次を参照してください。[レジストリにデバイス オブジェクト プロパティの設定](setting-device-object-properties-in-the-registry.md)します。 デバイスの特性の詳細については、次を参照してください。[デバイスの特性を指定する](specifying-device-characteristics.md)します。

名前空間をサポートしているデバイスのドライバーは、デバイスの名前空間内のファイル オープン要求が正しく処理されることを確認するのに 2 つのメソッドのいずれかを使用する必要があります。

-   ドライバーのデバイス オブジェクト ファイルがある\_デバイス\_SECURE\_特性のセットを開いているデバイス。 ドライバーは開いているすべての要求をデバイス オブジェクトのオープン要求として、デバイスの名前空間に扱う、ことができます。

-   ドライバーのいずれかで失敗することが[ **IRP\_MJ\_作成**](https://docs.microsoft.com/windows-hardware/drivers/kernel/irp-mj-create)を指定する要求、 **IrpSp -&gt;FileObject-&gt;FileName**パラメーターの長さが 0 以外の値。 この場合、デバイスのオープン要求は、システムの ACL の確認の対象、ドライバーによって、デバイスの名前空間内のすべてのファイル オープン要求は失敗しました。 (排他的開きますをサポートするドライバーは、このオプションを使用する必要があります)

名前空間をサポートしているデバイスのドライバーは、2 つのメソッドを使用して、デバイスの名前空間にファイルのオープン要求をセキュリティで保護することができますも。

-   ドライバーのデバイス オブジェクト ファイルがある\_デバイス\_SECURE\_特性のセットを開いているデバイス。 これにより、デバイスの名前空間に、デバイスのセキュリティ設定が一様に適用されます。 (ドライバーの名前空間のサポートを実装する責任を負いますがその[ *DRIVER_DISPATCH* ](https://docs.microsoft.com/windows-hardware/drivers/ddi/content/wdm/nc-wdm-driver_dispatch)コールバック関数です)。

-   ドライバーは、内のファイル名の Acl を確認します。 その*DispatchCreate*ルーチン。 (この場合でも、ドライバーが、ファイルを設定する必要があります\_デバイス\_SECURE\_特性を開かないでが開き、デバイスの名前空間には、デバイス オブジェクトよりも弱いセキュリティ設定を持つことができます)。

ファイル\_デバイス\_SECURE\_フィルター デバイス オブジェクトをコピーする必要がありますので、スタックの上部にある開いている特性がチェックされて、**特性**後は、次の下位のデバイス オブジェクトのメンバーアタッチしています。

 

 




