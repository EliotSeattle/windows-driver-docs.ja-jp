---
title: デバイス電源ポリシーの管理
description: デバイス電源ポリシーの管理
ms.assetid: f6f9ab40-4d51-4181-ac11-ff7af42370af
keywords:
- デバイスの電源ポリシー WDK カーネル
- 電源ポリシー WDK カーネル
- デバイスの電源ポリシー所有者 WDK カーネル
- 関数のドライバー WDK の電源管理
- デバイスの電源状態の WDK カーネル
- 最初にデバイスの電源状態の WDK カーネル
ms.date: 06/16/2017
ms.localizationpriority: medium
ms.openlocfilehash: a9dc3a2ea21d91dd938d793c9e2779407874e1de
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56579846"
---
# <a name="managing-device-power-policy"></a>デバイス電源ポリシーの管理





電源マネージャーの管理し、システムの電源ポリシーを管理すると同様、各デバイスのデバイス スタックの 1 つのドライバーは保持し、デバイスの電源ポリシーを管理します。 このドライバーは、*デバイス電源ポリシー所有者*デバイス。

デバイスの電源ポリシー所有者は、デバイスの使用率と電力の状態に関するほとんどの情報を含むドライバーです。 これは、必要があります物理的にオンとオフ、電源をデバイスにデバイスのレジスタを設定するが、デバイスが使用されているときが休止状態にすると、電源の状態を変更する必要がありますと判別できる必要があります。

通常、デバイスの機能のドライバーは、一部のデバイスは、別のドライバーまたはシステム コンポーネントがこのロールを想定可能性がありますが、電源ポリシー所有者、です。 電源管理に関連するドライバーの種類の詳細については、次を参照してください。 [WDM ドライバーの種類](types-of-wdm-drivers.md)します。

一部のドライバーは、デバイスの列挙子 (FDO の作成) 1 つのデバイスの関数ドライバー、バス ドライバー (PDO を作成する) として機能します。 電源装置および PnP Irp のディスパッチ ルーチンは、このようなドライバーは Irp、FDO に送信されると、PDO に送られたは、その処理を識別する必要があります。

たとえば、SCSI アダプターのドライバーでは、アダプター自体と、アダプターに接続されたディスクのバス ドライバー (PDO を作成する) の関数のドライバー (FDO の作成) の役割を実行する可能性があります。 SCSI アダプターのドライバーまたはポリシー所有者の関数としてキャパシティでは、このドライバーはシステム Irp を受信し、SCSI アダプターのデバイスの Irp を要求します。 ディスクのバス ドライバーとしてキャパシティでは、処理し、ディスクが作成されます Pdo を指定するデバイス Irp が完了するとします。 ドライバーは、1 つのデバイス (FDO) の電源ポリシーがあることを意味を所有しているためにだけ子デバイス (PDO) の電源ポリシーが所有しています。

デバイスの電源ポリシー所有者は、次の場合です。

-   D0 を呼び出すことによって、デバイスの初期の電源状態を設定[ **PoSetPowerState** ](https://msdn.microsoft.com/library/windows/hardware/ff559765)処理時に、プラグ アンド プレイ マネージャーの[ **IRP\_MN\_開始\_デバイス**](https://msdn.microsoft.com/library/windows/hardware/ff551749)要求。

    必要に応じて; デバイスの電源する必要があります。たとえば、ハンドルが I/O 要求にデバイスの電源する必要があります。 デバイスの電源ポリシー所有者は、そのデバイスが必要な場合を決定する、デバイスの電源がオンにすることを確認および適切なデバイスの電源状態を設定します。 開始-デバイスの PnP IRP の完了時での一般的なデバイスの電源する必要があります。

    一般的な規則としてほとんどのデバイスが電源がオフときに、使用中でないシステムが稼働状態のときにもします。

-   システム電源の要求に応答を呼び出してデバイス電源要求を送信する[ **PoRequestPowerIrp**](https://msdn.microsoft.com/library/windows/hardware/ff559734)します。

    たとえば、ポリシーの所有者が、システムを受信するとセット power IRP では、デバイスを送信 IRP の出力を設定します。 ほとんどのデバイスは、システムがスリープ状態に入ったときに、D3 を入力します。 **DeviceState**配列、 [**デバイス\_機能**](https://msdn.microsoft.com/library/windows/hardware/ff543095)構造体には、それぞれのシステム電源のデバイスを管理できます highest-powered 状態が表示されます。状態。 (を参照してください[デバイスの電源機能レポート](reporting-device-power-capabilities.md))。

-   デバイスがアイドル状態のときに検出し、エネルギーを節約するためにスリープ状態に移行します。

    電源マネージャーまたはデバイスのポリシーの所有者はアイドル状態のデバイスを検出し、その状態を変更するデバイスの電源を IRP を送信できます。 詳細については、次を参照してください。 [、アイドル状態のデバイスを検出する](detecting-an-idle-device.md)します。

-   必要な場合に稼働状態にそのデバイスを返します。

    スリープ状態のデバイスの I/O 要求が到着すると、デバイスのドライバーが状態に戻す、作業します。

-   有効にして、要求されたときに、そのデバイスのウェイク アップを無効化します。

    デバイスの電源ポリシー所有者の送信とキャンセルで説明されているように、Irp を待機/ウェイク[サポート デバイスがあるウェイク アップ機能](supporting-devices-that-have-wake-up-capabilities.md)します。

 

 




