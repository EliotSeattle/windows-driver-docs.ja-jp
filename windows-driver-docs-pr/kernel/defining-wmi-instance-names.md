---
title: WMI インスタンス名の定義
description: WMI インスタンス名の定義
ms.assetid: 0f91710a-7bd2-462a-b677-6dd32160a861
keywords:
- WMI WDK カーネル、イベントブロック
- イベントブロック WDK WMI
- データブロック WDK WMI
- WMI WDK カーネル、データブロック
- WDK WMI をブロックする
- 動的インスタンス名 WDK WMI
- 静的インスタンス名 WDK WMI
- インスタンス名 WDK WMI
- WMI WDK カーネル、インスタンス名
ms.date: 06/16/2017
ms.localizationpriority: medium
ms.openlocfilehash: a1663e34ba1e37758d46282067ae92b167652cdc
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72828398"
---
# <a name="defining-wmi-instance-names"></a>WMI インスタンス名の定義





WMI ブロックの*インスタンス*には、特定の物理デバイスまたはソフトウェアコンポーネントによって提供されるデータが含まれます。 ブロックの GUID によってブロックが一意に識別されるのと同じように、インスタンスの名前はブロックのインスタンスを一意に識別します。 WMI クライアントアプリケーションは、インスタンス名を使用して、データブロックで返された情報を、データを提供したデバイスまたはコンポーネントに関連付けます。 WMI では、インスタンス名を使用して、要求の送信先となるデバイスを決定します。 インスタンス名を定義するときに、ドライバーで PDO を使用することを強くお勧めします。

ドライバーでは、次の2つの方法のいずれかで、ブロックのインスタンス名を定義できます。

-   ドライバーは、ブロックを登録するときに、*静的インスタンス名*のリストを WMI に渡します。

    ブロックが登録された後、ドライバーと WMI の両方で、この一覧のインデックスによってインスタンス名が指定されます。 静的インスタンス名は、ドライバーの PDO の*デバイスインスタンス ID*またはドライバーで定義された基本名に基づいて作成できます。または、ドライバーでインスタンス名の文字列の一覧を定義できます。 静的インスタンス名は、ドライバーがブロックを再登録ことによって明示的に変更されるまで保持されます。

-   インスタンスの作成時に、ドライバーによって*動的なインスタンス名*が生成されます。

    ドライバーは、ブロックを登録するときに、ブロックの動的なインスタンス名を生成することを示します。 ブロックが登録されると、ドライバーと WMI の両方で、動的なインスタンス名が、**パラメーター**のバッファー内の文字列として渡されます。

ドライバーは、データブロックのインスタンス名またはインスタンス名の数が実行時に頻繁に変更される場合にのみ、動的なインスタンス名を生成する必要があります。 たとえば、ドライバーでは、プロセス Id または TCP/IP 接続の IP アドレスをインスタンス名として使用できます。 このようなインスタンス名は動的である必要があります。これらが静的である場合、ドライバーでは、 [**Iowmiregistrationcontrol**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-iowmiregistrationcontrol)を呼び出して、変更が発生するたびにインスタンスの数と名前を更新する必要があるため、かなりのオーバーヘッドが発生します。

ほとんどの場合、次の理由により、動的なインスタンス名には静的インスタンス名が適しています。

-   静的インスタンス名を使用すると、ドライバーのパフォーマンスが向上します。これは、ドライバーが動的インスタンス名を要求するときに、WMI 要求に応答してインスタンス名文字列を返す必要がないためです。

-   WMI は、登録時に静的インスタンス名の競合を検出し、必要に応じてインスタンス名を自動的に変更します。これにより、ブロックを登録するドライバーの数に関係なく、すべてのインスタンス名が特定のブロックに対して一意になります。

    WMI は動的インスタンス名のインスタンス名の競合を検出できないため、ドライバーは[**IoWMIAllocateInstanceIds**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wdm/nf-wdm-iowmiallocateinstanceids)を使用して一意の名前を生成します。

-   ドライバーは、その名前がドライバーの PDO またはドライバーで定義された基本名に基づいている限り、静的インスタンス名を使用するブロックの Irp を処理するために、WMI ライブラリルーチンを使用できます。

    ドライバーは、動的インスタンス名を使用するデータブロックの Irp を処理するために、WMI ライブラリルーチンを使用することはできません。

ドライバーは、ブロックで静的または動的なインスタンス名を使用しているかどうかを示します[ **。また、** ](https://docs.microsoft.com/windows-hardware/drivers/ddi/wmilib/ns-wmilib-_wmiguidreginfo) WMI に渡す[**場合は、** ](https://docs.microsoft.com/windows-hardware/drivers/ddi/wmistr/ns-wmistr-wmiregguidw)\_フラグ\_*XXX*を設定またはクリアします。ブロックを登録するとき。 詳細については、「 [WMI Data Provider としての登録](registering-as-a-wmi-data-provider.md)」を参照してください。

 

 




