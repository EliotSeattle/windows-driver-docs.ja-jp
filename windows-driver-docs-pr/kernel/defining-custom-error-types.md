---
title: カスタム エラーの種類を定義します。
description: カスタム エラーの種類を定義します。
ms.assetid: 1106b520-8737-421b-bee5-841220862b78
keywords:
- カスタム エラー メッセージの WDK カーネル
- カスタム エラーの種類の WDK カーネル
- IO_ERR_XXX 値
- テンプレート WDK エラー
- ヘッダー WDK エラー
- WDK のエラー ログをファイルします。
- テキスト ファイルの WDK エラー ログ
- エラー メッセージのファイルをコンパイルします。
- LanguageNames ディレクティブ
- SeverityNames ディレクティブ
- FacilityNames ディレクティブ
ms.date: 06/16/2017
ms.localizationpriority: medium
ms.openlocfilehash: 1e1841930f086c7081e0422de724fce11150b08d
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56538003"
---
# <a name="defining-custom-error-types"></a>カスタム エラーの種類を定義します。





ドライバーは、独自のエラーの種類とエラー メッセージを指定できます。 カスタム エラー メッセージを定義する、新しい IO を定義する必要がありますまず\_ERR\_*XXX*として指定する値、 **ErrorCode**エラー ログ エントリのメンバー。 イベント ビューアーは、IO\_ERR\_*XXX*ドライバーのエラー メッセージを検索する値。

カスタム エラー メッセージは、ドライバーをサポートするには、次の手順に従います。

1.  カスタムの IO を指定するメッセージのテキスト ファイルを作成\_ERR\_*XXX*値と対応するエラー メッセージ。 詳細については、[エラー メッセージのテキスト ファイルを作成する](#ddk-creating-the-error-message-text-file-kg)を参照してください。

2.  リソースが、エラー メッセージのテキスト ファイルをコンパイルし、ドライバーのイメージにリソースをアタッチします。 詳細については、[エラー メッセージのテキスト ファイルをコンパイルする](#ddk-compiling-the-error-message-text-file-kg)を参照してください。

3.  エラー メッセージが含まれていると、ドライバーのイメージを登録します。 詳細については、[エラー メッセージのソースとして登録する](registering-as-a-source-of-error-messages.md)を参照してください。

### <a href="" id="ddk-creating-the-error-message-text-file-kg"></a>エラー メッセージのテキスト ファイルの作成

ドライバーのカスタムの IO の定義\_ERR\_*XXX*ドライバー イメージに、値と一致するテンプレートがエラー メッセージをメッセージ テーブル リソースとして関連付けられています。 (これは、.mc ファイル名拡張子を持つ) メッセージのテキスト ファイル内のドライバーのメッセージを記述できます。

メッセージのテキスト ファイルは、2 つのセクションで構成されています: ヘッダー セクションと、メッセージ。 ヘッダー セクションが数値の値のシンボル名の宣言を許可し、[メッセージ] セクションは、IO を指定\_ERR\_*XXX*メッセージ テンプレートの値と一致するエラー。

メッセージのテキスト ファイルの例で Serlog.mc ファイルを参照してください、[シリアル ドライバーのサンプル](https://go.microsoft.com/fwlink/p/?LinkId=617962)GitHub で入手できます。

### <a name="header-section"></a>ヘッダー セクション

ヘッダー セクションには、この行を含める必要があります。

```cpp
MessageIdTypedef=NTSTATUS
```

これにより、IO の種類\_ERR\_*XXX*メッセージ コンパイラによって生成された値は NTSTATUS として宣言されています。

ヘッダー セクションに表示されるその他のディレクティブは、[メッセージ] セクション内の数値の代わりに使用されるシンボルの値を定義します。

**SeverityNames**と**FacilityNames**ディレクティブが NTSTATUS 値のフィールドの重要度と機能のシンボルの値を定義します。 形式のディレクティブは<em>キーワード</em>**= (** *値* **)** ここで、*値*いずれかで構成またはフォームの複数のステートメント*名前* **=** *値* **:** *ヘッダー\_名前*空白で区切られました。 *名前*パラメーターを指定する数値を使用する名前は、*値*メッセージのテキスト ファイルの中に、*ヘッダー\_名前*この値の名前を指定しますメッセージ コンパイラによって生成された C ヘッダー ファイルで宣言されています。 **:** *ヘッダー\_名前*句は省略可能です。

重大度コードのシンボル名のヘッダー宣言の例を次に示します。

```cpp
SeverityNames = (
  Success       = 0x0:STATUS_SEVERITY_SUCCESS
  Informational = 0x1:STATUS_SEVERITY_INFORMATIONAL
  Warning       = 0x2:STATUS_SEVERITY_WARNING
  Error         = 0x3:STATUS_SEVERITY_ERROR
)
```

**LanguageNames**ディレクティブは、ロケール Id (LCID) シンボリック値を定義します。 ディレクティブの形式は、 **LanguageNames = (** *値* **)** ここで、*値*フォームの1つまたは複数のステートメントで構成されます*言語\_名前* **=** *lcid* **:** *langfile*、空白で区切られます。 *言語\_名前*パラメーターの代わりに使用する名前は、 *lcid*メッセージのテキスト ファイルの中に、 *filename* (なしの一意のファイル名を指定します拡張機能)。 この言語の文字列リソースのすべてをという名前のファイルの保存、メッセージ コンパイラは、メッセージのテキスト ファイルからリソース スクリプトを生成するとき*langfile*.*bin*します。

### <a name="message-section"></a>[メッセージ] セクション

各メッセージの定義、カスタムの IO の定義から始めます\_ERR\_*XXX*ドライバーを使用してこの特定の種類のエラーを報告する値。 IO\_ERR\_*XXX* 、一連の値が定義されている*キーワード* = *値*ペア。 可能なキーワードとその意味は次のとおりです。

<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>キーワード</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p><strong>メッセージ Id</strong></p></td>
<td><p>コードのフィールドの新しい IO_ERR_<em>XXX</em>値。</p></td>
</tr>
<tr class="even">
<td><p><strong>重要度</strong></p></td>
<td><p>重大度 フィールドの新しい IO_ERR_<em>XXX</em>値。 指定した値がによって定義されたシンボル名のいずれかを指定する必要があります、 <strong>SeverityNames</strong>ヘッダー。</p></td>
</tr>
<tr class="odd">
<td><p><strong>機能</strong></p></td>
<td><p>新しい IO_ERR_ の施設フィールド<em>XXX</em>値。 指定した値がによって定義されたシンボル名のいずれかを指定する必要があります、 <strong>FacilityNames</strong>ヘッダー。</p></td>
</tr>
<tr class="even">
<td><p><strong>SymbolicName</strong></p></td>
<td><p>新しい IO_ERR_ のシンボリック名<em>XXX</em>値。 メッセージ コンパイラを含む C ヘッダー ファイルを生成する、 <strong>#定義</strong>NTSTATUS の対応する値として、名前を宣言します。 ドライバーはエラーの種類を指定するときに、その名前を使用します。</p></td>
</tr>
</tbody>
</table>

 

最初のキーワードは常にあります**MessageId**します。

エラー メッセージのローカライズ版を 1 つまたは複数のメッセージ定義の残りの部分で構成されます。 形式は、各バージョンです。

```cpp
Language=language_name
localized_message
```

*言語\_名前*によって定義されている値で、シンボル名は、のいずれかを指定する必要があります、 **LanguageNames**ヘッダーのディレクティブは、メッセージのテキストの言語を指定します。 ローカライズされたメッセージ テキスト自体は、Unicode 文字列で構成されます。 埋め込み形式の文字列"%*n*"は、エラーが記録されたときに、イベント ビューアーを置き換えるテンプレートとして扱われます。 「1」文字列は"%2"の中に、ドライバーのデバイス オブジェクトの名前で置き換え"%*n*"は、ドライバーによって提供されるすべての挿入文字列に置き換えられます。

メッセージ定義については、行に単独で単一のピリオドで終了します。

しない限り、挿入文字列を使用する必要がありますカスタム エラー メッセージを定義する場合に必要な。 これらは、数値またはファイル名などの言語非依存である文字列を使用する必要がありますので、挿入文字列はローカライズできません。 ほとんどのドライバーでは、挿入文字列は使用しないでください。

### <a href="" id="ddk-compiling-the-error-message-text-file-kg"></a>エラー メッセージのテキスト ファイルをコンパイルします。

メッセージ コンパイラ (mc.exe) リソース スクリプト ファイルに、メッセージのテキスト ファイルをコンパイルする (これは、.rc ファイル名拡張子を持つ) を使用します。 フォームのコマンド

```cpp
mc filename.mc
```

次のファイルを生成するメッセージ コンパイラが発生します。

-   *ファイル名*.h、各カスタム IO の宣言を含むヘッダー ファイル\_ERR\_*XXX*値*filename*.*mc*します。

-   *ファイル名**.rc, リソース スクリプトです。

-   メッセージのテキスト ファイルに表示される言語ごとに 1 つのファイル。 これらの各ファイルは、1 つの言語のエラー メッセージ文字列リソースのすべてを格納します。 各言語のファイルの名前は*langfile*.*bin*ここで、 *langfile*メッセージのテキスト ファイルの言語に指定された値は、 **LanguageNames**ディレクティブ。

メッセージ コンパイラの詳細については、Microsoft Windows SDK に記載されています。

リソース コンパイラでは、リソース スクリプトをドライバーのイメージをアタッチできるリソース ファイルに変換します。 ドライバーをビルドするビルド ユーティリティを使用する場合は、リソース スクリプトをリソース ファイルに変換して、ドライバーのソースの変数で、リソース スクリプトの名前を含むだけで、ドライバーのイメージに接続されていることを確認の操作を行うことができます。 リソース コンパイラの詳細については、Windows SDK のドキュメントを参照してください。 ビルド ユーティリティを使用して、ドライバーをビルドする方法については、[ドライバーをビルド](https://docs.microsoft.com/windows-hardware/drivers/develop/building-a-driver)を参照してください。


 

 




