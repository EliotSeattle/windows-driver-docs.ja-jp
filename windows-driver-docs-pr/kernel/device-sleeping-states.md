---
title: デバイスの低電力状態
description: デバイスの低電力状態
ms.assetid: f594a63f-10ce-439d-abe3-d342555d98f0
keywords:
- デバイスの電源状態 WDK カーネル
- デバイスの低電力状態 WDK 電源管理
- スリープ電源管理 WDK カーネル
- Dx 名 WDK の電源管理
- スリープ状態のデバイス WDK 電源管理
- 低電力デバイスの状態 WDK カーネル
- 高性能デバイス低電力状態 WDK カーネル
- 中間スリープ状態 WDK カーネル
- 低電力モード WDK カーネル
- 省電力モード WDK カーネル
- 継続的なパワー WDK カーネル
- WDK 電源管理の遅延
- 状態の移行による WDK 電源管理の遅延
ms.date: 06/16/2017
ms.localizationpriority: medium
ms.openlocfilehash: 477e32f6afef9c0d26020591fb858c2a1f571180
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72838743"
---
# <a name="device-low-power-states"></a>デバイスの低電力状態





デバイスの電源状態 D1、D2、および D3 は、デバイスの低電力状態です。 Windows 8 以降では、D3 は2つの下位[D3hot](#d3hot)と[D3cold](#d3cold)に分かれています。

D1 と D2 は、中間の低電力状態です。 デバイスの多くのクラスでは、これらの状態が定義されていません。 すべてのデバイスで D3hot を定義する必要があります。

以下のセクションでは、D1、D2、および D3 について説明します。

-   [デバイスの電源状態 D1](#d1)
-   [デバイスの電源状態 D2](#d2)
-   [デバイスの電源状態 D3](#d3)

### <a href="" id="d1"></a>デバイスの電源状態 D1

デバイスの電源状態 D1 は、高性能なデバイスの低電力状態です。 次の特性があります。

<a href="" id="power-consumption"></a>*電力消費*  
使用量が D0 の状態ではなく、D2 の状態の値以上です。 多くの場合、D1 はクロックゲート状態であり、デバイスがデバイスのハードウェアコンテキストを保持するために十分な電力を受け取ることができます。 通常、D1 をサポートするバスまたはデバイスクラスの仕様では、この状態について詳しく説明しています。

<a href="" id="device-context"></a>*デバイスコンテキスト*  
一般に、デバイスコンテキストはハードウェアによって保持され、ドライバーによって復元される必要はありません。 D1 をサポートするバスクラスまたはデバイスクラスの仕様では、通常、このコンテキストを保持するための詳細な要件が提供されます。

<a href="" id="device-driver-behavior"></a>*デバイスドライバーの動作*  
ドライバーは、ハードウェアによって失われたコンテキストを保存し、復元または再初期化する必要があります。 ただし、通常、デバイスはこの状態を入力したときにほとんどコンテキストを失います。

<a href="" id="restore-time"></a>*復元時間*  
一般に、デバイスを D1 から D0 に復元するのに必要な時間は、D2 から D0 への復元よりも小さくする必要があります。

<a href="" id="wake-up-capability"></a>*ウェイクアップ機能*  
D1 のデバイスがウェイクアップを要求できる場合があります。 この状態がウェイクアップ信号をサポートできるかどうかに関する情報を提供するために、バスドライバーは[**デバイス\_機能**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_device_capabilities)の構造を使用します。または、Windows 8 以降では、 [GUID\_D3COLD\_は\_インターフェイス](https://msdn.microsoft.com/library/windows/hardware/hh967714)ドライバーをサポートしています。efi.

通常、D1 を使用するデバイスでは、この状態から再開するときに、デバイスの完全なハードウェアコンテキストを復元する必要はありません。 ユーザーが遅延を認識しないようにするには、D1 から D0 にデバイスを復元すると、発生する可能性が最も低い遅延が発生します。 状態遷移の遅延を最小限に抑えることは、電力消費の削減よりも重要です。

### <a href="" id="d2"></a>デバイスの電源状態 D2

D2 は、次の特性を持つ中間デバイス低電力状態です。

<a href="" id="power-consumption"></a>*電力消費*  
使用量が D1 状態の値以下です。

<a href="" id="device-context"></a>*デバイスコンテキスト*  
一般に、ほとんどのデバイスコンテキストはハードウェアによって失われます。 多くの場合、この状態は、ウェイクアップイベントのシグナルに使用されるコンテキストの一部を保持します。 D2 をサポートするバスクラスまたはデバイスクラスの仕様では、通常、このコンテキストを保持するための詳細な要件が提供されています。

<a href="" id="device-driver-behavior"></a>*デバイスドライバーの動作*  
デバイスドライバーは、ハードウェアによって失われたコンテキストを保存し、復元または再初期化する必要があります。 一般的なデバイスは、D2 に入ったときにほとんどのコンテキストを失います。

<a href="" id="restore-time"></a>*復元時間*  
デバイスを D2 から d0 に復元するには、デバイスを D1 から D0 に復元する必要があります。 フレームバッファーが大きいグラフィックアダプターは、D2 から D0 への移行後に復元するハードウェアコンテキストが大量にあるデバイスの例です。 このようなデバイスの場合、D2 からの復元時間は、D1 からの復元時間よりもはるかに大きくなる可能性があります。

<a href="" id="wake-up-capability"></a>*ウェイクアップ機能*  
D2 のデバイスがウェイクアップを要求できる場合があります。 この状態がウェイクアップ信号をサポートできるかどうかに関する情報を提供するために、バスドライバーは[**デバイス\_機能**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_device_capabilities)の構造を使用します。または、Windows 8 以降では、 [GUID\_D3COLD\_は\_インターフェイス](https://msdn.microsoft.com/library/windows/hardware/hh967714)ドライバーをサポートしています。efi.

通常、D2 をサポートするドライバーは、デバイスが D3 からのウェイクをサポートできないため、このように機能します。 これらのデバイスの場合、D2 状態の電力消費は、ウェイクアップシグナルに応じてデバイスが回復できる最下位レベルまで低下します。 ユーザーによって認識される遅延を減らすために実装されている D1 状態とは対照的に、D2 状態を実装する目的は電力を節約することです。 その結果、D2 から D0 への復元時間は通常、D1 から D0 までを超えています。 たとえば、D2 状態では、バスの電源を減らすと、デバイスの機能の一部が無効になるため、デバイスの再起動と復元に時間がかかることがあります。

デバイスの多くのクラスでは、この状態が定義されていません。

### <a href="" id="d3"></a>デバイスの電源状態 D3

D3 は、デバイスの低電力の最低状態です。 すべてのデバイスでこの状態がサポートしている必要があります。

Windows 8 以降では、オペレーティングシステムの細分化は、D3hot と D3cold という2つの独立した異なる下位互換性を備えています。 以前のバージョンの Windows では、D3 状態が定義されていますが、D3hot と D3cold の下位部分は定義されていません。 ただし、 [PCI バス電源管理インターフェイスの仕様](https://pcisig.com/specifications/conventional/)のすべてのバージョンでは、個別の D3hot と D3cold の下位条件が定義されており、[高度な構成と電源インターフェイスの仕様](https://go.microsoft.com/fwlink/p/?linkid=57185)のバージョン4以降では、D3hot と D3cold が定義されています。並行.

Windows 8 より前のバージョンの Windows では、D3 の D3hot と D3cold の下位部分が明示的に定義されていませんが、これらの下位の部分は、これらの以前のバージョンの Windows に暗黙的に存在します。 デバイスが D3 状態に明示的に含まれていて、コンピューターが S0 システムの電源状態にある場合、デバイスは D3hot 下位の状態にあります。 D3hot では、デバイスは電源に接続されています (デバイスは低い電流を描画するように構成されている可能性があります)。また、バス上のデバイスの存在を検出できます。 デバイスは、D3 状態で明示的に指定されており、コンピューターが低電力の Sx 状態 (S0 以外の状態) にある場合、暗黙的に D3cold の下位にあります。 この暗黙的な D3cold 下位下位の場合、デバイスはトリクルを現在受信している可能性がありますが、デバイスとコンピューターは、wake イベントが発生するまで実質的にオフになります。

Windows 8 以降では、デバイスは D3cold の下位状態のままにして、コンピューターが S0 状態のままになることがあります。 この新しい動作をサポートするには、D3hot と D3cold を D3 の個別の下位依存として明示的に定義する必要があります。

D3hot は、デバイスが D0 から直接入力できる D3 の唯一の下位部分です。 デバイスは、デバイスドライバーによってソフトウェア制御下で、D0 から D3hot への移行を行います。 D3hot では、デバイスが接続されているバスでデバイスを検出できます。 デバイスが D3hot の下位にある間は、バスが D0 状態のままになっている必要があります。 D3hot から、デバイスは D0 に戻るか、D3cold を入力できます。 D3cold は D3hot からのみ入力できます。

D3cold は D3 の下位の部分で、デバイスはバスに物理的に接続されていますが、バス上のデバイスの存在を検出できません (つまり、デバイスが再び有効になるまで)。 D3cold では、次のいずれかまたは両方が当てはまります。

-   デバイスの接続先のバスが低電力状態です。
-   このデバイスは、バスドライバーがバス上での存在を検出しようとしたときに、デバイスが応答しない低電力状態になっています。

D3hot から D3cold への移行は、デバイスドライバーとの対話を行わずに発生します。 代わりに、デバイスドライバーは、D0 から D3hot への移行を開始する前に、D3cold 遷移用に準備されているかどうかを示します。 その後、D3hot から D3cold への移行は、この移行を有効にするための条件がすべて満たされているかどうかによって、発生する可能性があります。

このような2つの条件は、同じ電源を使用するすべてのデバイスが D3hot にあり、D3cold 遷移用に準備されていることです。 これらのデバイスの最後に D3hot が入力されると、親バスドライバーまたは ACPI フィルタードライバーによって、これらのデバイスの電源がオフになります。これは、デバイスが D3cold に入ったことを示します。

D3cold にあるデバイスは、D0 を入力することによってのみ、この下位状態を維持できます。 D3cold から D3hot への直接的な移行はありません。

コンピューターが S0 状態で、デバイスが D3hot の下位に入っている場合、通常、デバイスドライバーは、デバイスの次の移行が D3cold と D0 のどちらになるかを事前に判断することができません。 1つの例外は、コンピューターが S0 状態のままになる準備をしている場合です。 この場合、次の移行は D3cold になります。

次のセクションでは、D3hot と D3cold について説明します。

-   [D3hot 下位下位](#d3hot)
-   [D3cold 下位下位](#d3cold)

詳細については、「 [D3cold でのドライバーのサポート](supporting-d3cold-in-a-driver.md)」を参照してください。

### <a href="" id="d3hot"></a>D3hot 下位下位

D3hot には次の特性があります。

<a href="" id="power-consumption"></a>*電力消費*  
ほとんどの場合、電源はデバイスから削除されますが、コンピューター全体からは削除されません。 S0 状態のコンピューターは、この状態で継続して実行されるか、または S0 から低電力の Sx 状態に移行する準備をしている可能性があります。

<a href="" id="device-context"></a>*デバイスコンテキスト*  
デバイスドライバーは、デバイスコンテキストの復元のみを行います。 ドライバーは、すべてのデバイスコンテキストを保持してから復元する必要があります。または、D0 状態への移行時にデバイスを再初期化する必要があります。

<a href="" id="device-driver-behavior"></a>*デバイスドライバーの動作*  
デバイスドライバーは、通常、最新の作業構成からデバイスコンテキストを復元するだけです。

<a href="" id="restore-time"></a>*復元時間*  
合計復元時間は、D3cold を除くデバイスの電源状態の最大値ですが、通常は D2 からの復元時間よりもはるかに大きくありません。

<a href="" id="wake-up-capability"></a>*ウェイクアップ機能*  
D3hot の下位のデバイスは、ウェイクアップを要求できない場合があります。 この下位状態がウェイクアップ信号をサポートするかどうかに関する情報を提供するために、バスドライバーは[**デバイス\_機能**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_device_capabilities)の構造を使用します。また、Windows 8 以降では、 [GUID\_D3COLD\_は\_インターフェイス](https://msdn.microsoft.com/library/windows/hardware/hh967714)ドライバーをサポートしています。efi.

D3hot では、最小トリクル current のみを使用できます。 電源が入らないようにドライバーとハードウェアを準備する必要があります。 D3hot をサポートするバスの仕様では、通常、この状態で使用できる電源ソースの詳細な要件が提供されます。 デバイスを動作中の状態に戻すには、デバイスのドライバーが、BIOS に依存せずにデバイスの復元と再初期化を行う必要があります。これは、デバイスで使用できる可能性のあるオプションのコードを実行するための BIOS に依存しません。

親バスドライバーは、コンピューターが S0 状態に移行しない限り、D3hot に入ったデバイスの親バスからシステム電源を削除しません。

デバイスのすべてのクラスで、D3hot の下位の部分が定義されます。

### <a href="" id="d3cold"></a>D3cold 下位下位

D3cold には次の特性があります。

<a href="" id="power-consumption"></a>*電力消費*  
デバイスから電力が完全に削除され、場合によってはシステム全体から電源が切れています。 デバイスは、その構築に応じて、サイドバンドソースから現在の描画を行うことができます。

<a href="" id="device-context"></a>*デバイスコンテキスト*  
デバイスドライバーは、デバイスコンテキストの復元のみを行います。 ドライバーはデバイスコンテキストを保持して復元する必要があります。または、D0 状態への移行時にデバイスを再初期化する必要があります。

<a href="" id="device-driver-behavior"></a>*デバイスドライバーの動作*  
デバイスドライバーは、通常、最新の作業構成からデバイスコンテキストを復元するだけです。

<a href="" id="restore-time"></a>*復元時間*  
合計復元時間は、デバイスの電源状態の最大値です。

<a href="" id="wake-up-capability"></a>*ウェイクアップ機能*  
D3cold の下位の状態では、スリープ状態のコンピューターをスリープ解除するためにデバイスがウェイクアップ信号をトリガーできる場合があります。 この機能は、[**デバイス\_機能**](https://docs.microsoft.com/windows-hardware/drivers/ddi/wdm/ns-wdm-_device_capabilities)の構造で報告されます。 Windows 8 以降では、 [GUID\_D3COLD\_](https://msdn.microsoft.com/library/windows/hardware/hh967714) [*GetIdleWakeInfo*](https://docs.microsoft.com/windows-hardware/drivers/ddi/wdm/nc-wdm-get_idle_wake_info)ルーチンによって\_インターフェイスドライバーインターフェイスがサポートされます。 シグナルによってコンピューターがウェイクアップされると、デバイスドライバーはデバイスの D3cold から D0 への移行を開始します。 詳細については、次の解説を参照してください。

Windows 8 以降では、D3cold 下位のデバイスは、S0 システムの電源状態にあるコンピューターに wake 信号をトリガーすることができます。 この機能は、 *GetIdleWakeInfo*ルーチンによって報告されます。 **デバイス\_機能**の構造には、この機能に関する情報は含まれていません。 ウェイクアップ信号が到着すると、デバイスドライバーはデバイスの D3cold から D0 への移行を開始します。 この場合、信号が到着するとコンピューターが起動し、デバイスのみをスリープ解除する必要があります。

多くの既存のハードウェアプラットフォームで、低電力の Dx 状態にあるデバイスは、スリープ状態のコンピューターをスリープ解除するためにウェイクアップ信号をトリガーできます。 ただし、コンピューターが S0 状態で実行されている場合、同じデバイスがウェイクアップ信号をトリガーできない可能性があります。 このため、このデバイスのドライバーは、コンピューターが S0 状態にあるときに、デバイスの D0 から低電力の Dx 状態へのデバイスの移行を開始することはできません。 そうしないと、デバイスが D0 に出ると、コンピューターが S0 状態から出るまで使用できなくなります。 このデバイスは、コンピューターが S0 状態のままになる準備をしている場合にのみ、D0 状態を維持する必要があります。

低電力の Dx 状態にあるデバイスが S0 状態で実行されているコンピューターにウェイクアップ信号をトリガーできる場合、そのコンピューターが S0 にあるときにデバイスが D0 にとどまる必要はありません。 コンピューターが S0 で、デバイスが D0 でアイドル状態である場合、ドライバーはデバイスを arm に入れてスリープ解除信号をトリガーした後、デバイスが D0 からこの低電力の Dx 状態に移行するのを開始します。

デバイスの一部のクラスでは、D3cold の下位の部分が定義されています。

詳細については、「 [D3cold でのドライバーのサポート](supporting-d3cold-in-a-driver.md)」を参照してください。

 

 




