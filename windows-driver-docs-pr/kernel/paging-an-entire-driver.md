---
title: ドライバー全体のページング
description: ドライバー全体のページング
ms.assetid: d861160f-e429-4ff3-9ca6-4fce4d5d6c1b
keywords:
- ページング可能なドライバー WDK カーネル、全体のドライバーのページング
- ページング全体ドライバー WDK
- 参照カウントの WDK ページング可能なドライバー
- WDK のページング可能なまたは nonpageable 属性をオーバーライドします。
ms.date: 06/16/2017
ms.localizationpriority: medium
ms.openlocfilehash: 077c8971e68ad710c47438f5b4ad9338c8e4f433
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56578670"
---
# <a name="paging-an-entire-driver"></a>ドライバー全体のページング





使用するドライバー、 **MmLockPagable * Xxx*** ルーチンをサポートし、非ページのセクションでは、ページのセクションでは、およびドライバーの初期化後に破棄される INIT セクションのページと破棄のセクションで構成されますを指定します。

デバイス ドライバーが、管理対象デバイスの割り込みを接続した後、ドライバーの割り込みがパスの処理がシステムの領域に常駐している場合があります。 割り込み処理コードは、割り込みが発生した場合に、ページ、アウトできません。 ドライバーのセクションの一部にすることがあります。

2 つの追加のメモリ マネージャーのルーチンでは、 [ **MmPageEntireDriver** ](https://msdn.microsoft.com/library/windows/hardware/ff554650)と[ **MmResetDriverPaging**](https://msdn.microsoft.com/library/windows/hardware/ff554680)、オーバーライドに使用できる、ドライバーのイメージを構成するすべてのセクションのページング可能なまたは nonpageable 属性。 これらのルーチンは、ページ アウト全体を管理するデバイスが使用されていないと、割り込みを生成することはできませんとするためのドライバーを有効にします。

完全にページング可能なシステム ドライバーには、win32k.sys ドライバー、シリアル ドライバー、"メール スロット"ドライバー、ビープ音を鳴らすドライバーおよび null のドライバーがあります。

シリアル ドライバーが断続的に使用されます。 管理ポートが開かれるまでシリアル ドライバーを完全にページアウトすることができます。 ポートが開かれるとすぐに、メモリ常駐型にする必要があるシリアル ドライバーの一部はページングされないシステム領域に取り込む必要があります。 ドライバーの他の部分はページング可能なままことができます。

完全にページングされたドライバーを呼び出す必要があります**MmPageEntireDriver**割り込みを接続する前に、ドライバーの初期化中にします。

ページアウト ドライバーによって管理されるデバイスは、オープンの要求を受信時に、ドライバーにページします。 次に、ドライバーを呼び出す必要があります[ **MmResetDriverPaging** ](https://msdn.microsoft.com/library/windows/hardware/ff554680)割り込みに接続する前にします。 呼び出す**MmResetDriverPaging**が原因で扱うに従ってコンパイルとリンク中に取得する属性のセクションでは、ドライバーのメモリ マネージャー。 ページングされないシステム メモリへページングされるテキストのセクションなどの非ページは、任意のセクション参照されるページング可能なセクションにページングされます。

このようなドライバーは、そのデバイスに開いているハンドルの参照カウントを保持する必要があります。 ドライバーは、任意のデバイスやデクリメントの開いている各要求にカウント閉じる要求ごとにカウントをインクリメントします。 ドライバーが割り込みを切断する必要がありますを呼び出して、カウントがゼロに達すると**MmPageEntireDriver**します。 ドライバーが 1 つ以上のデバイスを管理場合、カウントこのようなデバイスはすべて 0 にあります、ドライバーを呼び出すことができます**MmPageEntireDriver**します。

参照カウントを変更するときに、どのような同期が必要なため、ドライバーの必要がありますし、参照カウントが、ドライバーのページング可能な状態が変更することを防ぐために変更します。 SMP のコンピューターでドライバーを確認してくださいを**MmPageEntireDriver**割り込みを接続して、参照カウントをするオープン呼び出しが原因で別のプロセッサ、1 つのプロセッサで処理中のすることはできませんインクリメントされます。

 

 




