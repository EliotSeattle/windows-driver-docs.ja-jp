---
title: コンポーネント レベルの電源管理
description: 以降では、Windows 8 で、電源管理フレームワーク (PoFx) は、デバイスの個々 のコンポーネントの電源状態を管理するためのドライバーを使用できます。 コンポーネント レベルの電源管理では、デバイス レベルの電源管理と並行して存在します。
ms.assetid: 77866143-FB10-4623-9923-368B23808715
ms.localizationpriority: medium
ms.date: 10/17/2018
ms.openlocfilehash: 5500faa606bd02a97815ec49652a2648835065fa
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63343734"
---
# <a name="component-level-power-management"></a>コンポーネント レベルの電源管理


以降では、Windows 8 で、電源管理フレームワーク (PoFx) は、デバイスの個々 のコンポーネントの電源状態を管理するためのドライバーを使用できます。 コンポーネント レベルの電源管理では、デバイス レベルの電源管理と並行して存在します。

## <a name="overview-of-component-level-power-management"></a>コンポーネント レベルの電源管理の概要


Windows 7 と以前のバージョンのオペレーティング システムのみデバイス レベルの電源管理は、これにより、デバイスの D 状態をサポートするためのドライバーのサポートを提供します。 Advanced Configuration and Power Interface (ACPI) 仕様で定義されて[デバイスの電源状態](device-power-states.md)D0 D3 (完全にはオフ) から (完全に) を定義および[システム電源の状態](system-power-states.md)S0 (完全に) s5 までから (完全オフ)。 これらのバージョンの Windows では、デバイスの個々 のコンポーネントに供給される電力を個別に管理するためのメカニズムは提供されません。 これらのバージョンの Windows で、一部のドライバーは、コンポーネントのカスタムの電源制御を実装できますが、これらのコントロールは、通常、ドライバーに複雑さを追加し、コンポーネントの電源設定がデバイス内で制御される場合にのみ可能な場合があります。

Windows 8 以降、PoFx はコンポーネント レベルの電源管理のサポートを追加します。 これにより、いくつかのコンポーネントの電源の状態、F0、F1、および F0 が完全に状態を具合をサポートするためのドライバーができます。 すべてのコンポーネントは、F0 状態をサポートします。 デバイスのコンポーネントの電源ポリシー所有者 (PPO) であるドライバーは、追加、低電力 Fx 電源の状態、コンポーネントがありますを定義する責任を負います。 (通常は、デバイスの機能のドライバーは、PPO) です。このドライバーは、要素ごとの低電力 [fx] 状態の数と各 [fx] 状態の属性を決定します。 このドライバーを定義する [fx] 状態は、同じデバイスでコンポーネントからコンポーネントを異なる場合があります。

PoFx では、ドライバーがデバイスでのコンポーネントに関する状態と機能の情報を指定デバイス ドライバー インターフェイス (DDI) を提供します。 この情報には、各コンポーネントの現在のアクティビティ レベルから、もう 1 つの電源の状態と、コンポーネントは、低電力状態から再開すると、デバイスのクライアントが許容できる待機時間の量を変更するコンポーネントで必要な時間. さらに、PoFx は、コンポーネントが属するドメインの電源とクロックのドメインに関するシステム全体の情報を取得します。 (特定の電源のドメイン内のデバイスが一般的な電源レールを共有。 クロックの特定のドメイン内のデバイスは、一般的なクロック信号を共有します)。

この情報に基づき、PoFx は、コンポーネントが低電力状態を入力すると、入力する低電力状態についてのインテリジェントな決定を行います。 意思決定プロセスでは、他のコンポーネントとその他のデバイスからの情報が含まれ、デバイスとさまざまな電源とクロックのドメイン内のコンポーネント間の依存関係を考慮します。

## <a name="introduction-to-the-pofx-api-for-component-level-power-management"></a>コンポーネント レベルの電源管理の PoFX API の概要


ドライバーが呼び出す PoFx によって管理されるデバイスを登録する、 [ **PoFxRegisterDevice** ](https://msdn.microsoft.com/library/windows/hardware/hh439521)ルーチン。 ドライバーは、このルーチンを渡す、 [ **PO\_FX\_デバイス**](https://msdn.microsoft.com/library/windows/hardware/hh439585)他のデータの間での配列が含まれた構造体[ **PO\_[fx]\_コンポーネント**](https://msdn.microsoft.com/library/windows/hardware/hh439575)構造体。 この配列内の各要素には、デバイス内のコンポーネントの [fx] 電源の状態と各 [fx] 状態の属性について説明します。 (少なくとも、コンポーネント レベルの電源管理をサポートしていないコンポーネントを実装して F0 状態のみ。)によって、特定のコンポーネントの特定 [fx] 電源の状態の属性を記述、 [ **PO\_FX\_コンポーネント\_IDLE\_状態**](https://msdn.microsoft.com/library/windows/hardware/hh439581)構造は、次の値が含まれています。

-   移行遅延は、この [fx] 状態から F0 (完全に) 状態に遷移の作成に必要な時間。
-   これは、コンポーネントは必要があります価値のある状態に移行するには、この [fx] 状態に費やす時間を常駐要件。
-   この [fx] 状態で、コンポーネントによって消費される電力が供給されて公称電源。

PoFx について [fx] power 状態コンポーネントで特定の時点にあるのか、インテリジェントな決定を行う (その他のシステム全体の入力との依存関係を使用して) に加えて、この情報を使用します。 PoFx 競合する 2 つの目標のバランスを取る必要があります。 最初に、できるだけ小さな電源として使用するアイドル状態であるコンポーネントを構成する必要があります。 第 2 に、コンポーネントは、低電力状態に [fx] からに切り替える F0 速度では常に、常に接続されているデバイスの外観を維持するために準備する必要があります。

コンポーネント レベルの電源管理は、デバイスが、D0 (完全にオン) の電源状態のときにのみ実行できます。 D1 (ほぼオン)、D2 (ほとんどはオフ) または D3 の電源状態のデバイスがある場合は、デバイスにアクセスできません。 D0 状態で、デバイスがある場合、ドライバーがアクティブに使用しているコンポーネントのみを F0 状態に保つ必要があります。 アイドル状態のコンポーネントは、電力消費量を削減する低電力 [fx] 状態に切り替えることができます可能性があります。

デバイスは、D0 の電源状態では、ドライバーはコンポーネント レベルの電源管理を有効にする単純なプロトコルに従います。 ドライバーは、コンポーネントにアクセスする必要がある、ドライバーが呼び出し、 [ **PoFxActivateComponent** ](https://msdn.microsoft.com/library/windows/hardware/hh406650)コンポーネントへのアクセスを要求するルーチン。 コンポーネントが低電力状態に [fx] の場合、この呼び出しが発生した場合、PoFx は F0 状態への遷移を開始し、この移行が完了すると、ドライバーに通知します。 ドライバーは、コンポーネントにアクセスできます。 ドライバーは、コンポーネントにアクセスする必要がなくなった、ドライバーが呼び出し、 [ **PoFxIdleComponent** ](https://msdn.microsoft.com/library/windows/hardware/hh406717) PoFx に通知するルーチン。 この呼び出しに応答して、PoFx は、低電力状態に [fx] する可能性のあるコンポーネントを切り替えます。

アクセス可能なコンポーネントが、 *active 条件*します。 アクセスできるコンポーネントが、*アイドル状態が*します。 デバイスのコンポーネントのアクセシビリティを追跡するためには、PoFx は、各コンポーネントでのライセンス認証の参照カウントを保持します。 A **PoFxActivateComponent**呼び出しが 1 つずつ、指定したコンポーネントのカウントをインクリメントし、 **PoFxIdleComponent**いずれかでカウントをデクリメントを呼び出します。

場合、 **PoFxActivateComponent**呼び出しが 1 つをゼロからカウントをインクリメント、PoFx がアイドル状態からアクティブの状態への移行を開始し、この移行が完了すると、ドライバーに通知します。 場合、 **PoFxActivateComponent**コンポーネントが既にアクティブな状態で、コンポーネントがアクティブな状態のままし、ドライバーが通知を受信しないときに発生します。

場合、 **PoFxIdleComponent** 1 から 0 に、カウントをデクリメントを呼び出す、PoFx がアクティブな状態からアイドル状態の条件への移行を開始し、この移行が完了すると、ドライバーに通知します。 場合、 **PoFxIdleComponent**カウントをデクリメントを呼び出すが、カウントが 0 以外の場合、コンポーネントがアクティブな状態のままし、ドライバーが通知を受信しません。

アクティブ化の参照カウントは、同じのドライバーの 2 つ以上のコード パスがデバイスで同じコンポーネントを同時にアクセスする必要があります状況を処理する便利なことです。 この数を維持するには、コンポーネントへのアクセスを一元的に管理するドライバーを必要とせず、コンポーネントへのアクセスを個別に維持するために、ドライバーのさまざまな部分が可能 PoFx です。

コンポーネントのアクティブ/アイドル条件は、コンポーネントがアクセスできるかどうかを判断するためのドライバーの唯一の確実な手段です。 Fx 低電力状態に切り替えようとしてアイドル状態では F0 電源の状態にするコンポーネントがあります。

アクティブな状態になっているコンポーネントは、F0 状態は常にします。 コンポーネントでは、アイドル状態になるまで F0 のままにすることはできません。 アイドル状態にあるコンポーネントには、F0 または低電力状態に [fx] があります。 コンポーネントがある場合、低電力 Fx で状態を**PoFxActivateComponent**呼び出しがアイドル状態からアクティブな状態への移行を開始、PoFx は、まず、コンポーネントをアクティブな入力前に F0 にコンポーネントを切り替える必要があります条件。

## <a name="related-topics"></a>関連トピック

[デバイスの電源管理リファレンス](device-power-management-reference.md)  
