---
title: ときにする必要がありますコードとデータのページング
description: ときにする必要がありますコードとデータのページング
ms.assetid: 2804f558-8c8c-43f4-b14e-8deaac9da286
keywords:
- メモリ管理の WDK カーネル、ページング可能なドライバー
- ページング可能なドライバー WDK カーネルときに、ページングする必要があります
- オンデマンドでロックされているコードの WDK カーネル
- スピン ロック WDK メモリ
- 常駐コード WDK ページング可能なドライバー
ms.date: 06/16/2017
ms.localizationpriority: medium
ms.openlocfilehash: 39e91814a53983a408d72500fc1cc2311deeb2de
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63335257"
---
# <a name="when-should-code-and-data-be-pageable"></a>コードとデータをページング可能にすべき場合





行うことができます、ドライバーのすべてまたは一部ページング可能です。 ドライバー コードのページングと、ドライバーの読み込みのイメージ、その他の使用のシステムの容量を解放するのサイズを小さくできます。 モデム、Cd-rom などの散発的に使用されるデバイスのドライバーまたは呼び出されることはほとんどありませんドライバーの部分の最も実用的では。

次のいずれかのドライバーのコードは、メモリ常駐型である必要があります。 つまり、非ページのセクションで、またはコードの実行時にメモリにロックされているページのセクションではこのコードがあります。

-   実行と同じか上位 IRQL = ディスパッチ\_レベル。

-   スピン ロックを取得します。

-   などのルーチンのサポート、カーネルのオブジェクトのいずれかの呼び出し[ **KeReleaseMutex** ](https://msdn.microsoft.com/library/windows/hardware/ff553140)または[ **KeReleaseSemaphore**](https://msdn.microsoft.com/library/windows/hardware/ff553143)、これで、 *待機*にパラメーターが設定されている**TRUE**します。 カーネルが呼び出された場合*待機*に設定**TRUE**、呼び出しをディスパッチで IRQL で返します\_レベル。

IRQL でドライバーのコードを実行する必要があります&lt;ディスパッチ\_レベル、ページ フォールトを発生コードで何もすることがあります。 場合は、次のいずれかのコード ページ フォールトが発生することができます。

-   アクセスはページ メモリでロックされていないプールです。

-   ページング可能なルーチンを呼び出します。

-   アクセスは、ユーザー スレッドのコンテキストでユーザー バッファーのロックを解除します。

通常、すべてのページング可能なコード (またはデータ) の合計量が、少なくとも 4 キロバイト (KB) の場合にページ セクションをする必要があります。 可能であれば、コード (またはデータ) から別のセクションをページング可能な場合がありますが、場合によってロックされている必要がありますにページング可能な純粋なコード (またはデータ) を分離する必要があります。 たとえば、ページング可能な純粋なコードとオンデマンドでロックされているコードを組み合わせることより多くのシステム領域をロックダウンする結合のセクションが必要です。 ただし、ドライバーの可能性があるページング可能なコード (またはデータ) の 4 KB 未満の場合、そのオンデマンドでロックされているコード (またはデータ) に 1 つのセクションでは、システムの領域の節約のコード (またはデータ) を組み合わせることがあります。

 

 




