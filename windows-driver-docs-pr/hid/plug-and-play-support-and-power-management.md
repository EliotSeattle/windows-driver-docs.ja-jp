---
title: プラグ アンド プレイ I2C のサポート
description: このセクションでは、上、I²C HID をサポートするデバイスのプラグ アンド プレイのサポートについて説明します。
ms.assetid: 2D51B1B7-345E-4311-81D6-8A14CE2B44FE
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 2c8ab4e5227671e191e68336422157605adfaa75
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63372988"
---
# <a name="plug-and-play-support-for-i2c"></a>プラグ アンド プレイ I2C のサポート


このセクションでは、HID を I²C トランスポート経由でサポートするデバイスのプラグ アンド プレイのサポートについて説明します。

### <a name="driver-loading"></a>ドライバーの読み込み

Windows では、ハードウェア識別子と、INF の間の互換性のある識別子の一致に基づいて I²C の HID クラス ドライバーを読み込みます。 識別子は、Advanced Configuration and Power Interface (ACPI) によって生成されます。 ACPI I²C デバイス ノードでは、ハードウェア id が生成されます。 すべて HID I²C 互換性のあるデバイスは、互換性識別子の一意のハードウェア識別子だけでなくを公開する必要があります。

ACPI 5.0 仕様には、クラスの HID デバイスのサポートが含まれています。 HID I²C の ACPI 定義は次のとおりです。

|                           |                                             |             |                                                 |                                                                                      |
|---------------------------|---------------------------------------------|-------------|-------------------------------------------------|--------------------------------------------------------------------------------------|
| フィールド                     | 値                                       | ACPI オブジェクト | 表記                                          | コメント                                                                             |
| 互換性 ID             | PNP0C50                                     | \_CID       | ACPI0C50 または PNP0C50 の形式を文字列します。     | CompatibleID                                                                         |
| Hardware ID (ハードウェア ID)               | ベンダー固有                             | \_非表示       | VVVVdddd (例: NVDA0001) の形式の文字列します。 | VendorID + DeviceID                                                                  |
| サブシステム                 | ベンダー固有                             | \_SUB       | VVVVssss (例: INTL1234) の形式の文字列します。 | SubVendorID + SubSystemID                                                            |
| ハードウェアのリビジョン         | ベンダー固有                             | \_HRV       | 0xRRRR (2 バイト リビジョン)                         | リビジョン Id                                                                           |
| リソースの現在の設定 | ベンダー固有                             | \_CRS       | バイト ストリーム                                     | I2CSerialBus と GPIO を含める必要があります\_I2C コント ローラーの INT、GPIO とそれぞれの割り込み |
| デバイスの特定のメソッド    | GUID {3CDFF6F7-4267-4555-AD05-B30A3D8938DE} | \_DSM       | パッケージ化                                         | HID の記述子のアドレスを格納する構造体を定義します。                        |

 

HID I²C のすべてのデバイスでは、次の必須フィールドを指定する必要があります。

-   互換性 ID
-   Hardware ID (ハードウェア ID)
-   ハードウェアのリビジョン
-   リソースの現在の設定
-   デバイスの特定のメソッド

Advanced Configuration and Power Interface (ACPI) 5.0 仕様の追加情報を参照してください。

次に示します互換性 Id とハードウェア Id の例のランダムな I²C の HID デバイス。 これらの詳細は、「ベンダー固有」クラスの 1 つの最上位のコレクションでの HID として報告するサンプル デバイスに基づいています。

高度な Configuration and Power Interface (ACPI) には、HID I²C トランスポート ドライバーの読み込みを次のハードウェア Id と互換性のある Id が生成されます。

|                                      |                        |
|--------------------------------------|------------------------|
| ハードウェア Id                 | 互換性のある識別子 |
| ACPI\\Vid\_xxxx & Pid\_yyyy & Rev\_zzzz; | ACPI\\PNP0C50          |
| ACPI\\Vid\_xxxxPid\_yyyy;            |                        |
| ACPI\\xxxxyyyy;                      |                        |

 

前の例では、ハードウェア ID から抽出された値を使用して生成された、\_サンプル デバイスを ACPI の HID メソッド。 抽出された値を使用して互換性のある ID が生成された、 \_CID ACPI メソッドのサンプル デバイスです。 I2C 経由での HID の互換性のある ID は、バージョン 1.0 の PNP0C50 を常にある必要があります。

**注**  前の表の左の列でのハードウェア識別子を使用する、INF を指定する場合のみ必要があります。 (使わない互換性のある識別子を右側の列。)

 

HIDClass.sys コンポーネントによって生成されたクライアントの HID デバイス ノードのハードウェア ID は次のとおりです。

|                                                      |                       |
|------------------------------------------------------|-----------------------|
| ハードウェア Id                                  | 互換性のある識別子 |
| HID\\VEN\_MSFT & DEV\_0010 & REV\_0002 & Col01;            | なし                   |
| -HID\\VEN\_MSFT&DEV\_0010&Col01 HID\\MSFT0010&Col01; | なし                   |
| -HID\\\*MSFT0010Col01                                | なし                   |
| -HID\_デバイス\_アップ: FF 00\_U:0001;                       | なし                   |
| -HID\_デバイス                                         | なし                   |

 

ハードウェア ID では、HIDClass.sys によって生成され、すべてのトランスポートと同じです。 この識別子は、(ACPI から抽出された) HIDI2C.sys から HIDClass.sys に渡される値に基づいています。

### <a name="device-enumeration-sequence"></a>デバイスの列挙体シーケンス

1 回 I²C の HID デバイス ドライバー (HIDI2C します。Sys) が読み込まれる、I²C バス経由でデバイスと通信を開始します。 ドライバーを実行する最初の操作は、デバイスの列挙体シーケンスです。

次の一覧は、列挙体シーケンスを示しています。 この一覧の順序が将来のバージョンの Windows で変更される可能性ことに注意してください。

1.  システム BIOS から I²C デバイスを非表示には、ACPI ASL コードを取得します。
2.  デバイスからは、HID 記述子を取得します。
    -   HID 記述子のアドレスを書き込み
    -   読み取り記述子を非表示

3.  一連の発行\_デバイスの電源。
    -   セットを書き込む\_電源コマンド

4.  リセットの発行 (ホストには、リセットが開始された) デバイスにします。
    -   [リセット] コマンドを書き込む
    -   デバイスは、GPIO 割り込みをアサートします。
    -   入力のレジスタから値 (0x00 0x00) の読み取り

5.  デバイスからのレポート記述子を取得します。
    -   レポート記述子のアドレスを書き込み
    -   レポートの記述子を読み取る

エラー値を持つ HIDI²C ドライバーを読み込むことがあります、ホストは、デバイスには、手順 1 ~ 5 のいずれかを正常に完了する失敗した場合、*コード 10*します。 これらのコマンドのいずれかに組み込まれている再試行ロジックはありません。

**注**  I²C で時間を最適化するために並列では、手順 4 と 5 を行うことができます。 レポート記述子は (a) は、静的および (b) には長いため、Windows 8 は、4 で、デバイスからの応答を待っているときに 5 に対して要求を発行可能性があります。

 

### <a href="" id="supported-hid-i2c-commands"></a>サポートされている HID I²C コマンド

HIDI2C します。SYS ドライバーは、次のコマンドをサポートしています。

|                 |                                                |                                                                                                                                                                                                       |
|-----------------|------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| コマンド         | 使用方法                                  | 使用する場合                                                                                                                                                                                        |
| リセット           | Windows では、ホストが開始したリセットをサポートします。     | Windows はこのコマンドを発行、次のシナリオ - デバイスの初期化中に - 有効/無効にする - アンインストール/再インストール                                                                         |
| Get/set\_レポート | Windows は、取得/設定をサポートしている\_レポート コマンド。 | Windows は、HID クライアント ドライバーは HID クライアント ドライバーは、同期入力/出力レポートを発行するときに取得/設定機能のレポート要求 - を発行するときに、次のシナリオでは、このコマンドが発行されます。 |
| 設定\_電源      | セットをサポートする Windows\_コマンドの電源        | Windows がシステムの低電力 S3 に遷移/、システムがシャット ダウン時にスタンバイ状態 - 接続されている場合は、次のシナリオでの中にこのコマンドを発行します。                               |

 

 

 




