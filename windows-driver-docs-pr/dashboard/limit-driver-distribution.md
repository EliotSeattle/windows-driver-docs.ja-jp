---
title: ドライバーの配布を拡張する
description: ドライバーの配布を変更するために、ドライバー申請の下限や上限を作成します。
ms.topic: article
ms.date: 10/02/2018
ms.localizationpriority: medium
ms.openlocfilehash: dbcd3bf1e34fe324f04c42819476a2d54c5bfaba
ms.sourcegitcommit: 71c90354f7e2d88498e28f74fb1b34748edf82ac
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/04/2019
ms.locfileid: "66491760"
---
# <a name="limiting-driver-distribution-by-windows-versions"></a>Windows のバージョンによってドライバーの配布を制限する

IHV、OEM、ODM では、Windows Update でのドライバーの配布対象を特定の Windows バージョンの範囲に変更しなければならないことがよくあります。 たとえば、ドライバーが次のような状況になっている場合があります。

* 特定のバージョンの範囲で、既知の問題が発生する。

* ドライバーを展開して、最新のドライバーを最新バージョンの Windows に配布すると共に、過去のバージョンの Windows で発生する問題を修正する必要がある。

* ドライバーの配布対象を、以前または最新バージョンの Windows、あるいはより新しいバージョンの Windows に拡張する。

こうした配布の範囲は、**下限**と**上限**によって定義されます。 下限はドライバーが配布される最も古い Windows バージョンを示し、上限は最新バージョンを示します。 下限と上限を追加することによって、ドライバーの配布を制限できます。 下限と上限は、以下のドライバー申請の形式について、パートナー センターの[出荷ラベル](https://docs.microsoft.com/windows-hardware/drivers/dashboard/manage-driver-distribution-by-submission)で指定します。

* .HLKX
* .HCKX
* .CAB

> [!NOTE]
> 管理者、配送先住所ラベルの所有者、および配送先住所ラベルのプロモーターだけが、ドライバー申請の下限と上限を設定できます。

## <a name="floor-and-ceiling-types"></a>下限と上限の種類

下限と上限は、以前または最新バージョンの Windows OS、あるいはより新しいバージョンの Windows OS に適用されます。
HDC ダッシュボードでサポートされている下限と上限には、次の 2 つの種類があります。

| 下限/上限の種類 | 説明 |
| -- | -- |
| OS リリース ベース | <ul><li>認定されている Windows OS バージョン以外の Windows バージョンにドライバーを拡張または制限するために使用します。</li><li>一般向けにリリースされるドライバー用の下限/上限の種類です。</li></ul> |
| ビルド番号ベース | <ul><li>より新しいバージョンやリリースされていないバージョンの Windows 用にドライバーを開発するときに使用されます。 </li><li>Microsoft の共同エンジニアリング パートナーのみが利用できます。</li></ul> |

## <a name="setting-floors-and-ceilings-for-your-driver-distribution"></a>ドライバーの配布に関する下限と上限の設定

1. 配送先住所ラベルを作成し、ラベルの名前、発行元、ターゲットに関する詳細情報を入力します。 詳細については、「[Windows Update にドライバーを公開する](https://docs.microsoft.com/windows-hardware/drivers/dashboard/publish-a-driver-to-windows-update)」を参照してください。

2. **[PNP を選択]** で、公開するハードウェア ID とオペレーティング システムの組み合わせを選択します。 下限はハードウェア ID ごとに設定できますが、上限は同じ配送先住所ラベル内のすべての ID に適用されることに注意してください。 また、選択した最も古いオペレーティング システムが、ラベルの下限として自動的に選択されます。 

## <a name="restricting-driver-distribution-using-floors-and-ceilings"></a>下限と上限を使用したドライバー配布の制限

ドライバーの配布を制限することによって、OS の最小または最大レベルを設定できます。 構成証明の申請については、申請時に選択したオペレーティング システムを初期の最小 OS として使用します。 最小 OS レベルをドライバーの認定 OS レベルより下位に設定することはできません。 これらの初期の最小レベルより下位に設定するには、最初に拡張 (下記参照) を使用する必要があります。

### <a name="os-flooring"></a>OS の下限
*(最小 OS 要件)*

このオプションは、一覧表示されているオペレーティング システム以上でのみ、ドライバーを提供する場合に使用します。 たとえば、RS4 を下限として選択すると Windows 10 1803 (RS4) 以上を実行しているシステムにのみ、このドライバーが提供されることを意味します。

### <a name="os-ceiling"></a>OS の上限  
*(最大 OS 要件)*

*注: この機能へのアクセスは制限されています。*

> [!IMPORTANT]
> * OS の上限は、新しい OS で、ドライバーの基本的な機能に影響を与える重要な変更があった場合にのみ設定してください。 OS の上限を要求する場合は、ビジネス上の正当な理由が必要です。
> * 上限のオプションは、Windows 10 をターゲットとするハードウェア ID に対してのみ有効になります。またこのオプションは、 **[PNP を選択]** の選択領域で [公開] をクリックした後でのみ有効になります。
> * 選択する上限は、選択されている PNP よりも上位のバージョンになっている必要があります。

このオプションは、一覧表示されているオペレーティング システム以下でのみ、ドライバーを提供する場合に使用します。 たとえば、Windows 10 1607 RS1 認定ドライバーについて、RS3 を上限として選択すると、Windows 10 1803 (RS4) 以上を実行しているシステムにドライバーは提供されません。

最小 OS レベルは、製品の認定 OS レベル、つまり構成証明された OS レベルによって決まります。  これよりも下位のレベルを指定する必要がある場合は、後で説明する、ドライバーの拡張を使用します。

## <a name="driver-expansion"></a>ドライバーの拡張

> [!IMPORTANT]
> ドライバーの配布を拡張する場合は、以下の点に注意してください。
> * 共有された申請は拡張できません。 自分が申請したドライバーのみを拡張できます。
> * 拡張は、申請ごとに一度だけ実行することができ、元に戻すことはできません。 どうしても必要な場合にのみ、ドライバーの配布を拡張してください。
> * 拡張は、ドライバーにのみ実行できる場所、 [ **INF 製造元セクション**](../install/inf-manufacturer-section.md) [BuildNumber] を使用して*TargetOSVersion*装飾します。
> * 拡張された申請に関連付けられているすべての出荷ラベルには、**Windows 10 クライアント バージョン 1506 および 1511 (TH1)** をターゲットとして使用できる新しい PNP HWID の一覧が表示されます。 
> * これらの新しく作成された項目の認定レベルは、"拡張" と表示されます。
> * Windows 10 システムをターゲットとして上位拡張できるのは Windows 8.1 ドライバーのみです。  
> * 拡張によって、ドライバーを再署名することや、ドライバーの認定のレベルを変更することはできません。

ドライバー申請の拡張プロセスにより、製品の認定レベルまたは構成証明された OS レベルより下位のオペレーティング システムをターゲットにすることができます。 Windows 8.1 ドライバーを Windows 10 システムに提供することもできます。  Windows 10 では、[**INF Manufacturer セクション**](../install/inf-manufacturer-section.md)で [BuildNumber] *TargetOSVersion* 装飾 (NTamd64.10.0...**14393** など) が使用されている場合、**拡張**は実行されません。

たとえば、Windows 10 RS3 (1709) ドライバーを Windows 10 RS1 (1607) に提供できるようにしたい場合は、 **[拡張]** をクリックします。 これにより、すべての INF にリストさているすべての HWID に対し、新しいベースライン オペレーティング システムの選択肢が作成されます。  このベースラインは、**Windows 10 クライアント バージョン 1506 および 1511 (TH1)** として表示され、[認定済み] セクションに "**拡張**" と表示されます。  これ以降、ベースライン OS は常に Windows 10 1506 (TH1) となり、これが初期の OS ターゲット ポイントとなります。

![ドライバーの拡張オプションのスクリーンショット。](images/new-pnp-nodes.png)

OS の下限を RS1 に引き上げるには、上記で示した Floor 機能を使用します。  目的の**拡張済み** HWID　を選択し、[公開] をクリックします。  

> [!NOTE]
> 上記の例では、Windows 10 RS3 をリストする HWID を公開する必要はありません。  これは、OS Floor の下限を RS1 に設定するためです。  **拡張済み**のドライバーは、下限の開始点より上位に該当する、すべてのオペレーティング システムに正しく提供されます。  つまり、RS1、RS2、RS3 などに提供されます。Windows 10 RS3 (1709) を対象とするドライバーが選択されているときに、下限を RS1 に設定しようとすると、ターゲット OS の下限を上位に引き上げるよう求めるエラーが返されます。 

## <a name="faq"></a>FAQ

**どのような場合に、既にリリースされている Windows のバージョンについて下限や上限を指定する必要がありますか?**

*既存のドライバーが、将来のバージョンの Windows に配布されるのを防ぐ場合に行います。たとえば、リリースされていないバージョンの Windows をターゲットとする代替ドライバーを開発している場合です。*

**どのような場合に、共同エンジニア リング ドライバー (近日公開予定) について下限や上限を指定する必要がありますか?**

*場合によっては、現在開発中のバージョンの Windows に関連する依存関係がドライバーに含まれているときは、そのバージョンの Windows を下限として指定する必要があります。*

**ドライバーの認定よりも古い Windows バージョンをターゲットにするにはどうすればよいですか?**

*上記の「ドライバーの拡張」セクションの例を参照してください。*

**申請全体を拡張できないのはなぜですか?**

*申請内の各 INF は、拡張について個別に評価されます。一部またはすべての INF の **INF Manufacturer セクション** で [BuildNumber] TargetOSVersion 装飾が使用されている場合、その INF を拡張する処理は失敗します。申請を拡張する必要がある場合は、まず INF を編集して [BuildNumber] を削除する必要があります。[BuildNumber] が含まれない INF は正常に処理されます。*
