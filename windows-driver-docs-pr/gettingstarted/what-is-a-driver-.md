---
title: ドライバーとは
description: ドライバーとは
ms.assetid: 8a5f51e3-ff5a-4b5d-aa9d-d94b431ee9f7
keywords:
- ドライバーの定義
- ドライバーの定義
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: a79779e6d34b80a250b1d176a8085cfdf5e23bbc
ms.sourcegitcommit: 5598b4c767ab56461b976b49fd75e4e5fb6018d2
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2020
ms.locfileid: "63371235"
---
# <a name="what-is-a-driver"></a>ドライバーとは


"*ドライバー*" という用語を一言で正確に定義するのは難しいことです。 最も基本的な定義では、ドライバーとはオペレーティング システムとデバイスの間で相互のやり取りを可能にするソフトウェア コンポーネントのことです。 たとえば、あるアプリケーションでデバイスからデータを読み取る必要がある場合を考えてみます。 アプリケーションはオペレーティング システムで実装された関数を呼び出し、オペレーティング システムはドライバーで実装された関数を呼び出します。 デバイスの設計と製造をした会社が作ったドライバーであれば、デバイス ハードウェアとやり取りする方法を認識してデータを取得します。 ドライバーがデバイスからデータを取得した後、データはオペレーティング システムに返され、さらにアプリケーションへと返されます。

![アプリケーション、オペレーティング システム、ドライバーの関係図](images/whatisadriver01.png)

## <a name="span-idexpanding_the_definitionspanspan-idexpanding_the_definitionspanspan-idexpanding_the_definitionspanexpanding-the-definition"></a><span id="Expanding_the_definition"></span><span id="expanding_the_definition"></span><span id="EXPANDING_THE_DEFINITION"></span>定義の拡大


ここまでの説明は、次のような点でかなり簡略化されています。

-   すべてのドライバーが、必ずしもデバイスを設計した会社によって作られているわけではない。 多くの場合、デバイスは、公開されたハードウェア標準に基づいて設計されています。 つまり、ドライバーは Microsoft で作成できるため、デバイスの設計会社はドライバーを提供しなくても済むということです。

-   すべてのドライバーがデバイスと直接やり取りできるとは限らない。 ある I/O 要求 (たとえばデバイスからのデータ読み取り) があった場合、この要求に関連するいくつかのドライバーが 1 つのスタック上に重なって置かれることがよくあります。 スタックの状態を視覚的に捉えるために、以下の図のように、最初の関連ドライバーが最上位に、最後の関連ドライバーが最下段にそれぞれ置かれているイメージにたとえる方法がよく用いられます。 スタック中のドライバーには、要求の形式を別の形式に変換することにより、やり取りに関与するものもあります。 これらのドライバーは、デバイスとは直接のやり取りを行いません。単に要求を操作して、スタックで下段に位置するドライバーにその要求を渡すだけです。

    ![アプリケーション、オペレーティング システム、3 つのドライバー、デバイスの関係図](images/whatisadriver02.png)

    スタック中でデバイスと直接やり取りを行うドライバーを "*ファンクション ドライバー*" と呼びます。また補助的な処理を実行するドライバーを "*フィルター ドライバー*" と呼びます。

-   フィルター ドライバーには、I/O 要求に関する情報の監視や記録を行うが積極的には関与しないものもある。 たとえば、検証ツールとして動作し、スタック中の別のドライバーが I/O 要求を適切に処理しているかどうかを確認するフィルター ドライバーがあります。

したがって、"*ドライバー*" とは、オペレーティング システムとデバイス間のやり取りの監視や、これに関与するあらゆるソフトウェア コンポーネントであると定義することにより、その意味を拡大解釈することができます。

## <a name="span-idsoftware_driversspanspan-idsoftware_driversspanspan-idsoftware_driversspansoftware-drivers"></a><span id="Software_drivers"></span><span id="software_drivers"></span><span id="SOFTWARE_DRIVERS"></span>ソフトウェア ドライバー


拡大解釈した定義はかなり正確ですが、ドライバーによってはハードウェア デバイスにまったく関与しないものあるという意味で、まだ完全ではありません。 たとえば、カーネル モードでコードを実行しない限りアクセスできないオペレーティング システムのコア データ構造にアクセスするツールを作る例を考えてみます。 これは、ツールを 2 つのコンポーネントに分割することで可能になります。 1 つ目のコンポーネントは、ユーザー モードで実行され、ユーザー インターフェイスを提供します。 2 つ目のコンポーネントはカーネル モードで実行され、オペレーティング システムのコア データにアクセスします。 ユーザー モードで実行されるコンポーネントをアプリケーション、またカーネル モードで実行されるコンポーネントを*ソフトウェア ドライバー*と呼びます。 ソフトウェア ドライバーはハードウェア デバイスに関連付けられません。 プロセッサ モードについて詳しくは、「[ユーザー モードとカーネル モード](user-mode-and-kernel-mode.md)」をご覧ください。

次の図は、ユーザー モード アプリケーションとカーネル モード ソフトウェア ドライバーのやり取りを示したものです。

![アプリケーションとソフトウェア ドライバーの関係図](images/whatisadriver03.png)

## <a name="span-idadditional_notesspanspan-idadditional_notesspanspan-idadditional_notesspanadditional-notes"></a><span id="Additional_notes"></span><span id="additional_notes"></span><span id="ADDITIONAL_NOTES"></span>追加説明


ソフトウェア ドライバーは常にカーネル モードで実行されます。 ソフトウェア ドライバーを作る主な理由は、カーネル モードでのみ利用可能な保護データへのアクセスを取得することです。 とはいえ、デバイス ドライバーがカーネル モードのデータやリソースへのアクセスを常に必要とするわけではありません。 そのため、一部のデバイス ドライバーはユーザー モードで実行されます。

この段階でまだ触れていない種類のドライバーがあります。*バス ドライバー*です。 バス ドライバーについて理解するには、まずデバイス ノードとデバイス ツリーの概念を理解しておく必要があります。 デバイス ツリー、デバイス ノード、バス ドライバーについて詳しくは、「[デバイス ノードとデバイス スタック](device-nodes-and-device-stacks.md)」をご覧ください。

ここまでの説明は、*ファンクション ドライバー*の定義を簡略化したものです。 既に、デバイスのファンクション ドライバーは、デバイスと直接やり取りを行う、スタック中のドライバーであることを説明しました。 このことは、Peripheral Component Interconnect (PCI) バスに直接接続されたデバイスにも当てはまります。 PCI デバイスのファンクション ドライバーは、デバイスのポートとメモリ リソースにマッピングされたアドレスを取得します。 ファンクション ドライバーは、これらのアドレスに書き込むことにより、デバイスと直接やり取りします。 ただし、デバイスが PCI バスに直接接続されることはあまりありません。 デバイスは、通常、PCI バスに接続されたホスト バス アダプターに接続されます。 たとえば、USB トースターは、PCI バスに接続されたホスト バス アダプター (USB ホスト コントローラーと呼ばれる) に接続します。 USB トースターにはファンクション ドライバーがあり、USB ホスト コントローラーにも同様にファンクション ドライバーがあります。 トースターのファンクション ドライバーは、USB ホスト コントローラーのファンクション ドライバーに要求を送ることにより、トースターと間接的にやり取りします。 それから、USB ホスト コントローラーのファンクション ドライバーはトースターとやり取りする USB ホスト コントローラーのハードウェアと直接やり取りします。

![USB トースター ドライバーと USB ホスト コントローラー ドライバーの図](images/whatisadriver04.png)

 

 





