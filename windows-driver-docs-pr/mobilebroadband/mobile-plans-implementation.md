---
title: Mobile の計画の実装
description: このトピックでは、Mobile プラン プログラムの実装手順について説明します。
ms.assetid: 283E45EF-D421-429B-A9AF-BED64BB670B0
keywords:
- Windows Mobile の計画の実装、Mobile の計画の実装モバイル演算子
ms.date: 09/17/2018
ms.topic: article
ms.prod: windows-hardware
ms.technology: windows-devices
ms.openlocfilehash: f28374cc27e63dd16044cc28f700d8971db4b974
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56557608"
---
# <a name="mobile-plans-implementation"></a>Mobile の計画の実装

[!include[Mobile Plans Beta Prerelease](../mobile-plans-beta-prerelease.md)]

このトピックでは、MO 直接ポータル デザインのポリシーとモバイルのプランだけでなく、プランのモバイル アプリでお客様のエクスペリエンスをホストする Web サービス API を実装するために必要な作業を使用するためのガイダンスについて説明します。

## <a name="mo-web-portal"></a>月の web ポータル

MO 直接 web ポータルは、プランのモバイル アプリでホストされている、精選された web エクスペリエンスでの Windows ユーザーに直接接続ソリューションを提供するモバイルの演算子を使用できます。 次のポリシーを設計、web エクスペリエンスを作成してアクセスできるようにする web サービス API を実装する必要があります。 

Web ポータルのフローとリファレンスのデザインに関する詳細については、次を参照してください。 [Web ポータルのフローとリファレンスのデザイン](mobile-plans-appendix.md#web-portal-flow-and-reference-design)します。

### <a name="web-service-api-hosting-mo-direct-web-portal"></a>Web サービス API ホスティング MO 直接 web ポータル 

プランのモバイル アプリを使用して、 [WebView](https://docs.microsoft.com/uwp/api/Windows.UI.Xaml.Controls.WebView) MO の直接のエクスペリエンスをホストするコントロール。 アプリは、プランのモバイル サービスによって返されるコンテンツのみを信頼します。

WebView を開始するときに、 *EID*、*市場*、前後*ICCID*は、使用可能な場合に渡されます。 Esim 状の場合は、これら 3 つの起動パラメーターは、次の例です。

```c#
MyWebView.ScriptNotify += MyWebView_ScriptNotify;

List<Uri> allowedUris = new List<Uri>();

allowedUris.AddRange(AllowedNotifyUris);

MyWebView.AllowedScriptNotifyUris = allowedUris;

MyWebView.Navigate(“https://moportal.com?eid=\”eid\”& iccid=8988247000100003319&market=us&transactionId=cvcvcv&location=us”);
```

次の例は、物理 SIM の起動パラメーターを示します: *iccid*、*市場*、および*場所*します。 前のコード行は、簡潔にするための excised されています。

```c#
...

MyWebView.Navigate(“https://moportal.com? iccid=8988247000100003319&market=us&transactionId=waoigFfX00yGH3Vb.1&location=us”);
```

Web サービス API には、プランのモバイル アプリから受信する追加のパラメーターを無視する必要があります。 これには、プランのモバイル エクスペリエンスを損なうことがなく新機能を導入するための柔軟性が提供します。 新しいパラメーターが実装されている場合は、パートナーが通知されます新しいパラメーターの事前に。

次の表では、eSIM と物理 Sim で使用できる起動パラメーターについて説明します。

| パラメーター名 | 説明 | 例 |
| --- | --- | --- |
| eid | Esim 状は識別子であります。 これは、eSIM が存在する場合にのみ送信されます。 | `eid= 89033024010400000100000000009136` |
| Iccid | 物理 SIM の必須パラメーターです。 Esim 状の省略可能なパラメーター。 使用可能な ICCID の物理 sim を指定します。 | `iccid=8988247000100003319` |
| いる iccid | 省略可能なパラメーター。 ESIM のみで利用可能なプロファイルからの ICCID の一覧を指定します。 ICCID の MO、esim 状で使用可能な一致しない場合は、このパラメーターは送信されません。 | `iccids=8988247000100003319, 988247000100003555` |
| location | ユーザーの country レベルの粒度で物理的な場所現在。 | `location=us` | 
| transactionId | セッションのデバッグに使用するトランザクション ID。 プロバイダーは、これにログインし、通知ペイロードで送信する必要があります。 最大サイズは、64 文字です。  | `transactionId=waoigFfX00yGH3Vb.1` |
| market | PC の地域設定の 2 文字の ISO コード。 | `market=us` |

ユーザーの言語設定は、次の表で説明されている Accept-language ヘッダーを使用して送信されます。

| ヘッダー名 | 説明 | 例 |
| --- | --- | --- |
| Accept Language | ユーザーの現在の言語設定。 MO ポータルでは、可能であれば、指定した言語でコンテンツをレンダリングする必要があります。 | `Accept-Language: en-us` |

### <a name="mo-direct-flow-diagram"></a>月を直接フロー図

MO 直接 esim 状の次のような高度なフロー図は、ユーザーが、MO プロファイルがインストールされていないし、MO ポータルからのプランの購入は、シナリオを示しています。

<img src="images/dynamo_implementation_mo_direct_flow_no_profile.png" alt="MO Direct flow where user has no MO profile" title="月を直接フローをユーザーに月のプロファイルがありません。" width="800" />

次の図は、ときに、ユーザーが eSIM プロファイルまたは物理 SIM を使用して自分のデバイスでは、MO ダイレクト フローの概要を示します。

<img src="images/dynamo_implementation_mo_direct_flow_with_sim.png" alt="MO Direct flow where user has an eSIM or physical SIM" title="ユーザーが、eSIM または物理 SIM が持っている月の直接のフロー" width="400" />

### <a name="control-handoff-to-the-mobile-plans-app"></a>プランのモバイル アプリにコントロールのハンドオフ

ユーザーを正常に購入を行う、購入をキャンセルするか、購入フローの完了後、MO ポータルは、プランのモバイル アプリにコントロールを返す必要があります。 これは、MO ポータルを使用したユーザーの操作の結果と、アプリに通知を発行することによって行います。 次の構文で JavaScript を使用して、通知を送信できます。

```javascript
DataMart.notifyPurchaseResult(notificationPayload);
```

Esim 状の通知ペイロードの例は次のとおりです。

```json
{
"ver":"1",
"purchaseResult":
“{
\"userAccount\":\"New\",
\"purchaseInstrument\":\"New\",
\"line\":\"New\",
\"moDirectStatus\":\"Complete\",
\"planName\":\"MyPlan\"
}”,
"success":true,
"Iccid":"8988247000100297655",
"activationCode":"activationCode",
"transactionId":"CDE2882E-BD5E-485F-B921-D0D60BBCF7FF"
}
```

物理 SIM の通知ペイロードの例は次のとおりです。

```json
{
"ver":"1",
"purchaseResult":
{
\"userAccount\":\"New\",
\"purchaseInstrument\":\"New\",
\"line\":\"New\",
\"moDirectStatus\":\"Complete\",
\"planName\":\"MyPlan\"
},
"success":true,
"iccid":”8988247000100297655”,
"transactionId":"CDE2882E-BD5E-485F-B921-D0D60BBCF7FF"
}
```

通知の送信元となる MO ポータル URI は、セキュリティで保護された https プロトコルでなければなりません。 次の表では、通知の JSON ペイロード内の各フィールドについて説明します。

| JSON フィールド | 種類 | 説明 | 例 |
| --- | --- | --- | --- |
| 成功 | ブール値 | ユーザーが、MO Direct プランを購入した場合は true。 | `“success”:true` |
| Iccid | String | Esim 状、購入月ダイレクト プランを使用するために、クライアントが使用する必要があります ICCID を示します。 | `iccid:”8988247000100297655”` |
| activationCode | String | アクティブ化コード esim 状のプロファイルを取得します。 | `“ActivationCode”` |
| transactionId | String | トランザクション ID、MO ポータルのポータルを起動したときに、クエリ パラメーターとして受信します。 | `transctionId= rRi8OzhI3EiR02nm.2.0.1` | 
| purchaseResult | JSON | MO ポータルを使用したユーザーの操作の詳細が含まれています。 |   |
| & #93 | 列挙型 | このフィールドは必須です。 <p>設定可能な値:</p><ul><li>新規:新しいユーザー アカウントがユーザーによって作成されたことを示します。</li><li>既存の。既存のユーザー アカウントでユーザーをログオンすることを示します。</li><li>内緒。ユーザーがこの手順で購入のフローを終了したことを示します。</li><li>None:ユーザーがこのステップに到達していないことを示します。</li></ul> | `“userAccount”:”New”` |
| purchaseInstrument | 列挙型 | このフィールドは必須です。 <p>設定可能な値:</p><ul><li>新規:新しいユーザー アカウントがユーザーによって作成されたことを示します。</li><li>既存の。既存のユーザー アカウントでユーザーをログオンすることを示します。</li><li>内緒。ユーザーがこの手順で購入のフローを終了したことを示します。</li><li>None:ユーザーがこのステップに到達していないことを示します。</li></ul> | `“purchaseInstrument”:”New”` |
| 行 | 列挙型 | このフィールドは必須です。 <p>設定可能な値:</p><ul><li>新規:ユーザー アカウントは、SIM カードが追加されたことを示します。</li><li>既存の。示すこと、転送された既存の行をデバイスにします。</li><li>内緒。ユーザーがこの手順で購入のフローを終了したことを示します。</li><li>None:ユーザーがこのステップに到達していないことを示します。</li></ul> | `“line”:”New”` |
| moDirectStatus | 列挙型 | このフィールドは必須です。 <p>設定可能な値:</p><ul><li>完了します。ユーザーが購入を正常に完了したことを示します。</li><li>サービス エラー:ユーザーが月のサービス エラーのための購入を完了できなかったことを示します。</li><li>InvalidSIM:ポータルに渡される ICCID が正しいことを示します。</li><li>LogOnFailed:ユーザーが、MO ポータルへのログインに失敗したことを示します。</li><li>PurchaseFailed:課金エラーのために、購入が失敗したことを示します。</li><li>ClientError。引数が無効ですが、ポータルに渡されたことを示します。</li><li>BillingError:ユーザーの課金でエラーがあったことを示します。</li></ul> | `“moDirectStatus”:”Complete”` |
| プラン名 | String | 成功したトランザクションで、このフィールドがないを空にする、プランのわかりやすい名前を指定する必要があります。 失敗したトランザクションでは、このフィールドは空の文字列を指定する必要があります。 | `“planName”:”prepaid_3GperMonth”` |

### <a name="web-portal-design-policies"></a>Web ポータルのデザインのポリシー

Windows 上の最適なユーザー エクスペリエンスのために、このセクションでは、ポリシーに従う必要があります、MO の直接のエクスペリエンスを開発するときにします。 これらのポリシーは、Mobile プラン パートナー補遺の条件を補助[Windows アプリ開発者契約](https://msdn.microsoft.com/library/windows/apps/hh694058)と[Microsoft Store ポリシー](https://msdn.microsoft.com/library/windows/apps/dn764944)します。

#### <a name="business-functions"></a>ビジネス関数

| ポリシー | 必要なまたは推奨 |
| --- | --- |
| 月の直接のエクスペリエンスは、提供されている国で該当するすべての法律、規制要件を満たす必要があります。 MO 直接ポータルに表示される任意のコンテンツは、すべての法律に準拠する必要があります。 | 必須 |
| MO 直接エクスペリエンスを通じて提供される製品は、ネットワークへの接続プランである必要があります。 | 必須 |
| ユーザーが購入フローが完了したら、MO 直接エクスペリエンスを通じて提供されるネットワーク接続の製品をすぐにアクティブにする必要があります。 | 必須 |
| ネットワーク接続の製品、MO 直接エクスペリエンスを通じて提供されるサービスの詳細についてはクリアが必要です。 サービスの特定の条件は、ユーザーが月の直接のエクスペリエンスで購入する前に確認できるである必要があります。 | 必須 |
| カスタマー サポート連絡先情報は、月の直接のエクスペリエンスでユーザーにアクセスできなければなりません。 | 必須 |
| プライバシー ポリシーは、月の直接のエクスペリエンスを確認するユーザーである必要があります。 | 必須 |
| アカウント管理のエクスペリエンスが、月、月の直接のエクスペリエンス、別および専用のアカウント管理ポータルでは、または専用 MO アプリ内でできるによって提供されるには、キャンセルなど、現在のデータ プランで操作を実行するユーザーが有効にする必要があります、サブスクリプション。 | 必須 |
| ユーザーは、MO 直接経験からのデータ プランを正常に購入した後、注文の確認を受け取ります。 | 推奨 |


#### <a name="security"></a>セキュリティ

| ポリシー | 必要なまたは推奨 |
| --- | --- |
| 月の直接のエクスペリエンスの配信またはサード パーティが所有しているまたはブランド化されたアプリやモジュールをインストールする必要がありますできません。 | 必須 |
| ユーザーは、月の直接のエクスペリエンスを終了する前にユーザー必要がありますに安全にログアウトされます、MO 直接ポータルから。 | 必須 |
| 月の直接のポータル URI と、すべての要求または MO 直接ポータルからの通知は、セキュリティで保護された HTTPS プロトコルを使用する必要があります。 | 必須 |
| すべての月のポータルのリソースと参照は、セキュリティで保護された HTTPS プロトコルを使用する必要があります。 | 必須 |

#### <a name="advertising"></a>広告

| ポリシー | 必要なまたは推奨 |
| --- | --- |
| 任意の提供情報、スポンサー コンテンツ、ビデオ、大きいイメージ、アニメーション、またはマップ、MO 直接ポータルを表示しないでください。 | 必須 |

#### <a name="capabilities"></a>機能

| ポリシー | 必要なまたは推奨 |
| --- | --- |
| MO 直接エクスペリエンスの必要な最低限の機能では、携帯電話会社に登録されているアカウントを使用してデータ プランを購入するユーザーを有効にします。 | 必須 |
| MO 直接ポータルすぐに開始されると、ユーザー、ユーザーが月の直接のエクスペリエンスを終了するまでの入力に応答性を維持する必要があります。 | 必須 |
| 起動後、MO 直接ポータルし、されるまで、ユーザーのフォーカスを保持する必要があります。 <ul><li>月を直接フローが完了し、フォーカスが、プランのモバイル アプリに Mobile 演算子によって返されました。</li></ul><p>または</p><ul><li>ユーザーには、MO を直接フローが取り消されました。</li></ul> | 必須 |
| MO 直接ポータルのポップアップ ウィンドウを表示する必要がありますはない、他のウィンドウを開くまたは購入フローを完了するためを除く他の web サイトやアプリ、ユーザーをリダイレクトは。 | 必須 |
| すべての正当なエラーと、支払いの拒否などの例外を処理する必要があります、MO 直接ポータル バックエンドの障害などです。エラーまたは例外を処理すると、後に、MO 直接ポータルを終了し、Microsoft Store に戻るユーザーの応答性を維持する必要があります。 | 必須 |
| ユーザーが実行にユーザーの操作で解決できるとエラーが発生する場合は、通信事業者のカスタマー サポート情報と、エラー メッセージを表示することをお勧めします。 | 推奨 |

#### <a name="usability"></a>ユーザビリティ

| ポリシー | 必要なまたは推奨 |
| --- | --- |
| 月の直接のポータルの既定のフレーム サイズは、800 x 600 です。 月の直接のポータルのコンテンツは、ユーザー プランのモバイル アプリのサイズを変更するときに、web コントロールのフレームに収まるように自動調整できるように、レスポンシブ web デザインを採用します。 | 必須 |
| 読み込み時間と月の直接のエクスペリエンスを読み込むためのデータの消費量を最適化する必要があります。 | 必須 |
| MO 直接経験する必要がある単純なと簡単に必要な画面上に移動ガイドライン。  | 必須 |
| MO ダイレクトでポータルがこのプランのモバイル アプリをユーザーが混乱しないか、ユーザーを示す統合まとまりのあるエクスペリエンスを提供する必要がありますに UI 要素は、組み込み web コントロールです。 たとえばが必要ありません、MO 直接ポータル内でボタンを閉じる/最大/最小です。 | 必須 |
| 月の直接のポータルで web ページのレイアウトは、クリーンで移動が簡単に必要があります。 ユーザーでは、後方に移動でき、MO 直接エクスペリエンス内での UI 要素を持つ、MO 直接ポータル内の web ページ間を転送することができます。 詳細については、次を参照してください。 [Web ポータルのフローとリファレンスのデザイン](mobile-plans-appendix.md#web-portal-flow-and-reference-design)します。 | 必須 |
| MO 直接ポータルは、Web コントロール フレーム内で機能する必要があり、いつでもプランのモバイル アプリでのユーザーの操作で干渉する必要がありますいない、呼び出されるとします。 | 必須 |
| 多数の画像、バナー、長いテキスト、外部リンクなどの MO 直接ポータルを乱雑いない必要があります。 | 必須 |
| 画面に表示される、MO 直接エクスペリエンス内で [キャンセル] ボタンがユーザー フロー該当する場合を終了するために使用できる必要があります。 | 推奨 |
| 携帯電話会社は、最適な配色とフォントを表すブランドを選択できます。 すべてのビジュアル要素が連携して動作し、ブランドを補強を確認してください。 | 推奨 |

#### <a name="localization"></a>ローカライズ

| ポリシー | 必要なまたは推奨 |
| --- | --- |
| MO 直接ポータルを受信し、適切な言語でコンテンツを表示するユーザーのロケール設定プランのモバイル サービスによって渡されるを理解することがあります。 | 必須 |
| モバイル演算子をサポートする言語で月の直接のポータルのローカライズ可能性があります。 | 推奨 |
| MO 直接ポータルによって提供されるエクスペリエンスは、データ プランの可用性はリージョン間で変更できますが、サポートされるすべての言語である程度のようなります。 | 推奨 |

#### <a name="accessibility"></a>アクセシビリティ

| ポリシー | 必要なまたは推奨 |
| --- | --- |
| MO 直接ポータルは、ユーザー補助機能を無効になっているユーザーに提供し、携帯電話会社が実装し、月の直接のエクスペリエンスを実現管轄区で適用可能なアクセシビリティのガイドラインに従う必要があります。 | 推奨 |