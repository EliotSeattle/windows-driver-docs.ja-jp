---
title: マスター クロック
description: マスター クロック
ms.assetid: bdd228c1-a15f-4c08-8991-299a3f2e1ee8
keywords:
- マスターのクロックの WDK カーネル ストリーミング
- 同期 WDK カーネルのストリーミング
- KSPROPERTY_STREAM_MASTERCLOCK
- 物理的なタイム WDK カーネルのストリーミング
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 24681511618126434518572d67e8c4141bbaf3e7
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63364878"
---
# <a name="master-clocks"></a>マスター クロック





その他のミニドライバー; によって作成されたクロックにストリームを同期できるは、ミニドライバー複数のストリームは、1 つのクロックに同期できます。 場合は、暗証番号 (pin) を使用または生成など、*マスター クロック*、ミニドライバーをサポートする必要があります[ **KSPROPERTY\_ストリーム\_MASTERCLOCK**](https://msdn.microsoft.com/library/windows/hardware/ff565713)します。 またクライアントは、pin のマスターの時計を設定するのにこのプロパティを使用できます。 マスターの表示と操作を頻繁にキャプチャを実行するピンが使用されます。 ミニドライバーは、終了時にクロックの参照を解放します。

マスターの時計をインターフェイスは、メソッド、プロパティおよびイベントをサポートするファイル オブジェクトです。

ファイル オブジェクトに対してすべてのクエリはパッシブでのみご利用いただけます\_レベル。 ただし、ディスパッチに使用可能な関数の直接呼び出しポインターを通じてサポートされても、クロック位置クエリ\_レベルで、ファイル オブジェクトが有効な限り有効です。 この直接呼び出しは、クロックのファイル オブジェクトをコンテキスト パラメーターとして渡す必要があります。

ファイル ハンドルが pin の作成は IRP を同様に、フィルターの暗証番号 (pin) インスタンスの作成要求を通じて取得した\_MJ\_作成します。 要求では、独自のコンテキスト情報と、pin のファイル ハンドルが作成されますにだけ作成するには、ファイル ハンドルが発生します。 このファイル ハンドルは、呼び出し元に渡されます、カーネル モードのフィルターのマスターの時計を設定するために使用できます。 フィルターは、グラフのマスター クロック割り当てられている同時に、暗証番号 (pin) のインスタンスは、マスターのクロックが所有しているかどうかを決定する親のファイル オブジェクトを照会できます。

フィルターには、このマスター クロックにファイル ハンドルを指定した場合と、クエリのプロパティを使用し、できます。 マスターのクロックはカーネル モードのフィルターに基づいている場合は、マスターのクロックのカーネル モードの部分へのファイル ハンドルを照会するインターフェイスがサポートする必要があります。 インターフェイスはサポートされていないと見なされますクロックがユーザー モードに基づくし、カーネル モードのフィルターが同期できないこと場合です。

マスターのクロックを要求する DirectShow プロキシのフィルター処理し、その基になるカーネル モード フィルター ファイル ハンドルに渡します。 カーネル モードのフィルターは、基になるファイル オブジェクトを参照します。 マスターのクロックは、既にフィルターにある場合、ファイル オブジェクトを逆参照し、新しいハンドルを使用します。 これを行うには、フィルターである必要があります*停止状態*します。

マスターのクロックのオブジェクトの物理的な時間では、頻繁にハードウェア ベースです。 ストリームの時間が示されているデータのタイムスタンプに従って進行し、マスターの時計を表示するフィルターは物理クロックがあるない場合。 このような場合は、タイムスタンプは、データがないのために停止可能性があります。

マスターのクロックの背後にある物理的な時間は正確な測定値を提供するローカルのプロキシの役割は後者は入力が、リモート可能性があります。 たとえば、プロキシは、1394 接続では、遅延の補正またはネットワーク上で、遅延の平均を計算の責任を持ちます。 さらに、別のカーネル フィルターが同じ 1394 バス上の 2 つ目のデバイス用のプロキシの場合は、2 つのデバイスがインターフェイスのプライベート メソッド マスターのクロックとネゴシエートします。 このような場合は、デバイスは、互換性を確認するには、クロックの型を決定するプライベート インターフェイスを使用する必要があります。

 

 




