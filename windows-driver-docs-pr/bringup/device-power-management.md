---
title: デバイス電源管理
description: ACPI 5.0 仕様には、デバイスのデバイスの電源の情報を指定する名前空間のオブジェクトのセットが定義されています。
ms.assetid: F57AD5A0-F459-4A20-BDBE-87C30CF957B3
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: bc8b420f2d84b7c9342bfab10303f761dfc22da3
ms.sourcegitcommit: 3cdabbe0af52459e484e093a9e11da8f5312daf6
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 03/26/2019
ms.locfileid: "58441931"
---
# <a name="device-power-management"></a>デバイス電源管理

[ACPI 5.0 仕様](https://www.uefi.org/specifications)デバイスのデバイスの電源の情報を指定する名前空間のオブジェクトのセットを定義します。 たとえば、オブジェクトの 1 つのセットは、各サポートされているデバイスの電源状態のデバイスで必要な電源リソースを指定できます。 別のオブジェクト型では、ハードウェアのイベントに応答低電力状態から復帰するデバイスの機能を記述できます。

## <a name="device-power-management-in-windows"></a>Windows でのデバイスの電源管理

システムの実行中に (つまり、ACPI 定義作業の状態、S0 がシステム)、個々 のデバイスが電力を節約の利用状況に応じて、デバイスの電源状態の間で切り替えを行うためです。 従来の PC システムでスリープ ACPI 定義 (S1 S4 から) を示す power がこれらの状態は Windows SoC プラットフォームでは使用されません切断された、待機時間の長いスリープの保存にも使用されます。 そのため、バッテリの寿命は、プラットフォームでの実行時のデバイスの電源管理の実装方法に大きく依存します。

SoC に統合されているデバイスは、電源管理対象 Windows Power フレームワーク (PoFx) を使用できます。 これらのフレームワークに統合されたデバイスは、SoC の電源と時計コントロールの詳細を知っている PoFx、SoC 固有 power エンジン プラグイン (microPEP) 経由で電源管理です。 PoFx の詳細については、次を参照してください。 [、電源管理フレームワークの概要](https://msdn.microsoft.com/library/windows/hardware/hh406637)します。

SoC に統合されていない周辺機器は、Windows は、ACPI デバイスの電源管理を使用します。 これら ACPI で管理されたデバイスのデバイス ドライバー スタック (通常は関数またはクラス ドライバー) の電源ポリシー所有者はデバイスの電源状態遷移の決定をおよび[ACPI の Windows ドライバー](https://msdn.microsoft.com/library/windows/hardware/ff540493)Acpi.sys、呼び出す ASL コントロール必要なプラットフォーム固有の電源制御を適用するメソッド。

> [!NOTE]
> 、することができますし、一部のデバイス スタックには、ACPI デバイスの電源管理を使用して、単独、または、microPEP と組み合わせて: SoC にデバイスの電源管理のため。

」の説明に従って[ACPI のデバイスの電源管理](https://docs.microsoft.com/windows-hardware/drivers/bringup/device-power-management#device-power-management-in-acpi)Windows は、ACPI 5.0 仕様で定義されている D3cold 電源管理機能をサポートしています。 このサポートを使用すると、デバイス、プラットフォームおよびドライバー オプトインできるデバイスの電源が実行時のアイドル時間中に完全に削除します。 この機能は、バッテリの寿命を大幅に改善できます。 ただし、電源を削除する必要がありますでサポートされなければすべて影響を受けるコンポーネント D0 を正常に完了するには。 このため、ドライバー (バスおよび関数) と、プラットフォーム自体には、示す必要がありますそれをサポートすることです。 D3cold ドライバー オプトインの詳細については、次を参照してください。[ドライバーではサポートしている D3cold](https://msdn.microsoft.com/library/windows/hardware/hh967717)します。

## <a name="device-power-management-in-acpi"></a>ACPI のデバイスの電源管理

Namespace デバイス サポートに最大 4 つデバイスの電源状態を D0 番号が付けられます (完全な関数、または「オン」) D3 に (しない関数、または [オフ])。 各状態別の電源の要件、番号の小さい方の状態よりも電力消費を抑え、それ以上の状態を持つことができます。 さらに、(状態 off) D3 には、2 つのサブ状態 D3hot と D3cold があります。 D3hot サブ状態には、bus 固有のソフトウェアのコマンドに応答できるように、親バス上でアクセス可能のままにデバイスが必要です。 この要件とそれを満たすために使用される電力は、D3cold で削除されます。 デバイスを活用して、ハードウェア イベントのための低電力状態から復帰自体に最後に、および必要に応じて、アイドル状態からも、プラットフォームにします。

プラットフォームでは、D3cold のサポートを示しますの OS のコントロールを付与することで、"\_PR3 サポート"機能 (ビット 2) プラットフォーム全体にわたる OSPM 機能メソッドを使用して要求されたときにします。 詳細については、セクション 6.2.10.2、「プラットフォーム全体にわたる OSPM 機能」を参照してください、 [ACPI 5.0 仕様](https://www.uefi.org/specifications)します。

電源管理対象デバイスでは、子オブジェクトを使用して、オペレーティング システムの電源機能について説明します。 次のセクションでは、これらの機能とオブジェクトについて説明します。

### <a name="power-resources-and-states"></a>電源リソースと状態

デバイスは、その状態にするために必要な電源リソースのセットを一覧表示して、電源状態のサポートを宣言します。 ACPI Power リソースでは、デバイスとそれらをクロック信号の電源の電圧のレールを表します。 これらのリソースは、名前空間のルートに宣言されます。 各 power リソースには、 \_ON と\_メソッドが制御を無効と\_STA メソッドの状態を報告します。 詳細については、のセクション 7.1 では、「を宣言する、Power リソース オブジェクト」を参照して、 [ACPI 5.0 仕様](https://www.uefi.org/specifications)します。

[ACPI の Windows ドライバー](https://msdn.microsoft.com/library/windows/hardware/ff540493)Acpi.sys は、リソースを共有するデバイス間での電源の依存関係を監視し、これらのデバイスには、電源の状態間の遷移が、として確実で実際に必要な電源リソースのみをデバイスが特定の時点に点灯します。

#### <a name="power-resource-requirements-prx"></a>リソース要件の電源 (\_PRx)

電源のリソース要件がある (\_PRx) オブジェクトを x = 0、1、2、または 3 の各サポートされているデバイスの電源状態。 デバイス ドライバーは、新しい電源状態への移行を決定したら、新しい状態のために必要なすべての power リソースは、上になっていることと、使用されていないすべてのリソースがオフになっている Acpi.sys によって確認されます。

<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>サポートされているデバイスの状態</th>
<th>リソース要件のオブジェクトを使用するには</th>
<th>オブジェクトの要件に含めるリソース</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D0 (必須)</td>
<td>_PR0</td>
<td><p>すべての電源とデバイスの完全な機能に必要なクロック。</p></td>
</tr>
<tr class="even">
<td>D1</td>
<td>_PR1</td>
<td><p>電源またはクロックに必要なクラス定義機能制限のこの状態。</p></td>
</tr>
<tr class="odd">
<td>D2</td>
<td>_PR2</td>
<td><p>電源またはクロックに必要なクラス定義機能制限のこの状態。</p></td>
</tr>
<tr class="even">
<td>D3hot (必須)</td>
<td>_PR2</td>
<td><p>サポートされている (D2、D1 または D0) は、次の高い状態と同じリソース。</p></td>
</tr>
<tr class="odd">
<td>D3cold</td>
<td>_PR3</td>
<td><p>のみ、電源やそのバス上に表示され、バスに固有のコマンドに応答するデバイスに必要なクロック。</p></td>
</tr>
</tbody>
</table>

 > [!NOTE]
 > 特定のプラットフォームが、D3cold 機能をサポートしているデバイスのデバイス ドライバー opts に D3cold、デバイスの場合\_PR3 power リソースは、他のデバイスで使用されてはいない場合はオフになります D3hot への移行されてからしばらくします。

D3cold をサポートするデバイスの電源のリソース要件の詳細については、次を参照してください。 [D3cold のファームウェア要件](firmware-requirements-for-d3cold.md)します。

#### <a name="device-power-state-psx"></a>デバイスの電源状態 (\_PSx)

電源状態のメソッドがあります\_PSx、位置 x = 0、1、2、または 3 の各サポートされているデバイスの電源状態 Dx します。 このメソッドは省略可能では、存在する場合は、電源状態のリソースをオンにした後、power リソースの状態がオフで、前に呼び出されます。 \_PSx は電源サイクルの前後に必要な任意のプラットフォームに固有の操作を実行するためのものです。 \_PSx にする必要があります関数ドライバーに割り当てられているデバイスの登録、バス ドライバーに割り当てられているか、オンまたはオフ、Acpi.sys 用に予約操作があるリソースを電源に切り替えますアクセス bus standard レジスタ アクセスできません。

### <a name="wake-capabilities"></a>ウェイク アップ機能

電源管理対象デバイスを低電力状態のときにイベントを検出し、それらを処理するウェイク アップするプラットフォームが発生することがあります。 この機能を有効にするのには、Windows には、プラットフォームとデバイスの両方の機能に関する情報が必要があります。

#### <a name="sx-device-wake-state-sxw"></a>Sx デバイス ウェイク状態 (\_SxW)

特定のプラットフォームでは、ウェイク アップ機能をサポートするデバイスの状態とウェイク イベントに対応できる、システム状態の間の特定のマッピング。 ACPI の定義、 \_SxW オブジェクトは、オペレーティング システムにこの情報を提供します。 各サポートされているシステム電源の状態、Sx SxW オブジェクトがあります。 ここで関心のある唯一のオブジェクトは、SoC プラットフォームは、常に S0 に、ため\_S0W します。 このオブジェクトには、デバイスのスリープ解除シグナルへの応答で低電力アイドル状態から復帰するプラットフォームの機能を指定します。 オブジェクトは、アイドル状態のシステムによる低電力の中に、デバイスのターゲット D 状態を判断する、Windows によって使用されます。 詳細については\_S0W、7.2.20 を参照してください"\_S0W (S0 デバイス ウェイク状態)"で、 [ACPI 5.0 仕様](https://www.uefi.org/specifications)します。

ほとんどの SoC プラットフォームでは、デバイスがアイドル状態のときに、D3 状態を積極的に電源管理し、システムでは、デバイスがこの状態中に、低電力アイドル状態から復帰の。 このようなシステムの場合、 \_S0W オブジェクトは、3 (または 4、D3cold もサポートしている場合) を返します。 ただし、D 状態は、最下位の電源スリープ解除できる状態として指定でき、一部のデバイス クラスまたはバスさまざまな値を使用します。 たとえば、SDIO と USB で接続されたデバイスは、この状態の D2 の状態を使用します。

> [!NOTE]
> Windows 7 から Windows 8 または Windows 8.1 のデバイス ドライバーの移行を容易にデバイスを指定する必要があります\_S4W もします。 現時点では、この要件を持つ唯一のデバイス クラスでは、(Ndis.sys) をネットワークです。

#### <a name="wake-capable-interrupts-crs"></a>ウェイク アップできる割り込み (\_CRS)

デバイスのリソースの説明は、デバイスが検出して、割り込み「ウェイク対応」としてマークすることで、ウェイク イベントをシグナル化できることを示します (ExclusiveAndWake または SharedAndWake)。 Windows およびデバイス ドライバーは、デバイスが省電力状態に移行するときに有効にすることを確認するには、このような割り込みの特別な処理を提供します。 詳細については、の 6.4.3.6 セクション、「拡張 Interrupt 記述子」、およびセクション 6.4.3.8.1、「GPIO 接続記述子」で割り込みおよび GpioInt リソース記述子の説明を参照してください、 [ACPI 5.0 仕様](https://www.uefi.org/specifications).

### <a name="wake-enablement"></a>ウェイク アップの有効化

ユーザーのシナリオまたはシステムのポリシーに応じてウェイク対応デバイスは可能性があります。 または可能性がありますいない実際が武装 wake の。 そのため、ウェイク対応の割り込みは可能性があります。 またはデバイスがアイドル状態のときにいない有効な場合があります。 割り込みを有効にするだけでなく、Windows は、デバイスのスリープ解除を有効にするのに、次のメカニズムを使用します。

#### <a name="device-sleep-wake-dsw"></a>デバイスのスリープ ウェイク (\_DSW)

ACPI の定義、\_オペレーティング システム、[次へ] のスリープ状態または低電力アイドル状態の期間について、ACPI プラットフォーム ファームウェアに通知するための手段として DSW オブジェクト。 このオブジェクトは省略可能で、プラットフォームのプラットフォームに固有のウェイク アップ ハードウェアを事前に構成する必要がある場合にのみ使用されます。 ターゲット デバイスの D 状態と、システムのターゲットの状態は、どちらも提供されます。 D 状態と S 状態の組み合わせに、デバイスのによって提供される情報は常に従っている\_SxW オブジェクト。

#### <a name="power-resources-for-wake-prw"></a>リソースの電源スリープ解除 (\_PRW)

場合によっては、リソースの追加の電源スリープ解除を有効にするデバイスのにする必要があります。 この場合、デバイスを提供できます、 \_PRW これら追加の電力のリソースを一覧表示するオブジェクト。 [ACPI の Windows ドライバー](https://msdn.microsoft.com/library/windows/hardware/ff540493)Acpi.sys、リソースを管理するこれらの電源は通常、それ以外の場合オフ、電源を入れている (つまり、スリープ解除が有効なデバイス)、デバイスで必要なことを確認します。

\_ウェイク アップ機能を定義する PRW を使用しても従来 (全 ACPI ハードウェア) PC プラットフォーム。
