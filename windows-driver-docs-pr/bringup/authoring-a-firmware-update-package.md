---
title: ファームウェアの更新プログラム パッケージの作成
description: 各ファームウェアの更新プログラム パッケージには、全体のファームウェア ペイロード (たとえば firmware.bin) を含む単一のバイナリ ファイルと Windows を使用して firmware.bin を検証するセキュリティのカタログが含まれています。
ms.assetid: 672F5E45-C0AB-4C19-BB0A-C8B5A66D8EED
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 17c60c67efed5d39be872796a725615dae02daa4
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56537842"
---
# <a name="authoring-a-firmware-update-package"></a>ファームウェアの更新プログラム パッケージの作成


各ファームウェアの更新プログラム パッケージには、全体のファームウェア ペイロード (たとえば firmware.bin) を含む単一のバイナリ ファイルと Windows を使用して firmware.bin を検証するセキュリティのカタログが含まれています。 セキュリティ カタログとドライバーの詳細については、[カタログ ファイルとデジタル署名](https://msdn.microsoft.com/library/windows/hardware/ff537872)と[PnP ドライバー パッケージのカタログ ファイルを作成する](https://msdn.microsoft.com/library/windows/hardware/ff540161)を参照してください。

ファームウェアの更新プログラム パッケージは、1 つ以上の次の種類のファームウェアを更新できる必要があります。

-   UEFI システム ファームウェア。
-   システム内の 1 つのデバイスのファームウェア。

各ファームウェアの更新プログラム パッケージのターゲット (UEFI システム ファームウェアまたは 1 つのデバイス) は、1 つのファームウェア リソースもありますが、1 つのファームウェアの更新プログラム パッケージ システム ファームウェアと 1 つの両方を更新すると便利ですがお勧めまたはより多くのデバイス。

**注**  デバイスは、1 つ以上のファームウェア更新プログラム パッケージの対象となることはできません。 ファームウェアの更新パッケージもシステム ファームウェアが含まれますが、デバイスが対象である場合は、のみ、デバイスを対象とする 2 つ目のファームウェア更新プログラム パッケージで対象ことはできません。

 

1.  ファームウェアの更新パッケージを適切なシステムのハードウェアに Windows サーフェスのファームウェアの更新の各エントリでは、このようなデバイスのインスタンスが ESRT エントリに属するものとして識別されているハードウェア ID を公開、ESRT デバイス インスタンスを対象にできるようにします。

2.  ファームウェアの更新パッケージがインストールされている場合は、Windows によってドライバー パッケージとして処理されます。 Windows は、各更新プログラム パッケージのファームウェアのペイロードをシステム ディレクトリの下の安全な場所にコピーは、ファームウェアの更新プログラムを実行し、システムが再起動をトリガーするシステムを準備します。

    Windows は、ドライバー パッケージ間の依存関係をサポートしていません。 そのため、新しいファームウェアの更新プログラム パッケージを作成するときに、次の要件に従ってください。

    -   ファームウェアの更新プログラム パッケージは、自身とその他のデバイスのファームウェア、システム ファームウェア、またはその他のファームウェアの更新プログラム パッケージに依存せず、正常にインストールできる必要があります。
    
    -   各更新プログラム パッケージがシステムに 1 つのデバイスや UEFI システム ファームウェアが (、ESRT で定義) を対象とことをお勧めします。
    
    -   各更新プログラム パッケージは、1 つのファームウェア更新プログラム バイナリ (firmware.bin など) を含める必要があります。

3.  各更新プログラム パッケージのファームウェア更新プログラムのペイロードは、単一のバイナリ ファイルに含める必要があります。 システム再起動時に OS ローダーが各ファームウェア更新プログラム バイナリ ファイルの各ファームウェアの更新プログラム パッケージを物理メモリにロードし、インストール用にプロビジョニングされた各ペイロード ファイルへのポインターの配列を構築 (UEFI 2.3.1 仕様として、この配列を指す、CapsuleHeaderArray)。

4.  この配列は、EFI UpdateCapsule() 関数への呼び出しで渡されます。 UpdateCapsule() は、各ドライバー パッケージのファームウェア更新プログラムのペイロードをプラットフォーム ファームウェアに渡して、メールボックスとして使用されます。

5.  各 capsule (ファームウェアの更新プログラム ペイロード) は、ファームウェアのリソースに対して ESRT エントリで指定したファームウェア ID によって識別されます。

6.  各ファームウェアの更新プログラムのペイロードを受信すると、ファームウェアの更新要求が処理され、該当する場合に適用します。

    CapsuleHeaderArray 内の各エントリは、システムで単一のデバイス、ファームウェア ドライバー パッケージからファームウェア更新プログラムのペイロードを含むデータの単一の連続したブロックです。 各ファームウェアの対象となるリソースは、ファームウェアの更新プログラムのペイロードは、ファームウェア イメージと検証のためのプラットフォームで必要なすべての情報を含める必要があります。

    ファームウェアのペイロードのファームウェア更新のすべてのドライバー パッケージは、プラットフォーム ファームウェアに UEFI UpdateCapsule サービスを介して渡されます。 統合デバイスは、さまざまな異なる Ihv から取られます、ために、システムの OEM (および場合によって SoC 製造元) は、特定のシステムのデバイス ファームウェアの更新プログラムが適切に作成されたことを確認するには、これら Ihv を直接操作する必要があります。 さらに、システム OEM ESRT エントリが適切なシステムを対象とする UpdateCapsule パッケージを許可することを確認する必要があります。

    たとえば、いくつかの Oem は、システムの同じモデル モバイル ブロード バンド (MBB) デバイスを選択する可能性があります。 MBB デバイスは各システムと同じですが、各 OEM が、システム用にカスタマイズされたファームウェア更新プログラム パッケージを作成する MBB IHV と共同作業する必要があります。 このレベルのデバイス ファームウェアの更新のカスタマイズは、OEM のシステム間でアドレス変数を必要があります。

    -   OEM、SoC. にデバイスを接続する方法を選択した SoC に基づいて異なる場合があります、デバイスのアドレス指定
    
    -   システムの OEM は、コンシューマーへの再販用複数のモバイル ネットワーク オペレーター (MNOs) にシステムを販売する可能性があります。 MBB デバイス MNO 非対応で、カスタマイズおよび特定 MNO の要件に認定されるファームウェアを必要とする必要があります。
    
    -   複数世界各国で、それぞれ異なる RF 規制と無線周波数の割り当て、システムを販売できる可能性があります。 MBB デバイスのファームウェアには、これらの市場の要件を満たすためにカスタマイズが必要です。

    各 OEM はする必要があります慎重にこのようなデバイスに固有の要件を考慮し、そのデバイスのファームウェアを対象として、適切に更新できることを確認するために必要な手順を実行します。 これは、デバイスのファームウェアをことを確認する ESRT エントリの慎重な管理を適切に展開が必要です。

7.  更新プログラム パッケージを作成すると後、認定および署名のため Microsoft に提出する必要があります。

## <a name="related-topics"></a>関連トピック
[ファームウェアのドライバー パッケージを使用してシステムとデバイスのファームウェア更新プログラム](system-and-device-firmware-updates-via-a-firmware-driver-package.md)  
[ESRT テーブルの作成](populating-the-esrt-table.md)  
[異なる地理的領域のファームウェアをカスタマイズします。](customizing-firmware-for-different-geographic-regions.md)  
[認定と更新プログラム パッケージの署名](certifying-and-signing-the-update-package.md)  
[更新プログラムのインストール](installing-the-update.md)  



