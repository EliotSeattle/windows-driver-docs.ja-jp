---
title: 移植の準備
description: 移植の準備
ms.assetid: 355CD834-6B64-4E6F-AA17-AE1145F269CA
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 7b8e6378c1812d196336edfa63c8fed3b69252b9
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56539055"
---
# <a name="preparing-for-porting"></a>移植の準備


いくつかの方法でドライバーを変換 WDM Windows Driver Frameworks (WDF) には移植よりも多くの再実装します。 これは、難しいことも、予想どおりに時間がかかります。 WDM ドライバーのハードウェアに固有のコードのほとんどは、一部のさまざまなオブジェクト型が使用されますが比較的そのまま保持ことができます。 WDF の既定値を置き換える WDM ドライバーが必要な定型コードの多くは、プラグ アンド プレイの特に — WDF I/O キャンセル (および関連付けられている競合条件) などのドライバーの実装の多くの厄介な側面の組み込みのサポートを提供しますとシステム電源の状態遷移します。

ドライバーを移植するときに、次の一般的なガイドラインが適用されます。

-   参照してください、[サンプル](https://go.microsoft.com/fwlink/p/?linkid=256387)します。 WDF は、サンプルでは、ほとんどは、同様に名前付き WDM ドライバーのポートの豊富なセットに付属します。
-   段階的に動作します。 フレームワークは、I/O、プラグ アンド プレイ、電源管理、および WMI の要求の既定の動作を実装しているため、コードし、一度に 1 つのデバイスまたはドライバーの機能をデバッグできます。
-   カーネル モード ドライバー フレームワーク (KMDF) のデバッグに使用する詳細なトレース ログを提供する WMI イベントのトレースを実装します。
-   多くの状況では、WDF の既定値は、既存 WDM ドライバーよりもより多くの機能の実装がある場合がありますを指定します。 ポートを試みる前に、コードを複雑な: 同期またはキューの管理に特に — WDF の提供する特定します。 ドライバーの移植に費やした時間の非常に長い時間に保存する場合があります。
-   固有 WDF を使用して[拡張機能をデバッガー](debugger-extensions-for-kmdf-drivers.md) Windows Driver Kit (WDK) に含まれます。
-   有効にする、 [KMDF verifier](using-kmdf-verifier.md)または[UMDF verifier](using-umdf-verifier.md)デバッグ中にします。

## <a name="wdm-driver-analysis"></a>WDM ドライバーの分析


、デバイスと関連するドライバーの種類に関係なく、ドライバーで I/O のフローを理解すること、ドライバーの移植で最も重要な問題です。 コードの記述を開始する前に、既存の WDM ドライバーを慎重に分析します。 これらの質問に回答できる必要があります。

-   ドライバーが必要、デバイス オブジェクトの数とどのようなドライバーの役割 (FDO、PDO、フィルター操作を行います) フィルタが表すでしょうか。 ほぼすべてのケースでは、WDF ドライバーは WDM ドライバーとしても、同じ種類とデバイス オブジェクトの数に使用されます。
-   どの I/O 要求、ドライバーをサポートする必要がありますか。
-   ドライバーでそれらの要求の必要があるの数のキューですか。 これらのキューの特性を挙げてください。
-   さまざまな I/O の処理を実行できる同時に、し、シリアル化する必要がありますか。
-   どの I/O は、ドライバーが完了して、下位のスタックを渡すことが要求でしょうか。

これらの質問に対する回答は、WDF ドライバーの中核を構成する方法を決定が I/O 処理を行う、どのような種類の同期、ドライバーを必要とする、WDF オブジェクト I/O を実行するドライバーを作成する必要があります。 ドライバーは、ハードウェアをサポートする場合は、デバイスも十分に理解する必要があります。

-   デバイスは、割り込みを生成しますか。
-   ハードウェアは DMA モデル (ある場合) をサポートしますか。 ドライバーは、DMA を必要とする場合は、KMDF ドライバーを記述する必要がありますに注意してください。
-   ドライバーは、スタックがデバイスの電源ポリシーを管理しますか。

最後に、ドライバーは、WMI (も KMDF のみ) をサポートする場合は、エクスポートし、WMI コールバック ドライバーで必要なデータを収集する方法を理解する必要があります。

 

 





