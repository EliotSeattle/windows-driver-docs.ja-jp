---
title: ドライバーの脅威モデリング
description: ドライバーの作成者と設計者は、あらゆるドライバーの設計プロセスで脅威モデリングを必須にする必要があります。 この記事では、Microsoft Windows ファミリのオペレーティング システム用のドライバーの脅威モデルを作成するためのガイドラインを提供します。
ms.assetid: 77FB242E-A07C-4298-80ED-866F8D80118C
ms.date: 06/27/2018
ms.localizationpriority: medium
ms.openlocfilehash: 5f73ebe4951c171b0558cf75f143dea3b301912a
ms.sourcegitcommit: fb7d95c7a5d47860918cd3602efdd33b69dcf2da
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/25/2019
ms.locfileid: "67371992"
---
# <a name="threat-modeling-for-drivers"></a>ドライバーの脅威モデリング

ドライバーの作成者と設計者は、あらゆるドライバーの設計プロセスで脅威モデリングを必須にする必要があります。 このトピックでは、Windows ドライバーの脅威モデルを作成するためのガイドラインを提供します。

セキュリティは、すべてのドライバーの基本的な設計ポイントで必要があります。 成功した製品は、ターゲットです。 Windows 用ドライバーを作成する場合は、いずれかの時点、どこか、だれかが行おうとすることには、ドライバーを使用して、システムのセキュリティを侵害すると想定する必要があります。

セキュリティで保護されたドライバーの設計が含まれます。

-   位置は、ドライバーで攻撃を受ける可能性があります点を特定します。
-   このような各ポイントでマウントできる攻撃の種類を分析します。
-   ドライバーがこのような攻撃を阻止するように設計されていることを確認します。

脅威のモデル化は、これらの重要な設計タスクに構造化されたアプローチです。 脅威モデルは、分類、および資産への脅威の分析の方法です。 ドライバー開発者の観点からは、資産は、ハードウェア、ソフトウェア、およびコンピューターまたはネットワーク上のデータが。

脅威モデルは、次の質問に回答します。

-   資産の保護が必要ですか。
-   どのような脅威に対する脆弱性のある資産はでしょうか。
-   重要なまたは可能性の高い方法は、各脅威ですか。
-   脅威を軽減する方法

脅威のモデル化では、ソフトウェア設計の重要な部分をこれにより、セキュリティは、製品に組み込まれているではなく付け足し対処ためです。 優れた脅威モデルを検索し、デザイン プロセス中にバグを防ぐために役立つ、修正プログラムを組織に以降と考えられる制裁のコストがかかる可能性がある必要があります。

このセクションでは、脅威モデルの作成には、ドライバーの設計の原則を適用し、脅威をドライバーが影響を受けやすいありますの例を示します。 脅威のソフトウェア設計のモデル化の詳細については、これらのリソースを参照してください。

-   Microsoft SDL の Web サイト:

    <https://www.microsoft.com/sdl>

-   Microsoft SDL の簡略化された実装:

    [ホワイト ペーパーをダウンロードします。](https://go.microsoft.com/?linkid=9708425)

-   このブログ エントリの無償版をダウンロードする方法を説明する*The Security Development Lifecycle:SDL*、Michael Howard と Steve Lipner:

    <https://blogs.msdn.microsoft.com/microsoft_press/2016/04/19/free-ebook-the-security-development-lifecycle/>


## <a name="span-idcreateathreatmodelspanspan-idcreateathreatmodelspanspan-idcreateathreatmodelspancreate-threat-models-for-drivers"></a><span id="Create_a_threat_model"></span><span id="create_a_threat_model"></span><span id="CREATE_A_THREAT_MODEL"></span>ドライバーの脅威モデルを作成します。

脅威モデルを作成するには、ドライバーのデザイン、するには、ドライバーを公開する可能性があります、脅威の種類と特定の脅威を利用するセキュリティ攻撃の影響について理解する必要があります。 ドライバーの脅威モデルを作成した後は、潜在的な脅威を軽減する方法を指定できます。

脅威のモデル化は、ドライバーのデザイン時にではなく、無計画コーディング中に、整理、構造化された方法で実行されるときに最も効果的です。 構造化されたアプローチでは、設計では、脆弱性の検出は、モデルが包括的なことを確認する可能性が向上します。

脅威のモデルの作業を整理する方法の 1 つは、次の手順には。

1.  構造化されたドライバーのデータ フローを示す図を作成します。 ドライバーを実行するすべての実行可能なタスクと、ソースと変換先のすべての入力と、ドライバーからの出力が含まれます。 仮のデータ フロー ダイアグラム、または同様の構造化されたダイアグラムをして、ドライバーの外部インターフェイス、境界、および相互作用を識別するために、ドライバーを通じてデータのパスを分析することができます。 
2.  データ フロー ダイアグラムに基づく、潜在的なセキュリティ脅威を分析します。
3.  前の手順で特定された脅威を評価し、それらを軽減する方法を決定します。

## <a name="span-idcreateadataflowdiagramspanspan-idcreateadataflowdiagramspanspan-idcreateadataflowdiagramspancreate-a-data-flow-diagram"></a><span id="Create_a_data_flow_diagram"></span><span id="create_a_data_flow_diagram"></span><span id="CREATE_A_DATA_FLOW_DIAGRAM"></span>データ フロー ダイアグラムを作成します。

概念の形式で、ドライバーと対話する外部のエンティティ間のデータ フローを示しています、データ フロー ダイアグラム-オペレーティング システムでは通常、ユーザー プロセス、およびデバイス。 正式なデータ フローの図は、次の記号を使用します。

![シンボル](images/dataflowdiagramsymbols.gif)

次の図は、架空のカーネル モードの Windows Driver Model (WDM) ドライバーのサンプルのデータ フロー ダイアグラムを示します。 概念モデルでは、特定の種類のドライバーのアーキテクチャに関係なく、同じ: すべてのデータ パスを表示して、各入力したり、ドライバーを終了するデータ ソースを識別します。

![仮定のカーネル モード ドライバー用のサンプル データ フロー ダイアグラム](images/sampledataflowdiagramkernelmodedriver.gif)

**注**  前の図は、ユーザーのプロセスと、ドライバーでは、直接間を流れるデータが表示され、中間ドライバーを省略します。 ただし、実際には、すべての要求が I/O マネージャーを通過し、特定のドライバーに到達する前に 1 つまたは複数の高度なドライバーを走査することがあります。 図では、データの元のソースとデータを提供するスレッドのコンテキストの重要性を強調するために中間手順を省略します。 カーネル モード ドライバーでは、ユーザー モードで生成されたデータを検証する必要があります。

情報は、オペレーティング システム、ユーザー プロセスからの要求からの要求のため、ドライバーを入力または要求 (通常の中断)、デバイスから。

前の図に、ドライバーは、いくつかの種類の要求で、オペレーティング システムからデータを受け取ります。

-   ドライバーとの呼び出しを通じて、そのデバイスの管理タスクを実行する要求**DriverEntry**、 **DriverUnload**、および**AddDevice**ルーチン
-   プラグ アンド プレイ要求 (IRP\_MJ\_PNP)
-   電源管理要求 (IRP\_MJ\_POWER)
-   内部デバイス I/O 制御要求 (IRP\_MJ\_内部\_デバイス\_コントロール)

これらの要求に応答して、データ フロー、ドライバーからオペレーティング システムに戻したりステータス情報として。 図に、ドライバーは、次の種類の要求でのユーザー プロセスからデータを受け取ります。

-   作成、読み取り、および書き込み要求 (IRP\_MJ\_作成、IRP\_MJ\_読み取り、または IRP\_MJ\_書き込み)
-   パブリック デバイス I/O 制御要求 (IRP\_MJ\_デバイス\_コントロール)

これらの要求に応答してでは、ユーザー プロセスには、データと状態、ドライバーからの情報フローを出力します。

最後に、ドライバーは、デバイスの I/O 操作またはデバイスの状態を変更 (CD ドライブ トレイを開く) などのユーザー操作のため、デバイスからデータを受信します。 同様に、デバイスには、I/O 操作およびデバイスの状態の変更中に、ドライバーからのデータが送られます。

前の図では、広範な概念レベルではドライバーのデータ フローを示します。 それぞれの円は、比較的大規模なタスクを表し、詳細が不足しています。 場合によっては、サンプルなどの 1 つのレベルの図は、データ ソースとパスを理解するため十分です。 ドライバーは、さまざまなソースからの I/O 要求のさまざまな種類を処理する場合は、詳細情報を表示する図を 1 つ以上追加作成する必要があります。 たとえば、「I/O 要求の処理」というラベルの付いた円は、別個の図に、次の図のようなに拡張可能性があります。

![i/o 要求の展開されているデータ フロー ダイアグラム](images/expandeddataflowdiagramiorequests.gif)

2 番目の図は、最初の図で、I/O 要求の種類ごとに個別のタスクを示します。 (わかりやすくするために、デバイスへのデータ パスが除外されています。)

外部のエンティティと、入力と、図に示した出力の種類は、デバイスの種類によって異なる場合があります。 たとえば、Windows では、多くの一般的なデバイスの種類のクラス ドライバーが用意されています。 システム指定のクラス ドライバーは、コールバック ルーチンのセットを含むダイナミック リンク ライブラリ (DLL) は、通常、ベンダーから提供されたミニドライバーで動作します。 特定のタスクを実行するミニドライバーでルーチンを呼び出すクラスのドライバーには、ユーザーの I/O 要求が送られます。 ミニドライバー通常受け取りません全体の I/O 要求パケットとして入力します。代わりに、各コールバック ルーチンは、その特定のタスクに必要なデータのみを受け取ります。

データ フロー ダイアグラムを作成すると、さまざまなドライバーの要求のソースに注意してください。 ユーザーのコンピューターで実行されるコードはフリーウェア、シェアウェア、Microsoft Office などのよく知られているアプリケーションからドライバーに、I/O 要求を生成する可能性があり、可能性のある疑わしい発信元の Web がダウンロードします。 によって、特定のデバイスはしても、media コーデックまたはそのデバイスをサポートするために、会社に付属しているサード パーティのフィルターを検討する必要があります。 使用できるデータ ソースは次のとおりです。

-   IRP\_MJ\_ドライバーが処理する XXX 要求
-   Ioctl をドライバー定義または処理します。
-   ドライバーを呼び出す Api
-   コールバック ルーチン
-   ドライバーを公開する他のインターフェイス
-   ドライバーの読み取りまたは書き込み、インストール時に使用されるものを含むファイル
-   ドライバーの読み取りまたは書き込みをレジストリ キー
-   構成のプロパティ ページ、およびドライバーを使用するユーザーによって提供されるその他の情報

モデルは必要がありますもドライバーのインストールについて説明し、プロシージャを更新します。 すべてのファイル、ディレクトリ、および読み取られた、またはドライバーのインストール中に書き込まれたレジストリ エントリが含まれます。 デバイスのインストーラー、共同インストーラー、およびプロパティ ページで公開されるインターフェイスを検討してください。

ドライバーが外部エンティティにデータを交換する位置の任意のポイントが攻撃に対して脆弱な可能性があります。

## <a name="span-idanalyzepotentialthreatsspanspan-idanalyzepotentialthreatsspanspan-idanalyzepotentialthreatsspananalyze-potential-threats"></a><span id="Analyze_potential_threats"></span><span id="analyze_potential_threats"></span><span id="ANALYZE_POTENTIAL_THREATS"></span>潜在的な脅威を分析します。

ポイントの位置、ドライバーは脆弱である可能性を特定した後の各ポイントで発生する可能性が脅威の種類を判断できます。 次の種類の質問を考慮してください。

-   どのようなセキュリティ メカニズムでは、各リソースを保護するためですか。
-   すべての遷移とインターフェイスが適切に保護されているでしょうか。
-   機能の不適切な使用は意図せず、セキュリティを損なうでしょうか。
-   機能の使用を悪意のあるはセキュリティを損なう可能性がありますか。
-   既定の設定は、適切なセキュリティを提供しますか。

## <a name="span-idthestrideapproachspanspan-idthestrideapproachspanspan-idthestrideapproachspanthe-stride-approach-to-threat-categorization"></a><span id="The_STRIDE_approach"></span><span id="the_stride_approach"></span><span id="THE_STRIDE_APPROACH"></span>脅威の分類を STRIDE 手法

STRIDE の頭字語では、ソフトウェアに対する脅威の 6 つのカテゴリについて説明します。 この略語はからを派生します。

-   **S**poofing
-   **T**ampering
-   **R**これが否認
-   **I**漏洩
-   **D**ービス拒否
-   **E**levation 特権

ガイドとして、STRIDE を使用して、ドライバーを対象に攻撃の種類についての詳細な質問を引き起こすことができます。 目標は、ドライバーの脆弱性のある各ポイントで可能な可能性のある攻撃の種類を決定して、その各可能性のある攻撃のシナリオを作成するためにします。

-   **スプーフィング**他のユーザーの資格情報を使用して、それ以外の場合にアクセスできない資産にアクセスします。 プロセスは、偽造したまたは盗まれた資格情報を渡すことによって、スプーフィング攻撃をマウントします。
-   **改ざん**を攻撃するデータを変更します。 たとえば、ドライバーをドライバーの署名で必要なドライバー ファイルが適切に保護されていないと、アクセス制御リスト (Acl) の場合は、改ざんされやすい場合があります。 このような状況で、悪意のあるユーザーは、特定ためシステムのセキュリティを侵害、ファイルを変更できます。
-   **否認不可**操作を実行するユーザーを拒否しますが、アクションの対象には、それ以外の場合に証明する方法がありません。 ときに発生します。 セキュリティを損なうおそれのある操作はログされない場合に、ドライバーは否認の脅威に対して脆弱になります。 たとえば、ビデオ デバイスのドライバーを否認不可を受けやすいフォーカス、スキャンした領域、イメージのキャプチャの頻度、キャプチャしたイメージなどのターゲットの場所など、そのデバイスの特性を変更する要求は記録されません。 その場合ができます。 結果のイメージが破損するが、システム管理者には、問題の原因となったユーザーを決定する方法はありません。
-   **情報漏えいが起こる**脅威は、名前が示すとおり: 表示する権限を持たないユーザーに情報の漏洩です。 ユーザー バッファーとの間の情報を渡すすべてのドライバーは、情報漏えいの脅威を受けやすくなります。 情報漏えいの脅威を避けるためには、ドライバーする必要があります各ユーザー バッファーの長さを検証およびデータを書き込む前にバッファーを 0 に初期化します。
-   **サービス拒否**攻撃にとって有効なユーザーのリソースにアクセスする機能。 リソースは、ディスク領域、ネットワーク接続、または物理デバイスになります。 攻撃その低速のパフォーマンスを許容できないレベルは、サービス拒否攻撃と見なさもれます。 ドライバーにより、ユーザー プロセスは、不必要にシステム リソースを独占するは、リソースの消費量が、タスクを実行する有効なその他のユーザーの機能を低下する場合、サービス拒否攻撃を受けやすくなります。

    たとえば、ドライバーは、セマフォの IRQL で実行中に、データ構造を保護を使って可能性があります = パッシブ\_レベル。 ただし、ドライバーを取得および内でのセマフォを解放する必要があります、 **KeEnterCriticalRegion/KeLeaveCriticalRegion**ペアを無効にし、非同期プロシージャ コール (Apc) の配信を再度有効にします。 ドライバーは、これらのルーチンを使用して、失敗した場合、APC にオペレーティング システム セマフォを保持しているスレッドを中断する可能性があります。 その結果、他のプロセス (管理者によって作成されたものを含む) はできません、構造体にアクセスします。

-   **特権が昇格される**攻撃は、特権のないユーザーが特権のある状態を取得した場合に発生することができます。 ユーザー モードを通過するカーネル モード ドライバーを識別するハンドルを**ZwXxx**ルーチンは、特権昇格攻撃を受けるため**ZwXxx**ルーチンは、セキュリティ チェックをバイパスします。 カーネル モード ドライバーでは、ユーザー モードの呼び出し側から受信したすべてのハンドルを検証する必要があります。

    カーネル モード ドライバーが依存している場合、特権の昇格攻撃が発生することも、 **requestormode で**IRP ヘッダーの I/O 要求がカーネル モードまたはユーザー モードの呼び出し元のものかどうかを決定する値。 ネットワークまたはサーバー サービス (SRVSVC) の値から配信される Irp **requestormode で**は**kernelmode である**要求の送信元に関係なく、します。 このような攻撃を避けるためには、ドライバーは、の値を使用するだけではなくこのような要求のアクセス制御チェックを実行する必要があります**requestormode で**します。

## <a name="span-idanalysistechspanspan-idanalysistechspandriver-analysis-techniques"></a><span id="analysistech"></span><span id="ANALYSISTECH"></span>ドライバーの分析手法

分析を整理する簡単な方法では、潜在的な脅威、脅威の種類ごとに 1 つまたは複数のシナリオと脆弱性のある領域を一覧表示します。

徹底的な分析を実行するには、ドライバーの脆弱性のある可能性のあるあらゆる時点での脅威の可能性を探索する必要があります。 各脆弱性のある時点で可能になる可能性がある脅威 (スプーフィング、改ざん、否認、情報開示、サービス拒否、および特権の昇格) の各カテゴリを決定します。 各妥当な脅威の 1 つまたは複数の攻撃シナリオを作成します。

たとえば、IRP のデータ フロー\_MJ\_デバイス\_コントロール要求の前の図に示すようにします。 次の表は、このような要求を処理するときに、ドライバーが発生する脅威の 2 つの種類を示しています。

<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">脆弱性のあるポイント</th>
<th align="left">潜在的な脅威 (STRIDE)</th>
<th align="left">シナリオ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">IRP_MJ_DEVICE_CONTROL 要求</td>
<td align="left"><p>サービス拒否</p>
<p>権限の昇格</p></td>
<td align="left"><p>ユーザー プロセスでは、デバイスが失敗する原因となる一連の Ioctl を発行します。</p>
<p>ユーザー プロセスでは、IOCTL FILE_ANY_ACCESS を許可するを発行します。</p></td>
</tr>
</tbody>
</table>

 
多くの場合、1 つの脅威が相互に関連します。 など、特権の昇格の脅威を利用した攻撃は、情報の漏えいやサービス拒否攻撃の可能性します。 さらに、いくつかの種類の攻撃は、一連のイベントに依存します。 悪意のあるユーザーは、特権の昇格の脅威を利用することによって開始可能性があります。 次の特権の昇格に付属する追加機能により、ユーザーが検索し、追加の脆弱性を悪用可能性があります。

脅威ツリーや概要は、このような複雑なシナリオをモデル化に役立ちます。

脅威ツリーは、脅威や脆弱性; の階層を示す図基本的には、脅威ツリーは、攻撃をマウントすることで、悪意のあるユーザーの手順を模倣します。 攻撃の最終目標は、ツリーの上部にあります。 それぞれの下位レベルでは、攻撃を実行するために必要な手順を示します。 次の図は、サービス拒否のシナリオでは、前の例の簡単な脅威ツリーです。

![単純な脅威ツリー](images/simplethreattree.gif)

脅威ツリーは、特定の攻撃と、手順間のリレーションシップのマウントに必要な手順を示します。 アウトラインは、脅威ツリーの代替です。

アウトライン単純に一覧表示階層の順序で特定の脅威を攻撃する手順を実行します。 次に、例を示します。

1.0 では、デバイスが応答を停止が発生します。

1.1 失敗シーケンスで問題 IOCTL します。

1.1.1 は、デバイスが失敗する原因となるシーケンスを決定します。

1.1.2 は、内部の Ioctl を発行するための昇格された特権を取得します。

いずれかの技法は、最も危険な脅威と、設計でどの脆弱性が最も重要なを理解するのに役立ちます。

 

## <a name="span-idfastpaththreatmodelingspanspan-idfastpaththreatmodelingspanspan-idfastpaththreatmodelingspanfast-path-threat-modeling"></a><span id="Fast_path_threat_modeling"></span><span id="fast_path_threat_modeling"></span><span id="FAST_PATH_THREAT_MODELING"></span>高速パスの脅威のモデル化

リソースが限られており、完全な脅威のモデル図を作成する代わりにいる場合は、ドライバーにセキュリティ上のリスクを評価するサマリーのアウトラインを作成できます。 たとえば次のテキストには、前の例で説明されているドライバーの例で図示サーフェス領域の一部について説明します。

ドライバーは、いくつかの種類の要求で、オペレーティング システムからデータを受け取ります。

-   ドライバーとの呼び出しを通じて、そのデバイスの管理タスクを実行する要求**DriverEntry**、 **DriverUnload**、および**AddDevice**ルーチン
-   プラグ アンド プレイ要求 (IRP\_MJ\_PNP)
-   電源管理要求 (IRP\_MJ\_POWER)
-   内部デバイス I/O 制御要求 (IRP\_MJ\_内部\_デバイス\_コントロール)

これらの要求に応答して、データ フロー、ドライバーからオペレーティング システムに戻したりステータス情報として。 ドライバーは、次の種類の要求でのユーザー プロセスからデータを受け取ります。

-   作成、読み取り、および書き込み要求 (IRP\_MJ\_作成、IRP\_MJ\_読み取り、または IRP\_MJ\_書き込み)
-   パブリック デバイス I/O 制御要求 (IRP\_MJ\_デバイス\_コントロール)

これらの要求に応答してでは、ユーザー プロセスには、データと状態、ドライバーからの情報フローを出力します。

データ フローのこの基本的な理解をドライバーを使用して各入力をチェックし、潜在的脅威の領域を出力できます。



## <a name="span-idthedreadapproachspanspan-idthedreadapproachspanspan-idthedreadapproachspanthe-dread-approach-to-threat-assessment"></a><span id="The_DREAD_approach"></span><span id="the_dread_approach"></span><span id="THE_DREAD_APPROACH"></span>脅威の評価になかったりアプローチ

ドライバーが攻撃される方法と場所を決定するための十分なではありません。 これらの潜在的な脅威を評価、相対的な優先順位を決定、および軽減戦略を策定しする必要があります。 

なかったりは、ソフトウェアの脅威を評価するための 5 つの条件を表す頭字語です。 なかったりを意味します。

-   **D**amage
-   **R**可能性
-   **E**xploitability
-   **A**影響を受けるユーザー
-   **D**iscoverability

ドライバーに脅威の優先順位、なかったり、評価条件のすべての 5 で 1 から 10 のそれぞれの脅威をランク付けにし、スコアを追加して、5 (条件の数) で除算します。 結果は、1 ~ 各脅威の 10 の数値スコアです。 高いスコアは、重大な脅威を示します。

-   **破損**します。 セキュリティ攻撃を引き起こす可能性のある損害を評価することは、脅威モデリングの重要な部分では明らかです。 破損は、データの損失、ハードウェアまたはメディアの障害、下回っているパフォーマンス、またはデバイスとその動作環境に適用される任意のようなメジャーを含めることができます。
-   **再現性**はどのくらいの頻度は、攻撃の種類を指定の成功の測定単位です。 簡単に再現可能な脅威はめったに発生する脆弱性や予期しないより悪用される可能性が高くなります。 たとえばが既定では、インストールされているまたはすべての潜在的なコード パスで使用される機能に対する脅威は、高再現可能です。
-   **Exploitability**労力と、攻撃をマウントするために必要な専門知識を評価します。 比較的経験の浅い大学生で攻撃する可能性がある脅威は、高度な悪用です。 高いスキルを持った人員を実行するためにコストが攻撃が悪用可能な小さいです。

    悪用される可能性を評価するには、検討も潜在的な攻撃者の数。 任意のリモートによって悪用されることがある脅威、匿名ユーザーは、オンサイト、高い権限を持つユーザーが必要な 1 よりもより悪用可能です。

-   **影響を受けるユーザー**します。 攻撃を受ける可能性があるユーザーの数は、脅威を評価する際のもう 1 つの重要な要素です。 最大で 1 つまたは 2 つのユーザーに影響を与える攻撃は、このメジャー相対的に低い率。 逆に、ネットワーク サーバーがクラッシュするサービス拒否攻撃は、何千ものユーザーに影響する可能性し、非常に高いため評価は。
-   **探索可能性**脅威が攻撃される確率値になります。 見つけやすさは、正確に予測が困難です。 任意の脆弱性が最終的に実行されることのその結果を利用を想定する最も安全な方法は、脅威の相対的な順位付けを確立するために他のメジャーに依存します。

**サンプル: なかったりを使用して脅威を評価します。**

前述の例を続行すると、次の表は、デザイナーが仮想的なサービス拒否攻撃を評価する場合がありますかを示します。

| 条件を恐れる | スコア   | コメント                                                                |
|-----------------|---------|-------------------------------------------------------------------------|
| 破損          | 8       | 作業を一時的に中断しますが、永続的な破損やデータ損失がありません。 |
| 再現性 | 10      | 毎回失敗するデバイスをによりします。                                   |
| 悪用性  | 7       | コマンドのシーケンスを決定する集中的な労力が必要です。            |
| 影響を受けるユーザー  | 10      | このデバイスでは、市場のすべてのモデルに影響します。                       |
| 見つけやすさ | 10      | すべての潜在的な脅威が検出されることを想定しています。                 |
| **合計:**      | **9.0** | **優先度の高いは、この問題を軽減します。**                           |


**脅威を軽減します。**


ドライバーの設計は、モデルを公開するすべての脅威に対する軽減する必要があります。 ただし、場合によっては、軽減できない場合があります。 たとえば、ごく限られたユーザーに影響し、データまたはシステムの利便性の損失が発生する可能性が低い可能性のある攻撃を検討してください。 このような脅威を緩和するには、追加の作業の数か月間が必要とする場合は、適度にドライバーの代わりにテスト時間を費やすを選択する可能性があります。 ただし、ドライバーが問題の修正プログラムを必要し、最終的に悪意のあるユーザーは脆弱性を検出して、攻撃をマウントする可能性がありますに注意してください。



## <a name="span-idincludingthreatmodelinginabroadersecuritydevelopmentlifecycleprocessspanspan-idincludingthreatmodelinginabroadersecuritydevelopmentlifecycleprocessspanspan-idincludingthreatmodelinginabroadersecuritydevelopmentlifecycleprocessspanincluding-threat-modeling-in-a-broader-security-development-lifecycle-process"></a><span id="Including_threat_modeling_in_a_broader_Security_Development_Lifecycle__process"></span><span id="including_threat_modeling_in_a_broader_security_development_lifecycle__process"></span><span id="INCLUDING_THREAT_MODELING_IN_A_BROADER_SECURITY_DEVELOPMENT_LIFECYCLE__PROCESS"></span>脅威モデリング、広範なセキュリティ開発ライフ サイクル プロセスを含む

脅威のモデリングより広範なセキュリティで保護された開発ライフ サイクル - SDL のプロセスを含めることを検討してください。

Microsoft SDL プロセスでは、さまざまな組織の 1 人の開発者などの任意のサイズに合わせて変更できることをお勧めのソフトウェア開発プロセスを提供します。 ソフトウェア開発プロセスに SDL の推奨事項のコンポーネントの追加を検討してください。

詳細については、次を参照してください。 [Microsoft Security Development Lifecycle (SDL): プロセス ガイダンス](https://docs.microsoft.com/previous-versions/windows/desktop/cc307891(v=msdn.10))します。

**トレーニングと組織の機能**-トレーニングを認識し、ソフトウェアの脆弱性の修復機能を拡張するソフトウェア開発のセキュリティを推進します。

マイクロソフトでは、その 4 つのコア SDL トレーニング クラスをダウンロードできます。 [Microsoft セキュリティ開発ライフ サイクルのコア トレーニング クラス](https://go.microsoft.com/?linkid=9708478)

SDL トレーニングの詳細については、このホワイト ペーパーを参照してください。 [Microsoft SDL の重要なソフトウェアのセキュリティ トレーニング](https://www.microsoft.com/download/details.aspx?id=9950)

**要件とデザイン**-信頼されているソフトウェアを構築する方法を示しては開発チームはキー オブジェクトを識別して、統合セキュリティとプライバシーを最小限にするための新しいリリースまたは新しいバージョンでは、初期計画段階中には計画とスケジュールを停止します。

このフェーズでキーの出力では、特定のセキュリティの目標を設定します。 たとえば、ことすべて、コードの渡す必要があります、Visual Studio コード分析「すべてのルール」が、0 個の警告を決定します。

**実装**-すべての開発チームを定義して一連の承認済みのツールとコンパイラとリンカーのオプションや警告など、関連付けられているセキュリティ チェックを公開する必要があります。

ドライバー開発者にとって有用な処理のほとんどはこのフェーズで行われます。 コードが書き込まれると考えられる脆弱性が確認します。 コード分析とドライバーの検証などのツールは、セキュリティを強化できるコードの領域の検索に使用されます。

**検証**-検証が位置ソフトウェアは機能的に完成され、要件と設計フェーズに記載されているセキュリティの目標に対してテストされます。

Binscope とファジー テスト担当者などの他のツールを使用してセキュリティ設計の目標を満たしていることと、コードが出荷する準備を検証すること

**リリースと応答**- 製品のリリースの準備としてが新しい脅威に対応する作業内容を記述するインシデント対応計画を作成することが望ましいと出荷されましたが、ドライバーの後にサービスを提供する方法。 事前にこの作業を実行するが同梱されているコードにセキュリティの問題を特定するかどうかより迅速に対応できる、という意味は。

SDL プロセスの詳細については、その他のリソースを参照してください。

-   これは Microsoft SDL のプライマリ サイトであり、SDL の概要を説明します。 <https://www.microsoft.com/sdl>

-   このブログの無償版をダウンロードする方法を説明する*The Security Development Lifecycle:SDL*、Michael Howard と Steve Lipner します。 <https://blogs.msdn.microsoft.com/microsoft_press/2016/04/19/free-ebook-the-security-development-lifecycle/>

-   このページは、SDL の他のパブリケーションへのリンクを提供します。 <https://www.microsoft.com/SDL/Resources/publications.aspx>



## <a name="span-idcalltoactionspanspan-idcalltoactionspanspan-idcalltoactionspancall-to-action"></a><span id="Call_to_action"></span><span id="call_to_action"></span><span id="CALL_TO_ACTION"></span>呼び掛け

ドライバー開発者。

-   脅威のドライバーの設計の一部をモデル化を確認します。
-   効率的にドライバーのコードでの脅威を軽減するための手順を実行します。
-   ドライバーとデバイスの種類に適用されるセキュリティと信頼性の問題の理解します。 詳細については、Windows デバイス Driver Kit (WDK) のデバイス固有のセクションを参照してください。
-   オペレーティング システム、I/O マネージャーでは、チェックを理解し、ユーザーの要求には、ドライバーに到達する前より高度なドライバーが実行、実行しないを確認します。
-   Driver verifier をテストおよび検証には、ドライバーなど、WDK からツールを使用します。
-   パブリックのデータベースの既知の脅威やソフトウェアの脆弱性を確認します。

追加のドライバーのセキュリティ情報を参照してください。[ドライバーのセキュリティ チェックリスト](driver-security-checklist.md)します。


## <a name="span-idresourcesspanspan-idresourcesspanspan-idresourcesspansoftware-security-resources"></a><span id="Resources"></span><span id="resources"></span><span id="RESOURCES"></span>ソフトウェアのセキュリティ リソース

**ブックの「**

*セキュリティで保護されたコードの記述*、Second Edition Michael Howard と David leblanc 共著

*ソフトウェアのセキュリティの 24 Deadly Sins:プログラミングの問題とその解決方法*、Michael Howard、David LeBlanc、John Viega して最初のエディション

*ソフトウェアのセキュリティ評価のアート: を識別して、ソフトウェアの脆弱性の防止*マーク Dowd、John マクドナルド、Justin Schuh

**Microsoft のハードウェアとドライバー開発者向け情報**

[一般的なドライバーの信頼性の問題](https://download.microsoft.com/download/5/7/7/577a5684-8a83-43ae-9272-ff260a9c20e2/drvqa.doc)ホワイト ペーパー

[Windows ドライバーのロジックをキャンセル](https://docs.microsoft.com/previous-versions/windows/hardware/design/dn653289(v=vs.85))ホワイト ペーパー

[Windows セキュリティ モデル: 知る必要がありますすべてドライバー ライター](windows-security-model.md)

**Microsoft Windows Driver Kit (DDK)**

参照してください[ドライバーのプログラミング手法](https://docs.microsoft.com/windows-hardware/drivers/kernel/driver-programming-techniques)で[カーネル モード ドライバーのアーキテクチャ](https://docs.microsoft.com/windows-hardware/drivers/)

**テスト ツール**

参照してください[Windows ハードウェア ラボ キット](https://docs.microsoft.com/windows-hardware/drivers/)で[パフォーマンスと互換性のテスト](https://docs.microsoft.com/windows-hardware/test/index)

**既知の脅威やソフトウェアの脆弱性のデータベースの公開**

ソフトウェアの脅威の知識を展開するには、既知の脅威やソフトウェアの脆弱性の利用可能なパブリック データベースを確認してください。

-   一般的な脆弱性と識別子 (CVE): <https://cve.mitre.org/>
-   一般的な弱点列挙体。 <https://cwe.mitre.org/>
-   攻撃パターンの一般的な列挙型と分類: <https://capec.mitre.org/index.html>
-   NIST の脆弱性がカタログ化する方法を説明するサイトを保持します。 <https://samate.nist.gov/BF/>


 





