---
title: データの改ざん
description: データの改ざん
ms.assetid: 277395b9-b770-45b4-8f4c-cad8b684ca44
keywords:
- 脅威のモデル データの改ざん、WDK のファイル システム
- セキュリティの脅威データの改ざん、WDK のファイル システムをモデル化します。
- データ改ざんの WDK ファイル システム
- WDK のファイル システムのデータの改ざん
- WDK のバッファーはファイル システム
- WDK の Ioctl ファイル システム
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 46c969488f1429b4a9103fa8da58a60c05309e8b
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56536076"
---
# <a name="tampering-with-data"></a>データの改ざん


## <span id="ddk_tampering_with_data_if"></span><span id="DDK_TAMPERING_WITH_DATA_IF"></span>


ドライバーは、脅威が深刻な脅威のファイル システムおよびファイル システム フィルター ドライバーは、データの改ざん。 すべてのドライバーには、ユーザー モードおよびカーネル モード コンポーネント間で共有されるすべてのコントロール構造の修正が可能ユーザー モード コンポーネントによって使用中に、カーネル モード コンポーネントによって潜在的な脅威があります。 メソッドに厳密な依存しているために、ファイル システム フィルター ドライバーはこのクラスは、攻撃の脅威に晒さ\_どちらのデータ転送の種類直接的なアクセス、仮想アドレスからユーザー バッファー。 高速の I/O には、生のユーザー モード バッファーも間接的にアクセスします。 リスクは、ドライバーがありますを使用することデータ、アプリケーションがデータを変更するときにします。 通常、ドライバーは、データを検証することで、これに対する保護しようとします。 ただし、データ検証場合にのみ機能が検証された後、データを変更することはできません。

ファイル システムとファイル システム フィルター ドライバーは、ユーザー モード アプリケーションとさまざまなカーネル モード ドライバーの間で情報を転送に使用される多数の IOCTL と FSCTL の操作があります。 さらにプライベートの IOCTL と FSCTL 運用もサービスのユーザー モードとカーネル モード ドライバーの間の制御とデータの情報を転送するには、このようなドライバーの非常に一般的です。

前提事項のみ、ドライバーのサービスまたはアプリケーションはそのインターフェイスを活用で実行されますが、この設計モデルに固有の。 このような設計と実装は、次の理由で危険にさらされては。

-   悪意のあるアプリケーションは、ドライバーの有効なバッファーを送信し、プローブし、ドライバーの脆弱性を検索するために、その後、データを変更可能性があります。

-   コントロールにあるアプリケーション内の障害には、データ バッファーの内容をコントロールが無効になる可能性があります。 たとえば、スタック ベースの制御領域は、例外がスタック領域の再利用になり、制御フローを変更する場合は無効になります可能性があります。

このカテゴリの問題から保護するには、実装の観点から警戒する必要があります。 バッファーは、検証される前に、非揮発性メモリ (カーネル専用、または読み取り専用メモリ) である必要があります。 バッファーに他のバッファーまたは制御構造への参照が含まれている場合もある必要があります非揮発性メモリな検証前にします。

開発者がありますを使用してその IOCTL、 **FastIoDeviceControl**ディスパッチは生のユーザーのバッファーでデータを渡します。 したがって Ioctl の高速な I/O バージョンを実装するドライバーには、問題を回避する適切な手順を実行する必要があります。

単独で、データの検証ではないことだけに注意してください。 たとえば、成功した呼び出し[ **ProbeForWrite** ](https://msdn.microsoft.com/library/windows/hardware/ff559879)それ以降の変更、アプリケーションのアドレス空間を変更するには、その状態が発生する可能性がありますが、バッファーが有効である可能性があります。 アプリケーションは、実際に直接、バッファーを使用して、ドライバーの前に終了でしたなどが。 そのため、ドライバーは、アプリケーションのアドレス空間内のすべての変更から保護する必要があります。 通常これは、例外処理を使用して構造化を使用して **\_\_お試しください**と **\_\_を除く**ユーザー バッファーにアクセスするコード直接のアドレス。

 

 




