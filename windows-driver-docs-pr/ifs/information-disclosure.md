---
title: 情報の漏洩
description: 情報の漏洩
ms.assetid: e5794acb-44f7-4775-854b-69884f60658a
keywords:
- 脅威モデル WDK ファイルシステム、情報漏えい
- セキュリティ脅威モデル WDK ファイルシステム、情報漏えい
- 情報開示 WDK ファイルシステム
- I/o WDK ファイルシステム
- WDK ファイルシステムのバッファー
- WDK ファイルシステムの公開
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: cd43d2ec3c212cfb4adb656735e8bcd4fd9e072a
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72841203"
---
# <a name="information-disclosure"></a>情報の漏洩


## <span id="ddk_information_disclosure_if"></span><span id="DDK_INFORMATION_DISCLOSURE_IF"></span>


ドライバーの場合、情報漏えいは通常、不適切なバッファー処理によってアプリケーションに情報を公開することに関連します。 たとえば、i/o 要求がバッファリングされているドライバーは、通常、 *Iostatus*ブロック構造体の**情報**メンバーを設定することによって返されるデータの量を示します。 I/o マネージャーは、その情報を使用して、結果をアプリケーションのバッファーにコピーします。

ドライバーが、返されるデータが多いことを示している場合は、i/o マネージャーによって*Systembuffer*から追加のデータがコピーされます。 ただし、ドライバーが*Systembuffer*のバランスを満たしていなかった場合、そのメモリ内のものはすべてアプリケーションに返され、アプリケーションに機密データが公開される可能性があります。 この問題は、使用されるデータバッファーがクリアされていないために、他のシステムに追加情報が送信される可能性があるネットワークドライバーの問題を監視します。 たとえば、ICMP ping 応答に追加情報が含まれている場合があります。 データを誤って公開した場合のこの問題は、さまざまなシステムで非常に実際に発生します。

ファイルシステムまたはファイルシステムフィルタードライバーの場合、データへのアクセスを許可しないユーザーにファイル情報を公開するリスクがあります。 これは、さまざまな方法で行うことができます。

-   [**Zwcreatefile**](https://docs.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-ntcreatefile)を使用してファイルを開き、その中間ハンドルを介してデータへのアクセスを提供するフィルタードライバー。 **Zwcreatefile**関数は、既定でファイルを開いてセキュリティチェックをバイパスします。これは、要求がカーネルモードから送信されるためです。 そのため、このハンドルを使用してアクセスすると、通常はアプリケーションで使用できない情報が開示される可能性があります。

    フィルタードライバーが、公開されていないデータを公開していないことを確認するためにアクセスチェックを強制する必要がある場合は、フィルタードライバーで\_\_\_OBJ を指定して、 [**ZwCreateFile**](https://docs.microsoft.com/windows-hardware/drivers/ddi/ntifs/nf-ntifs-ntcreatefile)関数。

-   カーネルモードでハンドルを開くフィルタードライバー (アクセスチェックをバイパスします)。ただし、OBJ\_KERNEL\_ハンドルは指定しません。 作成されたハンドルは、現在のプロセスのハンドルテーブルに配置されます。 このハンドルは、データへのフルアクセスを使用して、ユーザーモードで表示されます。 偽のアプリケーションは、このようなハンドルを監視して、データへのアクセスに使用することができます。

-   IRP\_MJ\_CREATE 要求を送信し、システムワーカースレッドのコンテキストで処理するファイルシステムまたはファイルシステムフィルタードライバー。 IRP がシステムワーカースレッドによって処理される場合、通常、作成操作はシステムスレッドの特権を使用して完了します。 そのため、これらのシステム特権を使用してアクセスすると、通常はアプリケーションでは利用できない情報が開示される可能性があります。

-   ファイルシステムまたはファイルシステムフィルタードライバー。呼び出し元のプロセスに特定のデータへのアクセスを許可する必要があることを確認せずに、ファイルオブジェクトベースの i/o を実行します。

情報の管理と保護には固有の役割があるため、ファイルシステムとファイルシステムフィルタードライバーは、情報の保護を確保するために特に注意する必要があります。

 

 




