---
title: デバイス オブジェクトのセキュリティ記述子を適用します。
description: デバイス オブジェクトのセキュリティ記述子を適用します。
ms.assetid: c0697021-cf78-4b85-b959-342179da5621
keywords:
- WDK のセキュリティ記述子のファイル システム、デバイス オブジェクトに適用します。
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: e9db2ced158caf82095c3c1cfbe506add1d69806
ms.sourcegitcommit: a33b7978e22d5bb9f65ca7056f955319049a2e4c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/31/2019
ms.locfileid: "56538183"
---
# <a name="applying-security-descriptors-on-the-device-object"></a>デバイス オブジェクトのセキュリティ記述子を適用します。


## <span id="ddk_applying_security_descriptors_on_the_device_object_if"></span><span id="DDK_APPLYING_SECURITY_DESCRIPTORS_ON_THE_DEVICE_OBJECT_IF"></span>


ほとんどのドライバーでは、それらのデバイス オブジェクトに対して I/O マネージャーによって適用されるアクセス制御を使用して、不適切なアクセスから保護します。 ほとんどのドライバーの最も簡単な方法では、ドライバーがインストールされている場合、明示的なセキュリティ記述子を適用します。 INF ファイルでは、このようなセキュリティ記述子は AddReg セクションの「セキュリティ」エントリで説明します。 セキュリティ記述子の記述に使用する完全な言語の詳細については、Microsoft Windows SDK ドキュメントのセキュリティ記述子定義言語を参照してください。

セキュリティ記述子定義言語 (SDDL) を使用してセキュリティ記述子の基本的な形式には、標準的なセキュリティ記述子の場合は、次の情報が含まれています。

-   所有者の SID です。

-   グループ SID。

-   随意アクセス制御リスト (DACL)。

-   システム アクセス制御リスト (SACL)。

したがって、セキュリティ記述子の INF スクリプト内での説明には。

```cpp
O:owner-sidG:group-sidD:dacl-flags(ace)(ace)S:sacl-flags(ace)(ace)
```

個々 のアクセス制御エントリでは、許可または拒否する特定のグループまたはセキュリティ識別子または SID で指定されたユーザーへのアクセスについて説明します。 たとえば、INF ファイルが含まれます行にはなど。

```cpp
"D:P(A;CI;GR;;;BU)(A;CI;GR;;;PU)(A;CI;GA;;;BA)(A;CI;GA;;;SY)(A;CI;GA;;;NS)(A;CI;GA;;;LS)(A;CI;CCDCLCSWRPSDRC;;;S-1-5-32-556)"
```

上記の例は、NETTCPIP 元。Microsoft Windows XP Service Pack 1 (SP1) システムから INF ファイルです。

この例ではありません所有者またはグループを指定すると、既定で、定義済みまたは既定値。 **D** DACL であることを示します。 **P**これは保護されている ACL で、親オブジェクトのセキュリティ記述子から任意の権限を継承していないことを示します。 保護されている ACL では、親でのより緩やかなセキュリティが継承されていることを防ぎます。 かっこで囲まれた式では、単一のアクセス制御エントリ (ACE) を示します。 SDDL を使用するアクセス制御エントリはセミコロンで区切られた複数の異なるコンポーネントの構成されます。 順番に、次に示します。

-   ACE の型インジケーター。 Dacl の一意の 4 つの型と Sacl の 4 つのさまざまな種類があります。

-   **フラグ**フィールドの子オブジェクトには、この ACE や Sacl の監査とアラームのポリシーの継承を記述するために使用します。

-   **Rights**フィールドは、権限の許可または拒否 ACE によってことを示します。 このフィールドでは、この ACE に該当するジェネリック、standard、および特定の権限を示す特定の数値を指定することか、共通アクセス権について説明する文字列を使用できます。

-   オブジェクト GUID の場合は、DACL はオブジェクト固有 ACE の構造体。

-   継承されたオブジェクト GUID DACL は、オブジェクト固有 ACE の構造体の場合

-   この ACE を適用するセキュリティ エンティティを示す SID。

したがって、サンプルのセキュリティ記述子を解釈するには、ACE を"A"先頭を示します [アクセス許可] のエントリであります。 代替手段は「アクセスが拒否されました」のエントリ、使用頻度の低いのみがあり、先頭の"D"文字で表されるです。 **フラグ**フィールドをコンテナー継承 (CI)、この ACE、サブ オブジェクトによって継承されていることを示すを指定します。

**Rights**フィールドの値は、汎用的な権利と標準的な権限が含まれる特定の権限をエンコードします。 たとえば、"GR"は"汎用の読み取り"アクセスを示し"GA"を「汎用すべて」のアクセス、どちらも汎用的な権限を示します。 さまざまな特別な権限では、これらの一般的な権限に従います。 上記のサンプルの"CC"する場合は、ファイルおよびディレクトリ権限に固有である子のアクセスを作成することを示します。 上記のサンプルには、削除子へのアクセスなどの"DC"、"CC"文字列の後に他の標準的な権限にはもが含まれています"LC"一覧子アクセス、セルフ右のアクセスには、「ソフトウェア」の"RP"の読み取りプロパティへのアクセス、"SD"標準のコントロールの読み取りアクセスのアクセス、および"RC"を削除します.

上記のサンプルで SID エントリの文字列では、"PU"を含めるパワー ユーザーは、"BU"ビルトイン users は、"BA"の"組み込みの administrators、ローカル サービス アカウント、ローカル システムでは、"SY"と"NS"のネットワーク サービス アカウントの"%.*LS"。 上記の例では、ユーザーが与えられます汎用の読み取りアクセス オブジェクト。 組み込みの administrators、ローカル サービス アカウント、ローカル システム、およびネットワーク サービスがすべてジェネリックを指定された一方、アクセス (読み取り、書き込み、および実行)。 すべての可能な権限と標準の SID の文字列の完全なセットは、Windows SDK に記載されています。

これらの Acl は、特定のドライバーによって作成されたすべてのデバイス オブジェクトに適用されます。 ドライバーを新しい関数を使用して特定のオブジェクトのセキュリティ設定を制御できますも[ **IoCreateDeviceSecure**](https://msdn.microsoft.com/library/windows/hardware/ff548407)名前付きのデバイス オブジェクトを作成するときに、します。 **IoCreateDeviceSecure**関数には、以降 Windows XP Service Pack 1 と Windows Server 2003 で使用できます。 使用して**IoCreateDeviceSecure**、デバイス オブジェクトに適した完全なセキュリティ記述子定義言語のサブセットを使用して、デバイス オブジェクトに適用されるセキュリティ記述子を説明します。

デバイス オブジェクトに特定のセキュリティ記述子を適用する目的では、アプリケーションがデバイス自体へのアクセスを試みるたびに、デバイスに対して適切なセキュリティ チェックが行われることを確認します。 デバイス名の構造 (たとえば、ファイル システムの名前空間) が含まれているオブジェクトの場合は、このデバイスの名前空間へのアクセスの管理の詳細については I/O マネージャーではないドライバーに属しています。

このような場合に興味深い問題は、ドライバーのデバイス オブジェクトとはどのようなセキュリティ ポリシーが、ドライバーの適切な実装して、デバイス ドライバーへのアクセスをチェックする責任を負います I/O マネージャー間の境界でのセキュリティを処理する方法を示します。 これまでは、開かれているオブジェクトが、デバイス自体の名前である場合は、I/O マネージャーは、セキュリティ記述子を使用して直接デバイス オブジェクトに対してフル アクセス チェックを実行します。 ただし、開かれているオブジェクトには、ドライバー自体内のパスが示されている場合、I/O マネージャーはデバイス オブジェクトを走査アクセスが許可されることを確認するチェックのみ。 ほとんどのスレッドが付与されているため、通常、この走査権利が与えられて**SeChangeNotifyPrivilege**ディレクトリの右に走査の付与に対応します。 名の構造をサポートしていないデバイスは通常、I/O マネージャーが完全セキュリティ チェックを実行することを要求しています。 これは、設定で、**ファイル\_デバイス\_SECURE\_オープン**デバイスの特性フィールド内のビットします。 このようなデバイス オブジェクトの組み合わせを含むドライバーでは、その名の構造をサポートしていないデバイスのこの特性を設定する必要があります。 たとえば、ファイル システムは (これは、名前付け構造体はサポートされません)、名前付きのデバイス オブジェクトには、このオプションを設定が、名前のないデバイス オブジェクト (ボリュームなど)、名前付け構造体をサポートには、このオプションを設定できません。 このビットが設定に失敗して、ドライバーの一般的なバグを正しくです、デバイスへの不適切なアクセスを許可することができます。 添付ファイルのインターフェイスを使用するドライバー ([**IoAttachDeviceToDeviceStackSafe**](https://msdn.microsoft.com/library/windows/hardware/ff548236)など)、**ファイル\_デバイス\_SECURE\_開いている**ドライバーのアタッチ先のデバイスでこのフィールドが設定されている場合は、ビットが設定されています。 そのため、フィルター ドライバーは、セキュリティ チェックのこの特定の側面について心配する必要はありません。

 

 




