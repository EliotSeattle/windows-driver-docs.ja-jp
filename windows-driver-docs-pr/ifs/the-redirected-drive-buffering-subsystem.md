---
title: リダイレクトされたドライブのバッファー サブシステム
description: リダイレクトされたドライブのバッファー サブシステム
ms.assetid: 901a8b3e-222a-44be-8279-765d8ec4ffe1
keywords:
- ネットワーク リダイレクター WDK、RDBSS
- リダイレクター ドライバー WDK、RDBSS
- リダイレクトされたサブシステムの WDK のバッファリングをドライブのファイル システム
- RDBSS WDK ファイル システム
- ミニ-リダイレクター WDK、RDBSS
- 非モノリシック ドライバー WDK
- コードの WDK ネットワーク リダイレクターのバッファリング
- I/O WDK ネットワーク リダイレクター
- カーネル ネットワーク リダイレクター WDK、RDBSS
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 269e7fdb33ea8cd91275fd17cc777e096d19c608
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63385646"
---
# <a name="the-redirected-drive-buffering-subsystem"></a>リダイレクトされたドライブのバッファー サブシステム


## <span id="ddk_the_redirected_drive_buffering_subsystem_if"></span><span id="DDK_THE_REDIRECTED_DRIVE_BUFFERING_SUBSYSTEM_IF"></span>


カーネル モードのファイル システム ドライバーとして、リダイレクトされたドライブのバッファリング サブシステム (RDBSS) が提供される*rdbss.sys*、オペレーティング システムと、スタティック ライブラリに含まれている*rdbsslib.lib*をWindows Driver Kit (WDK) に含まれています。 スタティック ライブラリ内のコードの重複、 *rdbss.sys*カーネル モード ドライバー。

元の設定がすべてのネットワーク ミニ リダイレクターと動的にリンクは、 *rdbss.sys*カーネル ドライバー。 動的にリンクされているドライバー *rdbss.sys*モノリシック以外のドライバーと呼ばれます。 ただし、この機能が完全に実装されて、Microsoft SMB のネットワークが動的にミニ リダイレクター リンクのみ*rdbss.sys*モノリシック以外のドライバーとします。 すべての他のネットワーク ミニ-リダイレクターなど、オペレーティング システムに含まれているその他の Microsoft リダイレクターがに対してリンク、 *rdbsslib.lib*ライブラリと同じコードを静的に含めると、 *rdbss.sys*カーネル ドライバー。 同じ RDBSS ソース コードは、両方で使用されるときに、 *rdbss.sys*ドライバーと*rdbsslib.lib*ライブラリ、モノリシック ネットワーク ミニ リダイレクター ドライバーのサイズが大きいでコードのほとんどから*rdbss.sys*ドライバーごとに含まれています。 たとえば、Windows Server 2003 では、さまざまなドライバーのファイル サイズとしては、

<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Driver (ドライバー)</th>
<th align="left">ファイル サイズ</th>
<th align="left">説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><p><em>rdbss.sys</em></p></td>
<td align="left"><p>156 KB</p></td>
<td align="left"><p>RDBSS のデバイス ドライバーは Microsoft SMB ミニリダイレクターでのみ使用されます。</p></td>
</tr>
<tr class="even">
<td align="left"><p><em>mrxdav.sys</em></p></td>
<td align="left"><p>179 KB</p></td>
<td align="left"><p>リンクの多くの Microsoft WebDAV ネットワーク ミニ リダイレクター ドライバー <em>rdbsslib.lib</em>します。</p></td>
</tr>
<tr class="odd">
<td align="left"><p><em>rdrpdr.sys</em></p></td>
<td align="left"><p>185 KB</p></td>
<td align="left"><p>リンクの多くの Microsoft ターミナル サービス ネットワーク ミニ リダイレクター ドライバー <em>rdbsslib.lib</em>します。</p></td>
</tr>
</tbody>
</table>

 

ミニ リダイレクター、およびその他のカーネル システム、メモリ マネージャーではネットワーク、RDBSS 通信マネージャーでは、I/O、キャッシュ マネージャー。 RDBSS には、次の機能がサポートされています。

-   RDBSS とミニ リダイレクター ドライバー間の通信に適切に定義されたメカニズムが定義されます。

-   複数のバッファリング モードがサポートされています。 ライブの共有を有効にするために動的にバッファリング モードを変更するネットワーク ミニリダイレクターに役立つサポート ルーチンもあります。

-   ネットワークのミニ リダイレクターは、名前付け、印刷、パイプ、メール スロット、および清掃 (一部のデータ構造を再利用) の UNC 名の大文字小文字を区別を含む、さまざまなオプションのサポートを指定できます。

-   ネットワークのミニ リダイレクターは、名前空間、ファイルの情報、および接続が不要なネットワークの操作を減らすためにキャッシュをサポートします。

RDBSS は、通信を適切に定義されたメカニズムを使用します。 RDBSS は、多数のミニ リダイレクター ドライバーとオプションを設定し、さまざまな操作を実行するには、その他のカーネル システムで呼び出すことができる関数をエクスポートします。

ミニ リダイレクターは、多数の RDBSS でミニ リダイレクター ドライバーとの通信に使用されるコールバック関数を実装します。 ミニ リダイレクター ドライバーを最初に起動すると (でその**DriverEntry**ルーチン)、ドライバーは、これらのコールバック関数 (ディスパッチへのポインターを持つ構造体のミニ リダイレクター ドライバーとパスを登録するため RDBSS 関数を呼び出すいくつかの構成データ値と共にはテーブル)。

ミニ リダイレクター ドライバーに実装する必要があります、コールバック関数は、次の基本的なカテゴリに分類されます。

-   ネットワークのミニ リダイレクター データ構造の管理にコールバックします。

-   ファイル I/O 操作のコールバック。
    -   同期のファイル I/O ルーチン (作成、close、および例については、クリーンアップ)。
    -   非同期ファイル I/O ルーチン (読み取り、書き込み。 FSTCL、IOCTL、および例については、ロック)。 歴史的な理由から、ネットワークのミニ リダイレクターでこれらの同期のファイル I/O ルーチンは低い I/O 操作を多くの場合、呼び出されました。

ファイル I/O のコールバックは、低い I/O カテゴリに分類する関数を除く、同期する必要があります。 低い I/O ルーチンでは、非同期的に動作でき、そのため、キャンセルをサポートする必要があります。

基本的なデータ構造体、RX がよく使用 RDBSS とミニ リダイレクター\_情報を渡すためのコンテキスト。 RX\_コンテキストは、大量の情報をカプセル化し、現在 IRP へのポインターが含まれています。 この RX の既定のサイズがある\_コンテキスト データ構造体。 この RX のサイズ\_CONTEXT 構造は、リモート ファイル システムの要件に基づいて拡張して、ミニ リダイレクターがネットワークします。 このために使用するサイズ拡張 RX\_ミニ リダイレクターの RDBSS (指定されたデータ値の 1 つ) をまず登録時にコンテキストが定義されます。

RDBSS とミニ リダイレクターも広範に利用の次のデータ構造の抽象化します。

-   サーバーを呼び出すコンテキスト (SRV\_を呼び出す)-各既知のファイル システムのサーバーに関連付けられているコンテキスト。

-   ルートの net (NET\_ルート)--共有のルートが、ユーザーが開いています。

-   Net の仮想ルート (V\_NET\_ルート)--サーバー上の共有のビュー。 複数のディメンションからビューを制約することができます。 例として、ビューは関連付けログオン id には、共有上で実行できる操作を制限することはできます。

-   ファイル制御ブロック (FCB)--クライアントで開いている各一意のファイルに関連付けられている RDBSS データ構造体。

-   ファイル オブジェクトの拡張子 (FOBX)--NT ファイルに RDBSS 拡張子\_オブジェクト。

-   サーバー側の開くコンテキスト (SRV\_開きます)--リモート共有上のファイルを開いているハンドル。

RDBSS のバッファリング用の非常に柔軟なサポートしています。 RDBSS は個別にバッファーの読み取りおよび書き込み要求を設定できます。 ファイルのサイズとファイルの時刻はキャッシュできます。 明示的なバッファリング戦略が許可され、ファイル サーバー上の共有を開いたときにこれらを設定することができます。 個々 のファイルごとにバッファーを設定することもできます。

RDBSS はアクセス履歴を使用して、不要なネットワーク要求の必要性が軽減しようとしています。 たとえば、リモート ファイルのオープンの要求が失敗した場合、この情報は RDBSS によってキャッシュします。 クライアントは、すぐに場合は、ファイル名の変更と同様のファイルを開く要求、RDBSS ファイル名の大文字小文字を区別するリモート ファイル システムの要求は失敗します。

 

 




