---
title: プレゼンス イベントのサブスクライブ
description: プレゼンス イベントのサブスクライブ
ms.assetid: 4AA6C7DA-5301-4356-8AF9-5567322FAB46
keywords:
- NFC
- 近距離無線通信
- proximity
- 近距離近接通信
- NFP
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 54c253167bd320cd6cf1e301316d68cccfaaec6d
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72827348"
---
# <a name="subscribing-for-presence-events"></a>プレゼンス イベントのサブスクライブ


プレゼンスサブスクリプションは、ドライバー内で開かれている一意のハンドルとして表されます。 NFP プロバイダーが非近接から近接または近接から非近接に移行するたびに、ドライバーからクライアントにイベントがスローされます。

このインターフェイスでは、近接デバイスが削除されたかどうかを判断する機能や、2つのデバイスが両方とも近接の場合に近接デバイスからどのサブスクリプションが到着したかを**知ることは**できません。  

 

プレゼンスイベントは、一般的なサブスクリプションパスを使用して実装されます。 プロトコル "DeviceArrived" または "DeviceDeparted" のメッセージは、特別なサブスクリプションとして解釈する必要があります。 到着メッセージは、受信メッセージを配信する直前に配信される最初のメッセージである必要があります。 受信メッセージは、これ以上メッセージが表示されない場合に、最後に配信されたメッセージである必要があります。

## <a name="subscription"></a>サブスクリプション


これは、次の特定の要件を除き、通常のサブスクリプションと同じように見えます。

近接デバイスとそのドライバーは、近接デバイスからのメッセージを受信するプロトコルフローに関係しています。

### <a name="required-actions"></a>必要なアクション

同じクライアントによってサブスクライブされている場合でも、ドライバーは重複するサブスクリプションを受け入れてレポートする必要があります。

-   近接時に最初のメッセージを受信する直前に、ドライバーは、仮想 "DeviceArrived" メッセージが受信された場合と同様に動作する必要があります。
-   プロバイダーが非近接に移行する場合、ドライバーは、仮想 "デバイスが停止しました" というメッセージが受信された場合と同様に動作する必要があります。
-   他のすべてのメッセージがそのクライアントによって処理される前に、"DeviceDeparted た" メッセージをクライアントに配信することはできません。
-   DeviceArrived メッセージのペイロードは、近接になる最初のデバイスが双方向の通信に対応している場合にのみ、高い31ビットが0に設定された単一の DWORD である必要があります。

    **  NFC**の場合は、llcp サポートに相当します。

     

-   近接になる最初のデバイスが単なるタグの種類のデバイス (たとえば、NFC のフォーラムタグ) である場合、ドライバーは DeviceArrived メッセージのペイロードの最下位ビットをクリアする必要があります。

     

-   DeviceDeparted 失われたメッセージのペイロードは、値が0の単一の DWORD である必要があります。

 

 
## <a name="related-topics"></a>関連トピック
[NFC デバイスドライバーインターフェイス (DDI) の概要](https://docs.microsoft.com/windows-hardware/drivers/ddi/index)  
[近距離無線近接 DDI リファレンス](https://docs.microsoft.com/windows-hardware/drivers/ddi/index)  

