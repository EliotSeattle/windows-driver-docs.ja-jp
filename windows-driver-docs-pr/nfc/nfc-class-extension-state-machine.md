---
title: NFC クラス拡張のステートマシン
description: NFC CX ステートマシンの内部設計を以下に示します。
ms.assetid: A131F881-C05A-44FF-A7A6-FD40BA344BD0
keywords:
- NFC
- 近距離無線通信
- proximity
- 近距離近接通信
- NFP
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: f3cda10e06792f9b56782cf3c01856c128d80a44
ms.sourcegitcommit: 4b7a6ac7c68e6ad6f27da5d1dc4deabd5d34b748
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/24/2019
ms.locfileid: "72831883"
---
# <a name="nfc-class-extension-state-machine"></a>NFC クラス拡張のステートマシン


NFC CX ステートマシンの内部設計を以下に示します。 NFC CX によって指定されるさまざまな状態と、状態遷移を引き起こす内部イベントと外部イベントが図にキャプチャされます。 読み取りを容易にするために、一部の状態間の遷移は図に示されていないことに注意してください。 次に、NCI RF ステートマシンへのマッピングと共に状態について説明します。

![nfc cx ステートマシン](images/statemachine.png)

| 都道府県             | 説明                                                                                                                                                                                                                                                                                                                                             |
|-------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| StateIdle         | StateIdle は、NFC デバイスの電源が入っているが、NCI コマンドがコントローラーに送信されていない場合、または NCI 操作中に回復不能なエラーが発生した場合に入力されます。                                                                                                                                                                                         |
| StateInit         | StateInit は、ハードウェア\_アクションの開始が NFC CX に送信されるときに入力されます。 この状態では、NCI reset、NCI initialization、および NFC チップセットの構成が行われます。 この状態の完了後、(この表の以下の) すべての後続の状態が発生します。                                                                                                          |
| StateRfIdle       | NFC コントローラーは正常に初期化されていますが、RF ポーリングループが無効になっています (つまり、ポーリングとリッスンの両方のフェーズが無効になっているか、構成されていません)。 NFC 操作が不要な場合、デバイスは StateRfIdle に入ります。 UMDF アイドル検出タイマーは、この状態のときに有効になり、このタイマーの有効期限が切れると、チップセットが初期化されます。 |
| StateRfDiscovery  | NFC コントローラーは、ポーリングフェーズまたはリッスンフェーズのいずれかに対して、検出ループを構成しています。 検出ループを有効にする前に、一部の検出パラメーターもこの状態で構成されます。                                                                                                                                                    |
| 検出された staterf | RF リモートエンドポイントが検出され、選択されます。 RF インターフェイスは、デバイスホストから通信するためにアクティブ化されています。 これは移行中の状態です。                                                                                                                                                                                      |
| StateRfDataXchg   | デバイスホストと RF リモートエンドポイントは、ポーリングモードまたはリッスンモードでデータをアクティブに交換しています。 この状態は、状態 RFST\_ポーリング\_アクティブまたは RFST\_リッスン\_が NCI RF ステートマシンで有効であることを表します。                                                                                                                                             |
| StateRecovery     | この状態は、NFC デバイスがコア\_RSET\_NTF をホストに送信したとき、または致命的な i/o エラーが発生したときに、NCI 操作中にタイムアウトが発生したときに入力されます。 NFC CX は、コントローラーをリセットして再初期化することによって、NCI の回復を試行します。 通常の操作は、回復が成功した場合に再開されます。それ以外の場合は、ステートマシンは StateIdle に移行します。  |
| StateShutdown     | NFC デバイスをシャットダウンしようとしています。 これは移行中の状態です。 この状態が完了すると、ステートマシンは StateIdle に遷移します。                                                                                                                                                                                                       |

 

 

 
## <a name="related-topics"></a>関連トピック
[NFC デバイスドライバーインターフェイス (DDI) の概要](https://docs.microsoft.com/windows-hardware/drivers/ddi/index)  
[NFC クラス拡張 (CX) リファレンス](https://docs.microsoft.com/windows-hardware/drivers/ddi/index)  

