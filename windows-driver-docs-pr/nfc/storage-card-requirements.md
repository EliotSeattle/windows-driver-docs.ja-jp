---
title: 記憶域カードの要件
description: このトピックでは、メモリ カードの APDU 要件を説明します
ms.assetid: ''
ms.localizationpriority: medium
ms.date: 10/17/2018
ms.openlocfilehash: 3b18621098a4a28084b8d8a54b3098a23e2595cd
ms.sourcegitcommit: 0cc5051945559a242d941a6f2799d161d8eba2a7
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/23/2019
ms.locfileid: "63373620"
---
# <a name="storage-card-requirements"></a>記憶域カードの要件

このセクションでは、ISO14443 4 では非準拠のカード (ストレージ カードと呼ばれます) の [全般] の [apdu] コマンド セットの要件について説明します。

## <a name="general-authenticate-command"></a>コマンドの一般的な認証

一般的な認証コマンドを使用して、MIFARE カード上で、認証シーケンスを実行します。 このコマンドは、MIFARE、Mini、クラシック 1 k と 4 k のカードの該当するだけです。 

### <a name="command-format"></a>コマンドの形式

| コマンド              | クラス | アドイン  | P1   | P2   | Lc   | 内のデータ                                               |
|----------------------|-------|------|------|------|------|-------------------------------------------------------|
| [全般]-認証 | 0 xff の場合  | 0x86 | 0x00 | 0x00 | 0x01 | アドレス MSB、アドレス、LSB キー タイプ A または B、キーの数 |

### <a name="response-format"></a>応答の形式

| 応答 |
|----------|
| SW1、SW2  |

## <a name="get-data-command"></a>データを取得するコマンド

データを取得するコマンドは、コンタクトレス NFC タグ/カードからの情報の取得に使用されます。 

### <a name="command-format"></a>コマンドの形式

<table>
    <tbody>
        <tr>
            <th>コマンド</th>
            <th>クラス</th>
            <th>アドイン</th>
            <th>P1</th>
            <th>P2</th>
            <th>L2</th>
        </tr>
        <tr>
            <td>Get-Data</td>
            <td>0 xff の場合</td>
            <td>0xCA</td>
            <td>
                <ul>
                    <li>0x00:(ISO14443-a: カードのシリアル番号UID、ISO14443 B:PUPI、Felica:IDm、ジュエル:RID)</li>
                    <li>0x01:カード (タイプ a: の履歴 (バイト)ATR、タイプ b: から履歴のバイト数ATTRIB 応答)</li>
                </ul>
            </td>
            <td>0x00</td>
            <td>0x00</td>
        </tr>
    <tbody>
</table>

### <a name="response-format"></a>応答の形式

| 応答           |
|--------------------|
| SW1、SW2 送信データ |

## <a name="load-key-command"></a>読み込みキー コマンド

読み込みキーのコマンドは、ドライバーで MIFARE キーを格納に使用されます。 このコマンドは、MIFARE、Mini、クラシック 1 k と 4 k のカードの該当するだけです。 

### <a name="command-format"></a>コマンドの形式

| コマンド  | クラス | アドイン  | P1            | P2         | Lc  | 内のデータ   |
|----------|-------|------|---------------|------------|-----|-----------|
| 読み込みキー | 0 xff の場合  | 0x82 | キーの構造 | キーの数 | 0x6 | キーの値 |

### <a name="response-format"></a>応答の形式

| 応答 |
|----------|
| SW1、SW2 |

## <a name="manage-session-command"></a>セッションのコマンドを管理します。

PCSC 仕様に準拠した、このコマンドの実装があります。

### <a name="command-format"></a>コマンドの形式

| コマンド              | クラス | アドイン  | P1   | P2   | Lc       | 内のデータ         |
|----------------------|-------|------|------|------|----------|-----------------|
| [全般] を認証します。 | 0 xff の場合  | 0xC2 | 0x00 | 0x00 | 変数 | TLV データ オブジェクト |

次に、ドライバーでサポートされなければならない TLV データ オブジェクトが必要です。

| Tag  | データ オブジェクト               |
|------|---------------------------|
| 0x80 | データ オブジェクトのバージョン       |
| 0x81 | 透過的なセッションを開始します。 |
| 0x82 | 透過的なセッションの終了   |

## <a name="read-binary-command"></a>読み取りバイナリ コマンド

読み取りバイナリ コマンドは、コンタクトレス NFC タグ/カードからのデータの読み取りに使用されます。 コマンドは、ストレージ カード (MIFARE クラシック/UL、Felica、ISO15693 およびジュエル/Topaz カード) にのみ適用できます。

### <a name="command-format"></a>コマンドの形式

| コマンド     | クラス | アドイン  | P1          | P2          | Lc                | 内のデータ | Li              |
|-------------|-------|------|-------------|-------------|-------------------|---------|-----------------|
| 読み取りバイナリ | 0 xff の場合  | 0xB0 | MSB アドレス | アドレス LSB | データの長さ | データ    | 長さが必要です。 |

### <a name="mifare-family"></a>MIFARE ファミリ

| コマンド       | CLA  | アドイン  | P1   | P2           | le   |
|---------------|------|------|------|--------------|------|
| UL 16 の読み取り    | 0 xff の場合 | 0xB0 | 0x00 | 0x15 を 0x00 | 0x10 |
| CL 1k READ 16 | 0 xff の場合 | 0xB0 | 0x00 | 0x00 に 0x3F | 0x10 |
| CL 4k READ 16 | 0 xff の場合 | 0xB0 | 0x00 | 0x00 から 0 xff | 0x10 |

### <a name="jewel-family"></a>ジュエル ファミリ

| コマンド  | CLA  | アドイン  | P1       | P2           | le   |
|----------|------|------|----------|--------------|------|
| すべてを読み取り | 0 xff の場合 | 0xB0 | 0x00     | 0x00         | 0x00 |
| RID      | 0 xff の場合 | 0xB0 | 0x00     | 0x00         | 0x06 |
| 読み取り     | 0 xff の場合 | 0xB0 | ブロックなし | ブロックのオフセット | 0x01 |
| 8 を読み取る   | 0 xff の場合 | 0xB0 | ブロックなし | 0x00         | 0x08 |
| SEG を読み取る | 0 xff の場合 | 0xB0 | 0x00     | セグメント Addr | 0x80 |

### <a name="felica-family"></a>Felica ファミリ

| コマンド | CLA  | アドイン  | P1   | P2   | Lc                | 内のデータ                                         |
|---------|------|------|------|------|-------------------|-------------------------------------------------|
| CHECK   | 0 xff の場合 | 0xB0 | 0x00 | 0x00 | データの長さ | サービス、ブロックの数、ブロック一覧の数 |

### <a name="iso-15693-family"></a>ISO 15693 ファミリ

| コマンド | CLA  | アドイン  | P1           | P2   | le   |
|---------|------|------|--------------|------|------|
| 読み取り    | 0 xff の場合 | 0xB0 | ブロックの数 | 0x00 | 0x04 |

### <a name="response"></a>応答

| 応答           |
|--------------------|
| SW1、SW2 送信データ |

## <a name="transparent-exchange-command"></a>透過的な exchange コマンド

### <a name="command-format"></a>コマンドの形式

| コマンド              | クラス | アドイン  | P1   | P2   | Lc       | 内のデータ         |
|----------------------|-------|------|------|------|----------|-----------------|
| [全般] を認証します。 | 0 xff の場合  | 0xC2 | 0x00 | 0x01 | 変数 | TLV データ オブジェクト | 

次に、ストレージ カードにコマンドの透過的な exchange 用のドライバーでサポートされなければならない透過的な Exchange コマンドに必要な TLV データ オブジェクト。

| Tag    | データ オブジェクト                       |
|--------|-----------------------------------|
| 0x95   | 利用の送信し、受信 |
| 0x5F46 | Timer                             |

## <a name="update-binary-command"></a>更新プログラム バイナリのコマンド

更新プログラム バイナリ コマンドは、コンタクトレス NFC タグ/カードへのデータの書き込みに使用されます。 コマンドは、ストレージ カード (MIFARE クラシック/UL、Felica、ISO15693 およびジュエル/Topaz カード) にのみ適用できます。 要求とコマンドの応答の形式は、以下に示すようです。

### <a name="command-format"></a>コマンドの形式

| コマンド       | クラス | アドイン  | P1          | P2          | Lc                | 内のデータ |
|---------------|-------|------|-------------|-------------|-------------------|---------|
| 更新プログラム バイナリ | 0 xff の場合  | 0xD6 | MSB アドレス | アドレス LSB | データの長さ | データ    |

### <a name="mifare-family"></a>MIFARE ファミリ

| コマンド        | CLA  | アドイン  | P1   | P2           | le   |
|----------------|------|------|------|--------------|------|
| UL 書き込み 4     | 0 xff の場合 | 0xD6 | 0x00 | 0x15 を 0x00 | 0x04 |
| CL 1 k の書き込み 16 | 0 xff の場合 | 0xD6 | 0x00 | 0x00 に 0x3F | 0x10 |
| CL 4 k の書き込み 16 | 0 xff の場合 | 0xB0 | 0x00 | 0x00 から 0 xff | 0x10 |

### <a name="jewel-family"></a>ジュエル ファミリ

| コマンド  | CLA  | アドイン  | P1           | P2           | le   |
|----------|------|------|--------------|--------------|------|
| WRITE1 E | 0 xff の場合 | 0xD6 | ブロックの数 | ブロックのオフセット | 0x01 |
| WRITE8 E | 0 xff の場合 | 0xD6 | ブロックの数 | 0x00         | 0x08 |

### <a name="felica-family"></a>Felica ファミリ

| コマンド | CLA  | アドイン  | P1   | P2   | le                | 内のデータ                                         |
|---------|------|------|------|------|-------------------|-------------------------------------------------|
| UPDATE  | 0 xff の場合 | 0xD6 | 0x00 | 0x00 | データの長さ | ブロック、ブロック一覧の数、サービスの数 |

### <a name="response-format"></a>応答の形式

| コマンド | CLA  | アドイン  | P1           | P2   | le  |
|---------|------|------|--------------|------|-----|
| 書き込み   | 0 xff の場合 | 0xD6 | ブロックの数 | 0x00 | 0x4 |

