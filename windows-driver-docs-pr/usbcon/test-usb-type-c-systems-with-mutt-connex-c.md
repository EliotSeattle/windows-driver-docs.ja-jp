---
Description: MUTT 接続 Exerciser Type-C (USB Type-C ConnEx) ハードウェアボードは、Arduino ボード用のカスタムシールドです。
title: USB Type-C システムを USB Type-C ConnEx を使用してテストする
ms.date: 04/20/2017
ms.localizationpriority: medium
ms.openlocfilehash: 05d948bdfabe342bd941ab77a7c595c64198cadc
ms.sourcegitcommit: 5b0d2b7a3a4efa3bc4f94a769bf41d58d3321d50
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/16/2019
ms.locfileid: "72390725"
---
# <a name="test-usb-type-c-systems-with-usb-type-c-connex"></a>USB Type-C システムを USB Type-C ConnEx を使用してテストする


**要約**

-   USB タイプを使用した自動テスト-C ConnEx
-   Windows 10 の USB タイプ C の相互運用性テスト手順: 機能テスト (FT) とストレステスト (ST)。
-   デバイスの追加や削除などのシナリオを確認するための診断手順とヒント。

**適用対象**

-   Windows 10

**公式の仕様と手順**

-   [USB 3.1 および USB タイプ-C 仕様]( https://go.microsoft.com/fwlink/p/?LinkId=620208)
-   [xHCI の相互運用性テスト手順](https://go.microsoft.com/fwlink/p/?LinkId=623257)

**最終更新日時**

-   2016 年 2 月

\[一部の情報はリリース前の製品に関する事項であり、正式版がリリースされるまでに大幅に変更される可能性があります。 ここに記載された情報について、Microsoft は明示または黙示を問わずいかなる保証をするものでもありません。\]

MUTT 接続 Exerciser Type-C (USB Type-C ConnEx) ハードウェアボードは、Arduino ボード用のカスタムシールドです。 シールドには、USB タイプ C シナリオの相互運用性テストを自動化するための4対1のスイッチが用意されています。

このトピックでは、システム、デバイス、USB タイプ C コネクタを使用したドッキング、および Windows オペレーティングシステムとの相互運用性のテストを自動化するためのガイドラインを提供します。 次のいずれかのカテゴリに属するハードウェアをテストできます。

-   システム: USB タイプ C ポートが公開されている Windows オペレーティングシステムのバージョンの SKU を実行しているデスクトップ、ラップトップ、タブレット、サーバー、または電話。
-   Dock: 複数のポートを公開する任意の USB タイプ C デバイス。
-   デバイス: タイプ C ポートを持つ任意の USB デバイスで、システムまたはドッキングに接続できます。 このカテゴリには、従来の USB デバイスだけでなく、USB タイプ C 仕様で定義されているアクセサリモードと代替モードをサポートするデバイスが含まれます。

## <a name="hardware-requirements"></a>ハードウェア要件


Usb タイプ c の接続を使用して USB タイプ C の相互運用性テスト手順を実行するには、次のものが必要です。

-   **テスト対象のシステム (SUT)**

    1つ以上の種類の C USB ポートが公開されているデスクトップ、ラップトップ、タブレット、サーバー、または電話。

-   **Arduino メガ 2560 R3**

    [Arduino メガ 2560 R3](https://go.microsoft.com/fwlink/p/?LinkId=733526)は、テストセットアップのマイクロコントローラーとして使用されます。 このボードは、 [Arduino ストア](https://go.microsoft.com/fwlink/p/?LinkId=733526)から購入できます。

    ![arduino](images/arduino.png)

-   **マイクロコントローラーの電源アダプター**。

    Arduino メガ 2560 R3 ボードの互換性のあるアダプターの詳細については、こちらの[サイトを参照してください](https://go.microsoft.com/fwlink/p/?LinkID=733660)。

-   **USB タイプ-C ConnEx**

    シールドには、SUT が接続されているオスの USB タイプ C ポート ( **J1**というラベルが付いています) が1つあります。 シールドには、 **J2**、 **J3**、 **J4**、 **J6**というラベルが付いた4つの他の USB ポートもあります。このポートは、SUT の周辺機器として機能するデバイスに接続できます。 シールドは、amperage と、SUT からの電圧の描画を監視します。 このボードは、 [Mcci](https://go.microsoft.com/fwlink/p/?LinkId=733488)または[Jjg テクノロジ]( https://go.microsoft.com/fwlink/p/?linkid=618287)から購入できます。

    ![USB タイプ-C ConnEx](images/connexc-top.png)

-   **USB A-B ケーブル**

    このケーブルを使用して、マイクロコントローラーのファームウェアを更新してテストを実行するために、PC をマイクロコントローラーに接続します。

-   **周辺機器の USB デバイス**

    SUT に接続できる USB タイプ C ポートを持つ任意の USB デバイス。 このカテゴリには、USB タイプ C 仕様で定義されているアクセサリモードと代替モードをサポートする、従来の USB デバイスとその他のデバイスが含まれます。

-   **USB チャージャー**

    Usb タイプ c-c の現在の要件と、オプションで[Usb 電源配布](https://go.microsoft.com/fwlink/p/?LinkID=623310)をサポートする c。 また、 **J6**の USB マイクロの充電も必要です。

-   **プロキシコントローラー**

    USB タイプ C の ConnEx は、テストを実行するためのプロキシを使用して制御できます。 プロキシコントローラーは、次のいずれかのエンティティにすることができます。

    -   セカンダリデスクトップ PC またはノート pc。

        プロキシコントローラーは、モバイル SUT と通信します。ファームウェアを読み込むマイクロコントローラー。

    -   2次 USB ポートを使用した SUT。
    -   、3.5 mm オーディオジャックを使用した SUT。

        このセットアップでは、次のものが必要です。

        -   1つの USB タイプ C ポートを使用して SUTs でテストを実行する DTMF シールド。 DTMF は、ファームウェアの初期フラッシュが完了した後に、オーディオジャックを使用してシングルポートデバイスからシールドを制御する機能を提供します。

            ![dtmf シールド](images/dtmf.png)

        -   4-DTMF シールドを SUT に接続するために使用されるオスのオーディオケーブルをピン留めします。 これにより、テスト中に、SUT が USB タイプ C シールドを制御できるようになります。

            ![3.5 mm オーディオジャック](images/audio-jack.png)

## <a name="software-requirements"></a>ソフトウェア要件


次の要件を満たしていることを確認します。

-   SUT は、相互運用性をテストする Windows オペレーティングシステムのバージョンを持っている必要があります。
-   プロキシコントローラーは Windows 10 を実行している必要があります。
-   [![download ソフトウェアパッケージをダウンロード](images/download.png)](https://go.microsoft.com/fwlink/p/?LinkId=786621)し、最新の mutt ソフトウェアパッケージをプロキシコントローラーにインストールします。 
 パッケージは、USB タイプ C の ConnEx を使用してテストを実行するために使用される一連のツールです。 これには、ファームウェアを更新したり、周辺機器を切り替えたり、テストケースをシミュレートするために要求を送信したりするためのユーティリティが含まれています。 また、バス、コントローラー、およびバスに接続されているデバイスの機能をテストするテストドライバーパッケージも含まれています。

-   UCSI ベースのシステムでは、UCSI ファームウェアのバグを検出するために、いくつかの追加設定を使用してテストすることを強くお勧めします。 この設定により、UCSI ファームウェアの問題を検出できるようになり、テスト目的でのみ使用することを強くお勧めします。 このブログ記事の「[ファームウェアエラーをバグチェックに変換する」を](https://techcommunity.microsoft.com/t5/Microsoft-USB-Blog/Debugging-UCSI-firmware-failures/ba-p/283226)参照してください。

-   テストツールをインストールするには、管理者特権のコマンドウィンドウが必要です。

    管理者特権のコマンドウィンドウを開くには、ユーザーがプロキシコントローラーの**Administrators**グループのメンバーである必要があります。 管理者特権でのコマンドプロンプトウィンドウを開くには、Cmd.exe へのデスクトップショートカットを作成し、Cmd.exe ショートカットを右クリックして、 **[管理者として実行]** を選択します。

### <a name="usb-type-c-connex-tools"></a>USB タイプ-C ConnEx ツール

次に、USB の種類に固有の MUTT ソフトウェアパッケージのツールを示します。 C の ConnEx

| ツール                          | 説明                                                                                          |
|-------------------------------|------------------------------------------------------------------------------------------------------|
| [ConnExUtil](#connexutilexe) | USB タイプの C ConnEx 機能を実行するためのコマンドラインツール。                                             |
| [CxLoop. cmd](#cxloop)         | 各ポートを一度接続して切断します。                                                             |
| [CxStress .cmd](#cxstress)     | ランダム化ストレススクリプト。                                                                            |
| [CxPower .cmd](#cxpower)       | 一定の時間にわたって電力データ (電圧と amperage) をキャプチャし、CSV ファイルに出力を送信します。 |



その他のツールの詳細については、 [MUTT ソフトウェアパッケージのツール](mutt-software-package.md)を参照してください。

## <a name="get-started"></a>はじめに.


テスト環境を設定するには、次の手順に従います。

![USB タイプ-C ConnEx 構成](images/connexc.png)

構成は、次の図のようになります。 コントローラーの USB タイプ C ポートは、PC に接続されているときに USB タイプ C 接続を制御することに注意してください。

これらの手順では、ハードウェアピースに接続し、マイクロコントローラーのファームウェアを更新して、インストールを検証します。 DTMF シールドは、スマートフォンまたはタブレットのオーディオポートに接続されている場合に、USB タイプ C 接続 Ex を制御します。

1.  マイクロコントローラーを USB タイプ C シールドに接続します。

    USB タイプ C の ConnEx が組み立てられていない場合は、手順 1. に進みます。 USB タイプ C の ConnEx が組み立てられている場合は、手順 2. に進みます。

    **注意**![ 注意 @ no__t-2 ピンが簡単にベンドされるため、この手順は慎重に行う必要があります。



    1.  ボードが相互にレベルであることを確認して、USB タイプ C シールドのピンをマイクロコントローラーの receptors に揃えます。

        ![USB タイプのピンを揃える-C ConnEx](images/connexc-align.png)

    2.  2つのボードをゆっくりと押します。 シールドのピンを曲げないように注意してください。

        ![USB 型のアセンブル-C ConnEx](images/connexc-connect.png)

        アセンブルしたユニットは、次の図のようになります。

        ![接続された接続先-c ボード](images/connexc-connect1.png)

2.  Usb タイプ-B (プロキシコントローラーに接続されている) または外部電源アダプターを使用して、接続されたマイクロコントローラーから USB タイプ C の接続を強化します。 LCD ディスプレイは次の図のようになります。

    5秒後に、LCD ディスプレイに現在と電圧が表示されます。

    ![USB タイプ-ファームウェアブート前の C の ConnEx](images/connexc-connect2.png)![USB タイプ-ファームウェアブート前の C の ConnEx](images/connexc-connect3.png)

    前の図に示されているように [表示] 画面が表示されていない場合は、ユニットが正しく組み立てられていることを確認してください。

3.  USB タイプの C ConnEx ファームウェアでマイクロコントローラーを更新します。
    -   管理者特権のコマンド プロンプト ウィンドウを開きます。
    -   MUTT ソフトウェアパッケージの場所 (C: \\Program Files (x86) \\USBTest @ no__t-2 *&lt;arch @ no__t*) に移動します。
    -   次のコマンドを実行します。

        **MuttUtil – UpdateTabFirmware**

4.  このような場合は、そのシールドで、 **J1**というラベルが付いたオスの USB タイプ C ポートに SUT を接続します。

    **注意** **J1**コネクタでは、SUT を接続するときに追加のサポートが必要です。 コネクタは、デバイスの重みを維持するために十分に丈夫ではありません。

    ![テスト対象のシステムをアタッチしています (sut)](images/connexc-connect4.png)

5.  **J2**、 **J3**、 **J4**、 **J6**というラベルの付いた USB ポートに周辺機器を接続します。

    ![USB タイプに周辺機器を接続する-C ConnEx](images/connexc-connect7.png)

6.  プロキシコントローラーをマイクロコントローラーに接続します。
    -   プロキシコントローラーがデスクトップ PC またはラップトップの場合は、USB 経由の接続を確立します。 上の図に示すように、マイクロコントローラーの USB タイプ B ポートをプロキシコントローラーの USB ポートに接続します。
    -   プロキシコントローラーがモバイル SUT の場合は、オーディオポートを使用して接続を確立します。 この接続には、DTMF シールドが必要です。
        1.  次の図に示すように、DTMF シールドをアセンブルされたユニットに接続します。

            ![dtmf 添付ファイル](images/connexc-connect6.png)

        2.  4ピンのオス ~ オスオーディオケーブルを使用して、シールドのオーディオポートを、SUT のオーディオポートに接続します。

            セットアップは次の図のようになります。

            ![dtmf を使用してテスト対象のシステム (sut) をアタッチしています](images/connexc-connect5.png)

7.  USB タイプ C の ConnEx がプロキシコントローラーのデバイスマネージャーによって認識されていることを確認します。
    1.  タスクバーの 開始 ボタンを右クリックし、**デバイスマネージャー** を選択します。
    2.  **[ポート (com & LPT)]** ノードを展開し、マイクロコントローラーによって使用される com ポートを確認します。 この例では、COM 4 に接続されています。

        ![デバイスマネージャーでの USB の種類-C の ConnEx](images/connexc-connect8.png)

## <a name="connexutilexe"></a>ConnExUtil


次に、このコマンドラインオプションを使用して、プラグインが USB タイプ C の ConnEx ボードを制御できるようにします。

<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>ユースケース</th>
<th>オプション</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>デバイスの検出
<p>USB タイプに接続されているすべてのデバイスを一覧表示する-C ConnEx</p></td>
<td><strong>/list</strong></td>
<td>USB 接続デバイスの場合、このオプションはデバイスインスタンスのパスを一覧表示します。 オーディオに接続されているデバイスの場合は、<strong>オーディオ</strong>が表示されます。
<p>オーディオデバイスを表示するには、これを<strong>/all</strong>パラメーターと組み合わせて使用します。 1から始まるインデックスを持つリスト。 <strong>/#</strong>パラメーターへの入力に使用できます。</p></td>
</tr>
<tr class="even">
<td>デバイスの選択
<p>USB タイプに接続されているすべてのデバイス (オーディオを含む) を選択します。</p></td>
<td><strong>/all</strong></td>
<td>(省略可能)。
<p>このパラメーターを指定しない場合、ユーティリティは USB 接続デバイスに対応します。 このパラメーターは、オーディオ接続デバイスが使用されている場合にのみ使用してください。 オーディオ検出は、既定では時間がかかり、無効になっています。</p></td>
</tr>
<tr class="odd">
<td>デバイスの選択
<p>USB タイプに接続されている特定のデバイスを選択します-C ConnEx ' n '。</p></td>
<td><strong>/#</strong> <em>n</em></td>
<td>(省略可能)
<p>入力<em>n</em>は、 <strong>/list</strong>パラメーターを使用して表示できる USB タイプ C に接続されている使用可能なデバイスの1から始まるインデックスです。 このパラメーターを指定しない場合、既定の動作では、すべての USB タイプ C ConnEx ボードで各コマンドが実行されます。</p></td>
</tr>
<tr class="even">
<td>デバイスコマンド</td>
<td><strong>/setPort</strong> <em>p</em></td>
<td>指定されたポート<em>p</em>に切り替えます。
<p>番号 (1 ~ 4) または名前 (<strong>J2</strong>、 <strong>J3</strong>、 <strong>J4</strong>、 <strong>J6</strong>) を指定して、ポートを接続します。</p>
<p>0は、すべてのポートを切断します。</p></td>
</tr>
<tr class="odd">
<td>デバイスコマンド</td>
<td><strong>/getPort</strong></td>
<td>現在接続されているポートを読み取ります。</td>
</tr>
<tr class="even">
<td>デバイスコマンド
<p>Amperage/電圧情報の読み取り</p></td>
<td><p><strong>/ボルト</strong></p>
<p><strong>/アンペア</strong></p>
<p><strong>/version</strong></p></td>
<td><p>現在の電圧を読み取ります。</p>
<p>現在の amperage を読み取ります。</p>
<p>デバイスのバージョンを読み取ります。</p></td>
</tr>
<tr class="odd">
<td>デバイスコマンド
<p>SuperSpeed を有効にする</p></td>
<td><strong>/SuperSpeedOn</strong></td>
<td><strong>/SuperSpeedOff</strong>コマンドが送信されるまで、現在および将来の接続で SuperSpeed をグローバルに有効にします。
<p>SuperSpeed は既定で有効になっています。</p>
<p>SuperSpeed が無効になっていて、ポート1または2が接続されている場合、このコマンドは SuperSpeed で再接続をトリガーします。</p></td>
</tr>
<tr class="even">
<td>デバイスコマンド
<p>SuperSpeed を無効にする</p></td>
<td><strong>/SuperSpeedOff</strong></td>
<td><strong>/SuperSpeedOn</strong>コマンドが送信されるか、デバイスがリセットされるまで、現在および将来の接続で SuperSpeed をグローバルに無効にします。
<p>SuperSpeed が有効になっていて、ポート1または2が接続されている場合、このコマンドは、SuperSpeed 行が無効になっている再接続をトリガーします。</p></td>
</tr>
<tr class="odd">
<td><p>コマンドの遅延の設定</p></td>
<td><strong>/setDelay</strong> <em>t</em></td>
<td>コマンド遅延<em>t</em>を秒単位で設定します。
<p>コマンドの遅延を設定すると、次の<strong>/setPort</strong>または<strong>/SuperSpeed{On/Off}</strong>コマンドが 0 ~ 99<strong>の範囲の</strong> <em>t</em>秒で遅延します。 これは1回限りの設定であり、次のコマンドのみが遅延します。 遅延タイマーの有効期限が切れる前に複数のコマンドを送信することはサポートされていません。</p></td>
</tr>
<tr class="even">
<td><p>切断のタイムアウトをミリ秒単位で設定します</p></td>
<td><strong>/setDisconnectTimeout</strong> <em>t</em></td>
<td>次のゼロ以外の<strong>/setPort</strong>コマンドの切断タイムアウトを設定します。 次の connect イベントでは、ポートは切断される前に、 <em>t</em>ミリ秒間のみ接続されたままになります。 これは1回限りの設定であり、次の connect イベントのみが自動的に切断されます。 許容範囲は 0 ~ 9999 ミリ秒です。</td>
</tr>
<tr class="odd">
<td><p>Batch コマンド:</p>
<p>電力の測定値を .csv ファイルに出力します。</p></td>
<td><strong>/powercsv</strong></td>
<td>最初の実行では、power .csv に現在の電力測定とタイムスタンプを追加します。 以降の実行では、このファイルにデータが追加されます。
<p>新しいデータキャプチャを開始するには、ファイルの名前を変更するか、ファイルを削除します。 各実行では、次の形式の行が追加されます。 <em>&lt;index @ no__t-2、&lt;time @ no__t、&lt;volts @ no__t、&lt;amps @ no__t-8</em>。</p>
<p><em>index</em>は、 <strong>/list</strong>によって指定されたデバイスインデックスです。そのため、複数のデバイスを同時に監視することができます。</p>
<p><em>time</em>は、生のタイムスタンプ (秒) です。</p>
<p><em>ボルト</em>と<em>アンペア</em>は小数点以下2桁に記録されます。</p>
<p>このデータは長期間にわたってキャプチャされ、スプレッドシートアプリケーションにプロットされます。「cxpower を参照してください。</p></td>
</tr>
<tr class="even">
<td><p>Batch コマンド:</p>
主要な機能の単体テストの実行</td>
<td><strong>/test</strong></td>
<td>デバイスのすべての主要な機能をテストします。 デバイスの機能の基本的な検証に使用します。 このコマンドが失敗した場合は、デバイスの電源を入れ、ファームウェアを更新してください。</td>
</tr>
<tr class="odd">
<td><p>Batch コマンド:</p>
ポート切り替えシーケンスの基本的なデモ。</td>
<td><strong>/デモ d</strong></td>
<td>すべてのポートを1回ループする (各ポートに<em>d</em>秒の遅延がある)
<p>各ポートのポート番号、ボルト、およびアンペアを demoresult に書き込みます。</p></td>
</tr>
</tbody>
</table>



### <a name="sample-commands"></a>サンプルコマンド

ポートに接続する

``` syntax
connexutil.exe /setport 1
```

または、ボードに印刷されたポート名を使用します。

``` syntax
connexutil.exe /setport J3
```

すべてのポートを切断する

``` syntax
connexutil.exe /setport 0
```

すべてのポートをループする

``` syntax
for %p in (1 2 3 4) 
do (
    connexutil.exe /setport %p
    echo Confirm device on port %p
    pause
)
```

## <a name="scripts-for-controlling-the-usb-type-c-connex-board"></a>USB タイプを制御するためのスクリプト-C ConnEx ボード


これらのスクリプトは、コマンドラインを使用して、USB タイプ C の ConnEx で順次およびストレスの種類のテストを実行するために、ConnExUtil によってサポートされるコントロールインターフェイスを実行します。 これらのすべてのスクリプトは、オプションのコマンドラインパラメーター **audio**をサポートしており、USB Type-C connex ボードが 3.5 mm オーディオインターフェイスを介して接続されていることを示しています。 既定では、USB 接続ボードの使用のみが試行されます。

### <a href="" id="cxloop"></a>単純な接続/切断シーケンス: CXLOOP。プロンプト

各ポートでの SUT の接続と切断 (1-4) を行い、テスト担当者にそのポートでの接続を検証するように要求する各ポートで一時停止します。

### <a href="" id="cxstress"></a>ランダム接続/切断ループ: CXSTRESS。プロンプト

無限ループで 0.0 ~ 5.0 秒のランダムな間隔で、各ポートをランダムに接続および切断します。 USB タイプ C ポートに接続するときは、そのポートで SuperSpeed 接続をランダムに有効または無効にし、ランダムな間隔 0 ~ 999 ミリ秒で、そのポートですばやく切断するようにボードに指示します。

コマンドラインパラメーター **C**を指定すると、スクリプトによって、USB タイプ c ポートと切断状態が切り替わります。 数値のコマンドラインパラメーターは、スイッチ間の最大ランダム間隔を、既定値の5.0 秒から入力値 (秒単位) にリセットします。 パラメーターは任意の順序で渡すことができます。

### <a href="" id="cxpower"></a>実行時間の長い電力測定: CXPOWER。プロンプト

USB タイプ-C ConnEx によって報告された amperage と電圧を、2秒間隔でファイルの出力に保存します。 データは、コンマ区切りの変数として次のように書式設定されます。

<em>index</em> **、** <em>time</em> **、** <em>ボルト</em> **、** <em>アンペア</em>

*index*は、複数のデバイスを同時に監視できるように、 **connexutil**コマンドによって指定されるデバイスインデックスです。

*time*は、生のタイムスタンプ (秒) です。

*ボルト*と*アンペア*は小数点以下2桁に記録されます。

キャプチャが完了すると、このデータは、時間の経過と共に電力消費を示すグラフに処理される可能性があります。たとえば、バッテリ充電サイクルの期間における電力消費量などです。 数値のコマンドラインパラメーターは、既定の測定間隔である2秒を入力値 (秒) にリセットします。

##  <a name="about-test-cases"></a>テストケースについて


USB タイプ C の相互運用性テスト手順は、「機能テスト (FT)」と「ストレステスト (ST)」の2つのセクションに分かれています。 各テストセクションでは、テストケースについて説明し、テストに適用されるカテゴリを識別します。 製品は、該当するカテゴリ全体に対してテストする必要があります。 特定のテストケースには、関連するヒントへのリンクと、追加情報のヒントが含まれています。 このセクションでは、USB タイプ C の機能とエクスペリエンスに焦点を絞って説明します。 Usb タイプ C のソリューションには、USB ハブや USB コントローラーなどの他の USB コンポーネントが含まれている場合があります。 USB ハブとコントローラーの詳細なテストについては、「USB IF の[xHCI の相互運用性テスト手順](https://go.microsoft.com/fwlink/p/?LinkId=623257)」と「Windows ハードウェア認定キット」に記載されています。

これらのテストケースは、 [USB タイプの C ConnEx ボードを制御するための](#scripts-for-controlling-the-usb-type-c-connex-board)、ConnExUtil コマンドとスクリプト例のスクリプトに基づいています。 テストケースは、スクリプトを参照します。 テストシナリオで必要に応じてスクリプトをカスタマイズします。

<a href="" id="device-enumeration"></a>[デバイス列挙型](#ft-case-1-device-enumeration)  
デバイス列挙の主要な側面が機能していることを確認します。

<a href="" id="alternate-mode-negotiation"></a>[代替モードネゴシエーション](#ft-case-2-alternate-mode-negotiation)  
サポートされている代替モードを確認します。

<a href="" id="charging-and-power-delivery--pd-"></a>[課金と電力配信 (PD)](#ft-case-3-charging-and-power-delivery-pd)  
USB タイプ-C での課金を確認します。

<a href="" id="role-swap"></a>[ロールのスワップ](#ft-case-4-role-swap)  
ロールのスワップを確認します。

「ストレステスト」セクションでは、一定期間にわたってデバイスの安定性をテストする、ストレスおよびエッジケースシナリオの手順について説明します。 ストレステストでは、レガシ USB 検証 (非 USB タイプ C) 用のカスタムデバイス (スーパー Mutt) が必要です。 その他のテストと自動化は、今後の USB タイプ C テストデバイスで実現できます。

<a href="" id="device-enumeration"></a>[デバイス列挙型](#st-case-1-device-enumeration)  
デバイス列挙の主要な側面が機能していることを確認します。

<a href="" id="charging-and-power-delivery--pd-"></a>[課金と電力配信 (PD)](#st-case-2-charging-and-power-delivery-pd)  
USB タイプ-C での課金を確認します。

## <a name="ft-case-1-device-enumeration"></a>FT Case 1: デバイス列挙型


![ft case 1: デバイス列挙型](images/ft1.png)

| ポート   | デバイス                                                                              |
|--------|-------------------------------------------------------------------------------------|
| **J1** | SUT.                                                                                |
| **J2** | Usb タイプ c の usb ポートを使用して接続されている PC-c + + ケーブルを使用して接続します。              |
| **J3** | USB タイプ-C 充電器。                                                                 |
| **J4** | マウスが接続されているダウンストリームがある USB ハブ (SuperSpeed または高速度)。               |
| **J6** | USB を使用する PC-usb タイプ-A から USB マイクロ B ケーブルを使用して接続されたポートケーブル。 |



1.  SUT の電源をオフにします。
2.  **J1** On USB Type-C connex というラベルが付いたポートに、SUT を接続します。
3.  プロキシコントローラーを USB タイプ-C 接続 Ex に接続します。
4.  周辺機器を USB タイプに接続します-C 接続 Ex。
5.  SUT の電源を入れ、Windows にログオンします。
6.  管理者特権でのコマンドプロンプトで、CXLOOP を実行します。CMD スクリプト。 スクリプトが一時停止したら、新しくアクティブになった周辺機器が動作していることを確認します。
7.  USB タイプ C ケーブルの向きを反転し、手順 5-7 を繰り返します。

手順 2-4 に関連する構成イメージについては、「[はじめ](#get-started)に」を参照してください。

## <a name="ft-case-2-alternate-mode-negotiation"></a>FT Case 2: 代替モードネゴシエーション


![ft case 2: 代替モードネゴシエーション](images/ft2.png)

| ポート   | デバイス                                                                              |
|--------|-------------------------------------------------------------------------------------|
| **J1** | SUT.                                                                                |
| **J2** | DisplayPort USB タイプ-C ドングル。                                                   |
| **J3** | USB タイプ-C 充電器。                                                                 |
| **J4** | フラッシュドライブが下流に接続されている USB ハブ (SuperSpeed または高速)。         |
| **J6** | USB を使用する PC-usb タイプ-A から USB マイクロ B ケーブルを使用して接続されたポートケーブル。 |



1.  SUT の電源をオフにします。
2.  **J1** On USB Type-C connex というラベルが付いたポートに、SUT を接続します。
3.  プロキシコントローラーを USB タイプ-C 接続 Ex に接続します。
4.  周辺機器を USB タイプに接続します-C 接続 Ex。
5.  SUT の電源を入れ、Windows にログオンします。
6.  管理者特権でのコマンドプロンプトで、CXLOOP を実行します。CMD スクリプト。 スクリプトが一時停止したら、新しくアクティブになった周辺機器が動作していることを確認します。
7.  USB タイプ C ケーブルの向きを反転し、手順 5-7 を繰り返します。

手順 2-4 に関連する構成イメージについては、「[はじめ](#get-started)に」を参照してください。

## <a name="ft-case-3-charging-and-power-delivery-pd"></a>FT ケース 3: 課金と電力配信 (PD)


![ft ケース 3: 課金と電力配信 (pd)](images/ft3.png)

| ポート   | デバイス               |
|--------|----------------------|
| **J1** | SUT.                 |
| **J2** | なし。                |
| **J3** | USB タイプ-C 充電器。  |
| **J4** | USB マウス。           |
| **J6** | USB マイクロの充電器。 |



1.  SUT の電源をオフにします。
2.  **J1** On USB Type-C connex というラベルが付いたポートに、SUT を接続します。
3.  プロキシコントローラーを USB タイプ-C 接続 Ex に接続します。
4.  周辺機器を USB タイプに接続します-C 接続 Ex。
5.  SUT の電源を入れ、Windows にログオンします。
6.  管理者特権でのコマンドプロンプトで、CXLOOP を実行します。CMD スクリプト。 スクリプトが一時停止したら、新しくアクティブになった周辺機器が動作していることを確認します。
7.  USB タイプ C ケーブルの向きを反転し、手順 5-7 を繰り返します。
8.  USB タイプ-C 接続 Ex をポート**J2**に接続します。

    **/SetPort 2 の ConnExUtil**

9.  SUT に複数の USB タイプ C ポートが含まれている場合は、USB タイプ C ケーブルで同じシステム上の2つの USB タイプ C ポートを接続します。

    SUT が充電されていないことを確認します (それ自体)。

    電源の LCD の読み取りが、壁面アダプターの期待と一致していることを確認します。

10. **J3**に接続されている Usb タイプ c の充電装置を、別の製造元の別の Usb タイプ c 充電装置に置き換えます。

    デバイスが現在受信していることを確認します。

手順 2-4 に関連する構成イメージについては、「[はじめ](#get-started)に」を参照してください。

## <a name="ft-case-4-role-swap"></a>FT ケース 4: ロールのスワップ


![ft ケース 4: ロールのスワップ](images/ft4.png)

| ポート   | デバイス                                                                              |
|--------|-------------------------------------------------------------------------------------|
| **J1** | SUT.                                                                                |
| **J2** | Usb タイプ c の usb ポートを使用して接続されている PC-c + + ケーブルを使用して接続します。              |
| **J3** | なし。                                                                               |
| **J4** | USB フラッシュ ドライブ。                                                                    |
| **J6** | USB を使用する PC-usb タイプ-A から USB マイクロ B ケーブルを使用して接続されたポートケーブル。 |



1.  SUT の電源をオフにします。
2.  **J1** On USB Type-C connex というラベルが付いたポートに、SUT を接続します。
3.  プロキシコントローラーを USB タイプ-C 接続 Ex に接続します。
4.  周辺機器を USB タイプに接続します-C 接続 Ex。
5.  SUT の電源を入れ、Windows にログオンします。
6.  管理者特権でのコマンドプロンプトで、CXLOOP を実行します。CMD スクリプト。 スクリプトが一時停止したら、新しくアクティブになった周辺機器が動作していることを確認します。
7.  USB タイプ C ケーブルの向きを反転し、手順 5-7 を繰り返します。
8.  USB タイプ-C 接続 Ex をポート**J2**に接続します。

    ロールのスワップを確認します。 LCD 画面に表示される Amperage は、電源の役割を示しています。 **J1**が電源シンクの場合、 **+ ve** **J1**が電源の場合は **-ve** 。

9.  データロールをスワップし、各システムの現在のロールが変更されていることを確認するために必要な手順を実行します。

手順 2-4 に関連する構成イメージについては、「[はじめ](#get-started)に」を参照してください。

## <a name="st-case-1-device-enumeration"></a>ST Case 1: デバイス列挙型


![st case 1: デバイス列挙型](images/ft1.png)

| ポート   | デバイス                                                                              |
|--------|-------------------------------------------------------------------------------------|
| **J1** | SUT.                                                                                |
| **J2** | Usb タイプ c の usb ポートを使用して接続されている PC-c + + ケーブルを使用して接続します。              |
| **J3** | USB タイプ-C 充電器。                                                                 |
| **J4** | マウスが接続されているダウンストリームがある USB ハブ (SuperSpeed または高速度)。               |
| **J6** | USB を使用する PC-usb タイプ-A から USB マイクロ B ケーブルを使用して接続されたポートケーブル。 |



1.  SUT の電源をオフにします。
2.  **J1** On USB Type-C connex というラベルが付いたポートに、SUT を接続します。
3.  プロキシコントローラーを USB タイプ-C 接続 Ex に接続します。
4.  周辺機器を USB タイプに接続します-C 接続 Ex。
5.  SUT の電源を入れ、Windows にログオンします。
6.  管理者特権でのコマンドプロンプトで、CXSTRESS を実行します。12時間の CMD。

    Ctrl + C キーを押してスクリプトを終了します。

7.  「 [FT Case 1: デバイス列挙](#ft-case-1-device-enumeration)」で説明されている手順を実行します。

手順 2-4 に関連する構成イメージについては、「[はじめ](#get-started)に」を参照してください。

## <a name="st-case-2-charging-and-power-delivery-pd"></a>ST ケース 2: 課金と電力配信 (PD)


![st ケース 2: 課金と電力配信 (pd)](images/ft3.png)

| ポート   | デバイス               |
|--------|----------------------|
| **J1** | SUT.                 |
| **J2** | なし。                |
| **J3** | USB タイプ-C 充電器。  |
| **J4** | USB マウス。           |
| **J6** | USB マイクロの充電器。 |



1.  SUT の電源をオフにします。
2.  **J1** On USB Type-C connex というラベルが付いたポートに、SUT を接続します。
3.  プロキシコントローラーを USB タイプ-C 接続 Ex に接続します。
4.  周辺機器を USB タイプに接続します-C 接続 Ex。
5.  SUT の電源を入れ、Windows にログオンします。
6.  管理者特権でのコマンドプロンプトで、CXSTRESS を実行します。12時間の CMD。 の順に移動します。

    Ctrl + C キーを押してスクリプトを終了します。

7.  「 [FT: 料金と電力配信 (PD)](#ft-case-3-charging-and-power-delivery-pd)」で説明されている手順を実行します。

手順 2-4 に関連する構成イメージについては、「[はじめ](#get-started)に」を参照してください。

## <a name="additional-test-resources"></a>その他のテストリソース


次の機能テストは、USB タイプ-C を使用して、従来の USB シナリオを向上させることができます。

| テストケース                                | 説明                                                                                                                  | カテゴリ             |
|------------------------------------------|------------------------------------------------------------------------------------------------------------------------------|----------------------|
| [システムブート](type.md#ft2)              | 製品が通常のシステムブートを妨げることがないことを確認します。                                                               | システム、ドッキング、デバイス |
| [システムの電源切り替え](type.md#ft3) | システムの電源遷移と、低い電力状態からのウェイクアップ機能が製品の影響を受けないかどうかをテストします。 | システム、ドッキング、デバイス |
| [選択的中断](type.md#ft4)        | 選択的中断遷移を確認します。                                                                                  | Dock、デバイス         |



次のストレステストは、USB シナリオを拡張するスーパー Mutt テストドキュメントから適用できます。

| テストケース                                | 説明                                                     | カテゴリ             |
|------------------------------------------|-----------------------------------------------------------------|----------------------|
| [システムの電源切り替え](type.md#st1) | システムの電源イベントが繰り返し発生した後で、製品の信頼性をテストします。 | システム、ドッキング、デバイス |
| [イベントの転送](type.md#st2)          | 複数の転送および接続イベントを生成します。              | システム、ドッキング、デバイス |
| [プラグアンドプレイ (PnP)](type.md#st3)      | さまざまな PnP シーケンスを生成します。                                | システム、ドッキング、デバイス |
| [デバイストポロジ](type.md#st4)          | 製品を使用して、さまざまなデバイスとトポロジをテストします。       | システム、ドッキング、デバイス |



## <a name="validating-success-or-failure-of-the-tests"></a>テストの成功または失敗の検証


### <a name="confirming-charging-and-power"></a>課金と電源を確認する

USB タイプのオンボード LCD-C ConnEx には、電力 (ボルト、アンペア、方向) が表示されます。 電源がオンになっていて、USB の種類が C の接続でアクティブに有効になっている場合、そのことを確認します。

![課金と電源を確認する](images/connexc-connect9.png)

### <a name="confirming-device-addition-on-desktops"></a>デスクトップでのデバイスの追加を確認する

1.  デバイスが接続されている USB ホストコントローラーを特定します。
2.  新しいデバイスがデバイスマネージャーの適切なノードの下に表示されていることを確認します。
3.  Usb 3.0 ポートに接続されている USB 3.0 ハブでは、2つのハブデバイス (1 つは SuperSpeed で列挙され、もう1つは高速) が表示されます。

### <a name="confirm-device-removal-on-desktops"></a>デスクトップでのデバイスの削除の確認

1.  デバイスマネージャーでデバイスを識別します。
2.  テストステップを実行して、システムからデバイスを削除します。
3.  デバイスマネージャーにデバイスが存在しないことを確認します。
4.  USB 3.0 ハブの場合は、両方のデバイス (SuperSpeed とコンパニオンハブ) が削除されていることを確認します。 この場合、デバイスの削除に失敗すると、デバイスエラーになる可能性があります。また、適切な根本原因のトリアージに関係するすべてのコンポーネントによって調査する必要があります。

### <a name="confirm-device-functionality"></a>デバイスの機能の確認

-   デバイスが USB ハブの場合は、ハブの下流にあるデバイスが機能していることを確認します。 他のデバイスがハブの使用可能なポートに接続できることを確認します。
-   デバイスが HID デバイスの場合は、その機能をテストします。 USB キーボードの種類、USB マウスがカーソルを動かし、ゲームコントローラーのコントロールパネルでゲームデバイスが機能していることを確認します。
-   USB オーディオデバイスは、サウンドを再生または録音する必要があります。
-   記憶装置にアクセスできる必要があり、200 MB 以上のサイズのファイルをコピーできる必要があります。
-   デバイスにスキャン & 印刷などの複数の機能がある場合は、必ずスキャン機能と印刷機能の両方をテストしてください。
-   デバイスが USB タイプ C デバイスの場合は、該当する USB および代替モードが機能していることを確認します。

## <a name="using-etw-to-log-issues"></a>ETW を使用した問題のログ記録


手順については https://aka.ms/usbtrace にアクセスし、USB ドライバーから ETW トレースをキャプチャするためのスクリプトをダウンロードしてください。

## <a name="reporting-test-results"></a>テスト結果のレポート


次の詳細を指定します。

-   失敗したテストの前に実行されたテストの一覧 (順)。
-   一覧には、失敗または成功したテストを指定する必要があります。
-   テストに使用されたシステム、デバイス、ドッキング、またはハブ。 必要に応じて追加情報を取得できるように、make、model、および Web サイトを含めます。









